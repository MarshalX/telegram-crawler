window.Graph={render:function(t,i){var s=document.createElement("div");return s.className="tchart--wrapper",t.appendChild(s),new this.units.TChart({container:s,data:i})},units:{}},(()=>{function t(t){this.composer=t.composer,this.state=t.state,this.queue={},this.queueSize=0,this.step=this.step.bind(this)}t.prototype={add:function(t){for(var i,s,e,a=0,h=+new Date,o=this.queue;a<t.length;){if(!(i=o[(s=t[a]).prop])){if(s.end==s.state[s.prop]){s.cbEnd&&s.cbEnd(s.state),a++;continue}o[s.prop]=i={lastStart:1},this.queueSize++}e=h-i.lastStart,s.duration*=this.state.speed,s.delay*=this.state.speed,i.cbEnd=s.cbEnd,i.state=s.state,i.lastStart=h,i.start=s.state[s.prop],i.end=s.end,i.startDt=h+(s.delay||0),i.endDt=i.startDt+(s.duration||0)-(s.fixed?0:Math.max(s.duration-e,0)),i.tween=s.tween||"easeInOutQuad",i.speed=s.speed,i.group=s.group,a++}this.animFrame||(this.animFrame=requestAnimationFrame(this.step))},get:function(t){return this.queue[t]},step:function(){var t,i,s,e,a,h,o,r=[],n=+new Date,d={top:!1,bottom:!1};for(t in this.queue)h=(i=this.queue[t]).endDt-i.startDt,s=i.state[t],(o=(e=n)<i.startDt)?e=i.startDt:e>i.endDt&&(e=i.endDt),(e=(e=h?(e-i.startDt)/h:o?0:1)<1?"exp"==i.tween?s+(i.end-s)*i.speed:(h=i.start,o=i.end,{linear:function(t,i,s,e){return s*t/e+i},easeInOutQuad:function(t,i,s,e){return(t/=.5*e)<1?.5*s*t*t+i:-s/2*(--t*(t-2)-1)+i}}[i.tween](e,h,o-h,1)):i.end)!=s?(i.state[t]=e,d.top=d.top||i.group.top,d.bottom=d.bottom||i.group.bottom):e==i.end&&r.push(t);for(a=0;a<r.length;)this.queue[r[a]].cbEnd&&this.queue[r[a]].cbEnd(this.queue[r[a]].state),delete this.queue[r[a]],a++;this.queueSize-=r.length,this.composer.render(d),this.queueSize?this.animFrame=requestAnimationFrame(this.step):delete this.animFrame}},window.Graph.units.TAnimator=t})(),(()=>{function t(t){(this.opts=t).additional.mini&&(this.$canvas=document.createElement("canvas"),this.ctx=this.$canvas.getContext("2d",{alpha:!0}))}var Ut=window.Graph.units;t.prototype={onResize:function(){var t,i;this.opts.additional.mini&&(t=this.opts.settings.dpi,i=this.opts.additional.mini?this.opts.state.dims.mini:this.opts.state.dims.graph,this.$canvas.width=i.w*t,this.$canvas.height=i.h*t,this.cached="")},setDarkMode:function(t){this.isDarkMode=t},render:function(){var t,i,s,e=this.opts,a=e.data.ys,h=e.state,o=e.additional.mini,C=o?h.xg1:h.x1,F=o?h.xg2:h.x2,H=e.settings,N=H["PADD"+(o?"_MINI_AREA":"")][0],r=H["PADD"+(o?"_MINI_AREA":"")][1],X=H["PADD"+(o?"_MINI_AREA":"")][2],n=H["PADD"+(o?"_MINI_AREA":"")][3],U=e.data.x,d=e.settings.dpi,l=(o?this:this.opts).ctx,p=[],c=[],m=o?h.dims.mini:h.dims.graph,g=null==h.zoomMorph?0:h.zoomMorph,u=g,Y=a.length;if(o){for(var B=[m.w,m.h,h.xg1,h.xg2,this.isDarkMode,h.zoomMode,g],x=0;x<Y;x++)B.push(h["om_"+x]),B.push(h["f_"+x]);if((B=B.join(","))==this.cached)return void this.opts.ctx.drawImage(this.$canvas,m.l*d,m.t*d);this.cached=B}i=(m.w-r-n)/(F-C),y=Math.floor(Ut.TUtils.getXIndex(U,C-n/i)),M=Math.ceil(Ut.TUtils.getXIndex(U,F+r/i)),s=(n+(o?0:m.l))*d-C*(i*=d),hBottom=(m.h-X+(o?0:m.t))*d;var v=[],G=[],O=0,W=0,V=0,j=!1;for(x=0;x<Y;x++)t=o?h["om_"+x]:h["o_"+x],j=j||h["f_"+x]<1,t<1&&0<t&&(O=t),0<t&&(v.push(x),G.push(t),1==t)&&h["e_"+x]&&(W++,V=v.length-1);var f=v.length,O=1==W?O:1,r=(o?h.y1m:h.y1,o?h.y2m:h.y2,Ut.TUtils.simplifyData("line",U,a,i,s,v,y,M,m.w-r-n)),y=r.xInd1,M=r.xInd2,_=r.x,Z=r.ys,q=!1;for(T=y;T<=M;T++){for(x=c[T]=p[T]=0;x<f;x++)c[T]+=(Z[v[x]].y[T]||0)*G[x];0==c[T]&&(q=!0)}if((q||j)&&(l.fillStyle=this.isDarkMode?"#242f3e":"#fff",l.fillRect(0,0,m.w*d,m.h*d)),0<g&&!o){1==u&&(this.savedX1=C,this.savedX2=F),K=u<1?(n=this.opts.animator.get("x1"),r=this.opts.animator.get("x2"),x1End=n?n.end:this.opts.state.x1,x2End=r?r.end:this.opts.state.x2,J=Ut.TUtils.getXIndex(U,-1==this.opts.state.zoomDir?this.savedX1:x1End,!0),Ut.TUtils.getXIndex(U,-1==this.opts.state.zoomDir?this.savedX2:x2End,!0)):(J=Ut.TUtils.getXIndex(U,C,!0),Ut.TUtils.getXIndex(U,F,!0)),K--;var J,K,Q=Math.floor(J),tt=Math.ceil(J),it=Math.floor(K),st=Math.ceil(K),et=0,at=[];for(x=0;x<f;x++){at[x]=0;for(var ht=a[v[x]].y,T=tt;T<=it;T++){var b=(ht[T]||0)*G[x];at[x]+=b,et+=b}b=(tt-J)*(ht[Q]||0)*G[x],b=(at[x]+=b,et+=b,(K-it)*(ht[st]||0)*G[x]);at[x]+=b,et+=b}var n=1==this.opts.state.zoomDir?Math.pow(Math.min(Math.max(u<.85?(u-.65)/.2:1-(u-.9)/.15,0),1),.8):this.prevElastic,ot=2*Math.PI-Math.PI/(7-u)-Math.PI/8*n,rt=ot,w=(1==this.opts.state.zoomDir?(u=Math.min(Math.max((u-.25)/.4,0),1),this.prevElastic=n):u=Math.min(Math.max(2.4*u-1.4,0),1),[]),S=H.PIE_RADIUS*(g<1?2.31:1)*d,D=d*(m.w/2+m.l),nt=d*(m.h/2+m.t+2),dt=2*Math.PI*S/d;for(x=0;x<f;x++){var lt=at[x]/et||0,pt=2*Math.PI*lt,ct=ot-pt,mt=Math.round(lt*dt*(1/13)),gt=(x==f-1&&(ct=rt-2*Math.PI),2*Math.PI*.1/dt),ut=a[v[x]];w.push({st:ot+gt,ed:ct-gt,mid:ot-pt/2-gt/2,additionalPoints:Math.max(mt,4),percentage:0==lt?0:Math.max(Math.round(100*lt),1),percentageText:0==lt?"":lt<.01?"<1%":Math.round(100*lt)+"%",ind:v[x],value:at[x],label:ut.label,color:(this.isDarkMode?ut.colors_n:ut.colors_d)[2]}),ot=ct}h.pieAngles=w}var xt=d*(m.h-N-X+(o?0:-4)),vt=(m.h-X+(o?0:m.t))*d,$=0;for(x=0;x<Y;x++)if(0<(t=o?h["om_"+x]:h["o_"+x])){var ft,yt,Mt,_t,Tt,bt,P,wt,St,Dt,$t=Z[x].y,Pt=t*xt;if(l.fillStyle=(this.isDarkMode?a[x].colors_n:a[x].colors_d)[0],l.globalAlpha=.9*h["f_"+x]+.1,l.beginPath(),0!=g&&o){var It=this.opts.data.mainPeriodLen*i;if(l.moveTo(_[M]*i+It+s,hBottom-p[M]),0<x)for(l.lineTo(_[M]*i+s,hBottom-p[M]),T=M;y+1<=T;T--)l.lineTo(_[T]*i+s,hBottom-(p[T]+u*(p[T-1]-p[T]))+0),l.lineTo(_[T-1]*i+s,hBottom-p[T-1]+0);else l.lineTo(_[y]*i+s,hBottom);if($<f-1)for(T=y;T<=M-1;T++){var Lt=vt-($t[T]*Pt/c[T]||0),I=hBottom-Lt,Lt=(T==y&&l.lineTo(_[y]*i+s,hBottom-p[y]-I),vt-($t[T+1]*Pt/c[T+1]||0)),At=hBottom-Lt,Et=p[T+1]+At;l.lineTo(_[T+1]*i+s,hBottom-(Et+u*(p[T]+I-Et))),l.lineTo(_[T+1]*i+s,hBottom-Et),T==M-1&&l.lineTo(_[M]*i+It+s,hBottom-p[M]-At),p[T]+=I}else l.lineTo(_[y]*i+s<<0,hBottom-xt<<0),l.lineTo(_[M]*i+s<<0,hBottom-xt<<0);p[M]+=At}else if(0==g){if(0<x)for(l.moveTo(_[M]*i+s<<0,hBottom-p[M]+0<<0),T=M-1;y<=T;T--)l.lineTo(_[T]*i+s<<0,hBottom-p[T]+0<<0);else l.moveTo(_[M]*i+s<<0,hBottom<<0),l.lineTo(_[y]*i+s<<0,hBottom<<0);if($<f-1||q)for(T=y;T<=M;T++){var kt,Lt=vt-($t[T]*Pt/c[T]||0),I=hBottom-Lt;xt<(kt=p[T]+I)&&(kt=xt),l.lineTo(_[T]*i+s<<0,hBottom-kt<<0),p[T]+=I}else l.lineTo(_[y]*i+s<<0,hBottom-xt<<0),l.lineTo(_[M]*i+s<<0,hBottom-xt<<0)}else{var L,A,E=function(t,i,s,e){var a=0,h=0;k&&1<W&&(a=Math.cos(w[$].mid)*k*8*d,h=-Math.sin(w[$].mid)*k*8*d),S<e&&(e=S);var o=(o=Math.atan2(nt-i,t-D))<0?2*Math.PI+o:o,i=Math.pow((nt-i)*(nt-i)+(t-D)*(t-D),.5),t=(Math.abs(s-o)>Math.PI*(1==f?1.5:1)&&(s-=2*Math.PI),s<2*-Math.PI&&(s-=2*-Math.PI),o+u*(s-o)),s=i+u*(e-i);return[D+Math.cos(t)*s+a,nt-Math.sin(t)*s+h]},zt=g<1?4:w[$].additionalPoints,Rt=!1,Ct=!1,k=h["pieInd_"+v[$]]||0;if(0==w[$].percentage&&(l.globalAlpha=0),L=E(_[M]*i+s,hBottom-p[M],w[0].st,S),l.moveTo(L[0],L[1]),0<$)for(T=M-1;y<=T;T--)(A=_[T]*i+s)==D&&(Rt=!0),L=D<=A?(R=(A-D)/(m.w*d/2),0==u&&(R=0),E(A,hBottom-p[T]+0,w[0].st,S*R)):(Rt||(Rt=!0,Xt=(D-A)/(_[T+1]*i+s-A),z=hBottom-p[T]+0,Ft=hBottom-p[T+1]+0,L=E(D,z+Xt*(Ft-z),w[$].st,0),l.lineTo(L[0],L[1])),R=(D-A)/(m.w*d/2),E(A,hBottom-p[T]+0,w[$].st,S*R)),l.lineTo(L[0],L[1]);else L=E(_[y]*i+s,hBottom,w[0].st,S),l.lineTo(L[0],L[1]);if($<f-1){for(T=0;T<=zt;T++){var Lt=vt-($t[y]*Pt/c[y]||0),I=hBottom-Lt,z=hBottom-p[y]+0,Ft=hBottom-p[y]-I;L=E(_[y]*i+s,z+T/zt*(Ft-z),w[$].st+T/zt*(w[$].ed-w[$].st),S),l.lineTo(L[0],L[1])}for(T=y;T<=M;T++){var R,Ht,Nt,Xt,Lt=vt-($t[T]*Pt/c[T]||0),I=hBottom-Lt;(A=_[T]*i+s)==D&&(Ct=!0),L=A<=D?(R=(D-A)/(m.w*d/2),E(Ht=A,Nt=hBottom-p[T]-I,w[$].ed,S*R)):(Ct||(Ct=!0,Xt=(D-Ht)/(A-Ht),z=Nt,Ft=hBottom-p[T]-I,L=E(D,z+Xt*(Ft-z),w[$].ed,0),l.lineTo(L[0],L[1])),R=(A-D)/(m.w*d/2),0==u&&(R=0),E(A,hBottom-p[T]-I,w[0].st,S*R)),l.lineTo(L[0],L[1]),p[T]+=I}A<D&&(Ct||(L=E(D,z,w[$].ed,0),l.lineTo(L[0],L[1])))}else for(T=0;T<=zt;T++)L=E((_[y]+T/zt*(_[M]-_[y]))*i+s,0,w[$].st+T/zt*(w[0].st-2*Math.PI-w[$].st),S),l.lineTo(L[0],L[1])}l.closePath(),l.fill(),!o&&0<g&&w[$].percentageText&&(wt=Math.pow(u,1==this.opts.state.zoomDir?4:20)*t*(.9*h["f_"+x]+.1),Tt=Math.max(Math.min(2*w[$].percentage,26),10),bt=2*(P=H.PIE_RADIUS)/3,ft=Math.cos(w[$].mid),yt=Math.sin(w[$].mid),Mt=w[$].percentage<e.data.pieLabelsPercentages.outboard,kt=_t=0,k&&1<W&&(_t=ft*k*8*d,kt=-yt*k*8*d),l.fillStyle="white",l.textAlign="center",l.globalAlpha=wt,w[$].percentage<e.data.pieLabelsPercentages.hoverOnly&&(l.globalAlpha=k*wt),Mt&&(bt=P+(Tt=Math.max(Tt,14))/3+13,l.fillStyle=(this.isDarkMode?a[x].colors_n:a[x].colors_d)[0],l.lineWidth=1,l.strokeStyle=(this.isDarkMode?a[x].colors_n:a[x].colors_d)[0],wt=D+_t+ft*(P-1)*d,St=nt+kt-yt*(P-1)*d,Dt=D+_t+ft*(P+6*(1-k)-1)*d,P=nt+kt-yt*(P+6*(1-k)-1)*d,l.beginPath(),l.moveTo(wt,St),l.lineTo(Dt,P),l.stroke()),St=D+_t+(wt=ft*bt*(V==$?O:1))*d+(Mt?Tt/4*w[$].percentageText.length*wt/bt*d:0),Dt=nt+kt-yt*bt*(V==$?O:1)*d,l.font="bold "+Tt*d+"px "+e.settings.FONTS,l.fillText(w[$].percentageText,St,Dt+Tt*d/2.9),l.globalAlpha=1),$++}l.globalAlpha=1,o&&this.opts.ctx.drawImage(this.$canvas,m.l*d,m.t*d)}},Ut.TAreas=t})(),(()=>{function t(t){this.opts=t,this.ctx=t.ctx,this.items={},this.setAnimation(!1),this.deleteItem=this.deleteItem.bind(this)}var E=window.Graph.units;t.prototype={onResize:function(){this.setAnimation(!1)},setDarkMode:function(t){this.isDarkMode=t},setAnimation:function(t){this.noAnimation=!t},hideItem:function(t,i){this.items[t].tp=2,this.opts.animator.add([{prop:"ox_"+t,state:this.items[t].state,end:0,duration:this.noAnimation?0:200*i,tween:"linear",group:{top:!0},cbEnd:this.deleteItem}])},deleteItem:function(t){delete this.items[t.ind]},render:function(t){var i,s=this.opts,e=s.settings.dpi,a=s.data.x,h=s.state,o=s.settings.PADD[1],r=s.settings.PADD[3],n=s.animator,d=(a.length,this.opts.state.dims.axisX),l=this.opts.state.dims.dates,p=h.zoomMode,c=null==h.zoomMorph?0:h.zoomMorph,m=D=Math.floor(E.TUtils.getXIndex(a,h.x1)),g=$=Math.ceil(E.TUtils.getXIndex(a,h.x2)),u="bar"==s.graphStyle||"step"==s.graphStyle,x=9*(h.zoomMode&&s.data.details?s.data.details:s.data).maxXTickLength,v=u?this.opts.data.mainPeriodLen:0,f=u?this.opts.data.detailPeriodLen:0,y=v+(f-v)*c,M=v*(1-c),v=(d.w-o-r)/Math.round((h.x2-h.x1+v)/this.opts.data.mainPeriodLen),f=(d.w-o-r)/Math.round((h.x2-h.x1+f)/this.opts.data.detailPeriodLen),_=v+(f-v)*c,T=Math.pow(2,Math.ceil(Math.log2(x/v))),b=Math.pow(2,Math.ceil(Math.log2(x/f))),w=(d.w-r-o)/(h.x2-h.x1+M),f=(T<1&&(T=1),b<1&&(b=1),this.ctx.font=11*e+"px "+s.settings.FONTS,this.ctx.textAlign="center",this.ctx.fillStyle=(this.isDarkMode?this.opts.data.axis_n:this.opts.data.axis_d).x,this.prevXStep?this.prevXStep>v?this.prevXStep/v:v/this.prevXStep:1),S=1/Math.pow(f,5),D=(p&&1==c&&(S/=2),this.prevXStep=v,Math.max(D-Math.ceil((r+.5*x)/_),0)),$=Math.min($+Math.ceil((o+.5*x)/_),a.length-1);p&&(M=this.opts.animator.get("x1"),f=this.opts.animator.get("x2"),m=M?M.end:this.opts.state.x1,g=f?f.end:this.opts.state.x2,m=Math.floor(E.TUtils.getXIndex(a,m)),g=Math.floor(E.TUtils.getXIndex(a,g))),p&&(v=Math.max(a[this.opts.state.detailInd1],this.opts.state.xMainMin),_=Math.min(a[this.opts.state.detailInd2],this.opts.state.xMainMax),i=Math.round((_-v)/this.opts.data.mainPeriodLen)+(u?0:1));for(var P=D;P<=$;P++){var I=P%T==0,L="m",L=(p&&(P<this.opts.state.detailInd1?I=P%T==0&&c<1:P<=this.opts.state.detailInd2?(I=Math.max(P-this.opts.state.detailInd1,0)%b==0,L="d"):I=Math.max(P-(this.opts.state.detailInd2-this.opts.state.detailInd1+1-i),0)%T==0&&c<1),a[P]+L),A=this.items[L];I?A?2==A.tp&&(A.tp=1,n.add([{prop:"ox_"+L,state:A.state,end:1,duration:this.noAnimation?0:200*S,tween:"linear",group:{top:!0}}])):((A={tp:1,xi:a[P],i:P,state:{ind:L}}).state["ox_"+L]=0,this.items[L]=A,n.add([{prop:"ox_"+L,state:A.state,end:1,duration:this.noAnimation?0:200*S,tween:"linear",group:{top:!0}}])):A&&1==A.tp&&this.hideItem(L,S),A&&0<A.state["ox_"+L]&&(I=(A.xi-h.x1+y/2)*w+r,this.ctx.globalAlpha=A.state["ox_"+L]*t,I+x/2>=d.l)&&I-x/2<=d.l+d.w&&(L=(I+d.l)*e,this.ctx.fillText(s.data.datesShort[P],L,(d.t+9)*e))}for(P in this.items)1==(A=this.items[P]).tp&&(A.xi<h.x1-r/w||A.xi>h.x2+o/w)&&this.hideItem(P,S);this.ctx.globalAlpha=1,"scatter"===s.graphStyle&&s.data.scatter&&"number"===s.data.scatter.xType||(p&&1==c&&g--,g<m&&(g=m),M=s.data.datesRange[m]==s.data.datesRange[g]?s.data.datesRange[m]:s.data.datesRange[m]+" â€“ "+s.data.datesRange[g],f=13,d.w<375&&(f=11),this.ctx.font="bold "+f*e+"px "+s.settings.FONTS,this.ctx.textAlign="right",this.ctx.fillStyle=this.isDarkMode?"#fff":"#000",this.ctx.fillText(M,(l.l+l.w)*e,(l.t+l.h-7)*e))}},E.TAxisX=t})(),(()=>{function t(t){this.opts=t,this.ctx=t.ctx,this.uuid=1,this.items={},this.setAnimation(!1),this.setForceUpdate(!1),this.deleteItem=this.deleteItem.bind(this)}var w=window.Graph.units;t.prototype={onResize:function(){this.setAnimation(!1),this.setForceUpdate(!1)},setDarkMode:function(t){this.isDarkMode=t},setAnimation:function(t){this.noAnimation=!t},setForceUpdate:function(t){this.forceUpdate=t},deleteItem:function(t){delete this.items[t.id]},render:function(t){var i,s;this.opts.pairY?(i=this.calcAxisData("y1_0","y2_0"),(s=this.calcAxisData("y1_1","y2_1")).needAnimation&&!i.needAnimation||this.opts.state.o_0<1?this.updateAxisState("y1_1","y2_1","numRight",s,i,s):this.updateAxisState("y1_0","y2_0","numLeft",i,i,s)):(i=this.calcAxisData("y1","y2"),this.updateAxisState("y1","y2","numLeft",i,i,i)),this.renderState(t)},calcAxisData:function(t,i){var s=this.opts.state,e=this.opts.settings.PADD[0],a=this.opts.settings.PADD[2],h=(Math.floor(this.opts.settings.Y_AXIS_RANGE),!1),o=this.opts.animator.get(t),r=this.opts.animator.get(i),o=o?o.end:s[t],r=r?r.end:s[i],n=w.TUtils.niceNum((r-o)/this.opts.settings.Y_AXIS_RANGE,!0),d=s[i]-s[t],t=s[t]>o?s[t]/o:o/s[t],s=s[i]>r?s[i]/r:r/s[i],i=(this.opts.state.dims.axisYLines.h-e-a)/d,d=(this.opts.state.dims.axisYLines.h-e-a)/(r-o);return(1.05<t||1.05<s||this.forceUpdate)&&(h=!0),{needAnimation:h=this.items[0]&&h&&!this.noAnimation&&!this.animationInProgress,y1:o,y2:r,yRealStep:n,yRealStart:o,yScaleCur:i,yScaleEnd:d}},updateAxisState:function(t,i,s,e,a,h){var o,r=this.opts,n=(r.settings,r.settings.dpi,r.state),d=(r.settings.PADD[0],r.settings.PADD[2]),l=(r.settings.PADD[3],r.settings.PADD[1],r.animator),p=Math.floor(r.settings.Y_AXIS_RANGE),c=!1,m=this.opts.state.dims.axisYLines;e.needAnimation&&(this.animationInProgress=!0);for(var g=0;g<=p;g++){var u,x,v,f,y=1e12,M=Math.round((e.yRealStart+e.yRealStep*g)*y)/y,_=Math.round((a.yRealStart+a.yRealStep*g)*y)/y,y=Math.round((h.yRealStart+h.yRealStep*g)*y)/y,T=w.TUtils.getFormatter("yTickFormatter",r.data,n.zoomMorph),b=T(_,a.yRealStep),T=T(Math.max(y,0),h.yRealStep,!0);e.needAnimation?(u=m.t+m.h-d-(M-e.y1)*e.yScaleEnd,x=m.t+m.h-d-(this.items[g][s]-e.y1)*e.yScaleEnd,v=m.t+m.h-d-(M-n[t])*e.yScaleCur,f=m.t+m.h-d-(M-e.y1)*e.yScaleEnd,Math.abs(x-f)<1?this.items[g]={numLeft:_,strLeft:b,numRight:y,strRight:T,y:f}:(c=!0,this.uuid++,(o={animated:!0,strLeft:this.items[g].strLeft,strRight:this.items[g].strRight,oProp:"oyt_"+this.uuid,yProp:"yyt_"+this.uuid,state:{id:"t_"+this.uuid}}).state[o.oProp]=1,o.state[o.yProp]=u,this.items[o.state.id]=o,l.add([{prop:o.oProp,state:o.state,end:0,duration:this.noAnimation?0:200,tween:"linear",group:{top:!0}},{prop:o.yProp,state:o.state,end:x,duration:this.noAnimation?0:this.forceUpdate?333:500,fixed:!this.forceUpdate,tween:this.forceUpdate?null:"exp",speed:.18,group:{top:!0},cbEnd:this.deleteItem}]),delete this.items[g],this.uuid++,(o={animated:!0,strLeft:b,strRight:T,oProp:"oy_"+g,yProp:"yy_"+g,state:{id:g,numLeft:_,strLeft:b,numRight:y,strRight:T}}).state[o.oProp]=0,o.state[o.yProp]=v,this.items[o.state.id]=o,l.add([{prop:o.oProp,state:o.state,end:1,duration:this.noAnimation?0:200,tween:"linear",group:{top:!0}},{prop:o.yProp,state:o.state,end:f,duration:this.noAnimation?0:this.forceUpdate?333:500,fixed:!this.forceUpdate,tween:this.forceUpdate?null:"exp",speed:.18,group:{top:!0},cbEnd:function(t){this.items[t.id]={numLeft:t.numLeft,strLeft:t.strLeft,numRight:t.numRight,strRight:t.strRight,y:t["yy_"+t.id]},clearTimeout(this.animationEndTimeout),this.animationEndTimeout=setTimeout(function(){this.animationInProgress=!1}.bind(this),30)}.bind(this)}]))):this.items[g]&&this.items[g].animated?(this.items[g].numLeft=_,this.items[g].strLeft=b,this.items[g].numRight=y,this.items[g].strRight=T,this.items[g].state.numLeft=_,this.items[g].state.strLeft=b,this.items[g].state.numRight=y,this.items[g].state.strRight=T):this.items[g]={numLeft:_,strLeft:b,numRight:y,strRight:T,y:m.t+m.h-d-(M-e.y1)*e.yScaleEnd}}e.needAnimation&&!c&&(this.animationInProgress=!1),this.forceUpdate=!1},renderState:function(t){var i,s,e,a,h=this.opts.settings.dpi,o=this.opts.state.dims.axisYLeft,r=this.opts.state.dims.axisYRight,n=this.opts.state.dims.axisYLines,d=this.opts.data.ys;for(i in this.ctx.font=11*h+"px "+this.opts.settings.FONTS,this.ctx.strokeStyle=this.isDarkMode?"rgba(255, 255, 255, 0.1)":"rgba(24, 45, 59, 0.1)",this.ctx.lineWidth=+h,this.ctx.lineCap="square",this.ctx.lineJoin="square",this.items)s=(a=this.items[i]).animated?(e=a.state[a.yProp],a.state[a.oProp]):(e=a.y,1),0<=e-6&&e-16<=o.h&&(this.ctx.globalAlpha=s*(this.opts.pairY?this.opts.state.o_0:1)*t,this.ctx.textAlign="left",this.opts.pairY?this.ctx.fillStyle=(this.isDarkMode?d[0].colors_n:d[0].colors_d)[1]:this.ctx.fillStyle=(this.isDarkMode?this.opts.data.axis_n:this.opts.data.axis_d).y,this.ctx.fillText(a.strLeft,o.l*h,(e-7)*h),this.opts.pairY)&&(this.ctx.globalAlpha=s*this.opts.state.o_1*t,this.ctx.textAlign="right",this.ctx.fillStyle=(this.isDarkMode?d[1].colors_n:d[1].colors_d)[1],this.ctx.fillText(a.strRight,(r.l+r.w)*h,(e-7)*h)),0<=(e=(e<<0)-.5)&&e<=o.h&&(this.ctx.beginPath(),this.ctx.globalAlpha=s*t,this.ctx.moveTo(n.l*h,e*h),this.ctx.lineTo((n.l+n.w)*h,e*h),this.ctx.stroke());this.ctx.globalAlpha=1}},w.TAxisY=t})(),(()=>{function t(t){this.opts=t,this.filteredX1=[],this.filteredX2=[],this.filteredJ=[],this.prevY=[],this.$canvas=document.createElement("canvas"),this.ctx=this.$canvas.getContext("2d",{alpha:!1})}var q=window.Graph.units;t.prototype={onResize:function(){var t=this.opts.settings.dpi,i=this.opts.additional.mini?this.opts.state.dims.mini:this.opts.state.dims.graph;this.$canvas.width=i.w*t,this.$canvas.height=i.h*t,this.cached=""},setDarkMode:function(t){this.isDarkMode=t},render:function(){var t,i,s,e=this.opts,a=e.data.ys,h=e.state,o=e.additional.mini,r=o?h.xg1:h.x1,C=o?h.xg2:h.x2,n=e.settings,F=(this.w,this.h,n["PADD"+(o?"_MINI_BAR":"")][0]),H=n["PADD"+(o?"_MINI_BAR":"")][1],d=n["PADD"+(o?"_MINI_BAR":"")][2],n=n["PADD"+(o?"_MINI_BAR":"")][3],l=e.data.x,p=e.settings.dpi,c=this.ctx,m=o?h.dims.mini:h.dims.graph,g=h.zoomMode,u=h.detailInd1,x=h.detailInd2,v=null==h.zoomMorph?0:h.zoomMorph,f=this.filteredX1,N=this.filteredX2,X=this.filteredJ,y=this.prevY,U=a.length,M=[m.w,m.h,o?h.xg1:h.x1,o?h.xg2:h.x2,this.isDarkMode,g];for(o||(M.push(h.y1),M.push(h.y2)),R=0;R<U;R++)M.push(o?h["om_"+R]:h["o_"+R]),M.push(h["f_"+R]);if((M=M.join(","))!=this.cached||(this.opts.ctx.drawImage(this.$canvas,m.l*p,m.t*p),!o)){t=(m.w-H-n)/(C-r+this.opts.data.mainPeriodLen*(1-v)),i=Math.floor(q.TUtils.getXIndex(l,r-n/t)),s=Math.ceil(q.TUtils.getXIndex(l,C+H/t)),g&&1==v&&(i<this.opts.state.xg1Ind&&(i=this.opts.state.xg1Ind),s>this.opts.state.xg2Ind)&&(s=this.opts.state.xg2Ind-1);var _=n*p-r*(t*=p),T=(m.h-d)*p,b=this.opts.data.mainPeriodLen*t,Y=this.opts.data.detailPeriodLen*t;if(M!=this.cached){c.fillStyle=this.isDarkMode?"#242f3e":"#fff",c.fillRect(0,0,m.w*p,m.h*p);for(var w,S=0,D=i;D<=s;D++){w=g&&u<=D&&D<=x?Y:b;var B=Math.round(l[D]*t+_),G=Math.round(l[D]*t+_+w);0<G-B&&(f[S]=B,N[S]=G,X[S]=D,y[S]=0,S++)}for(R=0;R<U;R++)if(0<(k=o?h["om_"+R]:h["o_"+R])){var $=a[R].y,P=a[R].yFrom,I=o?h.y1m:h.y1,O=o?h.y2m:h.y2,L=p*(m.h-F-d)/(O-I),W=(m.h-d)*p+I*L,V=k*L;if(c.fillStyle=(this.isDarkMode?a[R].colors_n:a[R].colors_d)[0],c.globalAlpha=.9*h["f_"+R]+.1,c.beginPath(),c.moveTo(Math.round(l[s]*t+_+(1==v?Y:b)),Math.round(T)),0<R)for(D=S-1;0<=D;D--){var j=T-y[D];c.lineTo(N[D],Math.round(j)),c.lineTo(f[D],Math.round(j))}else c.lineTo(Math.round(l[i]*t+_),Math.round(T));for(D=0;D<S;D++){var A,E=X[D],j=W-(A=(A=g?u<=E&&E<=x?P[E]+v*($[E]-P[E]):$[E]+v*($[u]-$[E]):$[E])||0)*V;y[D]+=T-j,c.lineTo(f[D],Math.round(T-y[D])),c.lineTo(N[D],Math.round(T-y[D]))}c.closePath(),c.fill()}c.globalAlpha=1,this.opts.ctx.drawImage(this.$canvas,m.l*p,m.t*p)}if(-1<h.barInd&&!o){this.opts.ctx.fillStyle=this.isDarkMode?"rgba(36, 47, 62, 0.5)":"rgba(255, 255, 255, 0.5)",this.opts.ctx.globalAlpha=h.barO,this.opts.ctx.fillRect(0,0,m.w*p,m.h*p);for(var Z,k,z=0,R=0;R<U;R++)0<(k=h["o_"+R])&&($=a[R].y,P=a[R].yFrom,I=h.y1,O=h.y2,L=p*(m.h-F-d)/(O-I),W=(m.h-d)*p+I*L,V=k*L,this.opts.ctx.fillStyle=(this.isDarkMode?a[R].colors_n:a[R].colors_d)[0],this.opts.ctx.globalAlpha=.9*h["f_"+R]+.1,g?h.barInd>=u&&h.barInd<=x?(A=P[h.barInd]+v*($[h.barInd]-P[h.barInd]),w=Y):(w=b,A=$[h.barInd]+v*($[u]-$[h.barInd])):(A=$[h.barInd],w=b),Z=T-(W-(A=A||0)*V)+z,this.opts.ctx.fillRect(Math.round(l[h.barInd]*t+_),Math.round(T-z+m.t*p),Math.max(Math.round(w),1),Math.round(z)-Math.round(Z)),z=Z);c.globalAlpha=1}this.cached=M}}},q.TBars=t})(),(()=>{function t(x){this.state={},this.state.masterVisibility=1,this.state.slaveVisibility=0,this.specialZoomTransition=void 0,this.darkMode=!!document.documentElement.classList.contains("dark");var t=(!!window.ActiveXObject&&+/msie\s(\d+)/i.exec(navigator.userAgent)[1]||NaN)<11,i=-1!=navigator.userAgent.indexOf("Trident/")&&(-1!=navigator.userAgent.indexOf("rv:")||-1!=navigator.appName.indexOf("Netscape")),s=x.data.xRangeFormatter==statsFormatEmpty,t=(this.settings={isIE:t||i,isEdge:/Edge\/\d./i.test(navigator.userAgent),dpi:Math.min(window.devicePixelRatio||1,2),Y_AXIS_RANGE:5.3,PADD:[20,16,20,16],PADD_MINI:[2,0,2,0],PADD_MINI_BAR:[0,0,0,0],PADD_MINI_AREA:[0,0,0,0],Y_LABELS_WIDTH:50,X_LABELS_HEIGHT:12,DATES_HEIGHT:s?0:18,DATES_WIDTH:300,MINI_GRAPH_HEIGHT:40,MINI_GRAPH_TOP:14,MINI_GRAPH_BOTTOM:2,FADE_HEIGHT:16,PIE_RADIUS:130,FONTS:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif'},this.data={caption:x.data.title,detailsFunc:x.data.x_on_zoom,hasDetail:!!x.data.x_on_zoom,slave:x.slave,yTickFormatter:x.data.yTickFormatter,yTooltipFormatter:x.data.yTooltipFormatter,yCustomTooltipFormatters:x.data.yCustomTooltipFormatters,yMinStep:x.data.yMinStep,xTickFormatter:x.data.xTickFormatter,xTooltipFormatter:x.data.xTooltipFormatter,xRangeFormatter:x.data.xRangeFormatter,strokeWidth:x.data.strokeWidth||"auto",hidden:x.data.hidden||[],tooltipOnHover:!!x.data.tooltipOnHover,forceLegend:x.data.forceLegend,sideLegend:x.data.sideLegend||!1,pieZoomRange:x.data.pieZoomRange||6048e5,pieLabelsPercentages:{outboard:x.data.pieLabelsPercentages&&null!=x.data.pieLabelsPercentages.outboard?x.data.pieLabelsPercentages.outboard:5,hoverOnly:x.data.pieLabelsPercentages&&null!=x.data.pieLabelsPercentages.hoverOnly?x.data.pieLabelsPercentages.hoverOnly:2},tooltipSort:x.data.tooltipSort,subchart:{show:!x.data.subchart||null==x.data.subchart.show||x.data.subchart.show,defaultZoom:x.data.subchart&&x.data.subchart.defaultZoom}},x.data.y_scaled&&(this.pairY=!0),this.graphStyle="line",this.settings),i=(x.data.columns.forEach(function(t,i){var s,e,a,h,o,r=t.shift(),n=x.data.types[r];if("x"===n&&(this.data.x=t,this.state.xCount=t.length,this.state.x1=t[.75*t.length<<0],this.state.x2=t[t.length-1],this.state.xg1=t[0],this.state.xg2=t[t.length-1],this.state.xg1Ind=0,this.state.xg2Ind=t.length-1,this.state.xMainMin=t[0],this.state.xMainMax=t[this.state.xg2Ind],this.state.xgMin=t[0],this.state.xgMax=t[this.state.xg2Ind],o=this.getDefaultZoom({x1:this.state.x1,x2:this.state.x2,xg1:this.state.xg1,xg2:this.state.xg2,default:this.data.subchart.defaultZoom}),this.state.x1=o.x1,this.state.x2=o.x2,this.data.mainPeriodLen=this.data.x[1]-this.data.x[0],this.data.detailPeriodLen=this.data.mainPeriodLen,this.data.dates=[],this.data.datesShort=[],this.data.datesRange=[],s=L.TUtils.getFormatter("xTooltipFormatter",this.data,0),e=L.TUtils.getFormatter("xTickFormatter",this.data,0),a=L.TUtils.getFormatter("xRangeFormatter",this.data,0),h=0,t.forEach(function(t,i){this.data.dates[i]=s(t,!1),this.data.datesShort[i]=e(t,!1),this.data.datesRange[i]=a(t,!1),this.data.datesShort[i].length>h&&(h=this.data.datesShort[i].length)}.bind(this)),this.data.maxXTickLength=h),"x"!==n&&(this.data.ys=this.data.ys||[],this.data.yIds=this.data.yIds||{},o=x.data.colors[r],l=x.data.yCustomTooltipFormatters?x.data.yCustomTooltipFormatters[r]:null,this.data.ys.push({colors_d:[o,o,o],colors_n:[o,o,o],label:x.data.names[r],y:t,ctf:l,tp:n,id:r}),"line"==n||"step"==n?(this.data.axis_d={x:"#8E8E93",y:"#8E8E93"},this.data.axis_n={x:"rgba(163,177,194,0.6)",y:"rgba(163,177,194,0.6)"}):(this.data.axis_d={x:"rgba(37,37,41,0.5)",y:"rgba(37,37,41,0.5)"},this.data.axis_n={x:"rgba(163,177,194,0.6)",y:"rgba(236,242,248,0.5)"}),o=this.data.ys.length-1,t=-1==this.data.hidden.indexOf(r),this.data.yIds[r]=o,this.state["e_"+o]=t,this.state["o_"+o]=t?1:0,this.state["om_"+o]=t?1:0,this.state["pieInd_"+o]=0,this.state["f_"+o]=1,this.graphStyle=n),"scatter"===this.graphStyle&&x.data.scatter&&!this._scatterPrepared){this._scatterPrepared=!0,this.data.scatter=x.data.scatter;var d,l,p=this.data.scatter,c=Number.MAX_VALUE,m=-Number.MAX_VALUE,g=!1;for(d in p.series){var u=p.series[d].points;u&&u.length&&(u.sort(function(t,i){return t.x-i.x}),u[0].x<c&&(c=u[0].x),u[u.length-1].x>m&&(m=u[u.length-1].x),p.series[d].xMin=u[0].x,p.series[d].xMax=u[u.length-1].x,g=!0)}g&&(this.state.xMainMin=c,this.state.xMainMax=m,this.state.xgMin=c,this.state.xgMax=m,this.state.xg1=c,this.state.xg2=m,l=this.getDefaultZoom({x1:c,x2:m,xg1:c,xg2:m,default:this.data.subchart.defaultZoom}),this.state.x1=l.x1,this.state.x2=l.x2,this.state.xg1Ind=0,this.state.xg2Ind=Math.max((this.data.x?this.data.x.length:1)-1,0))}}.bind(this)),L.TUtils.triggerEvent("chart-update-zoom",{x1:this.state.x1,x2:this.state.x2,target:x.container.parentElement}),this.state.activeColumnsCount=this.data.ys.length,this.updateSpeed(),"area"==this.graphStyle&&(t.Y_AXIS_RANGE=4.06,this.data.hasDetail=!0),{isReduced:!1});(i="scatter"!==this.graphStyle?this.reduceGlobalRange({}):i).isReduced&&(this.state.x1=i.x1,this.state.x2=i.x2,this.state.xg1=i.xg1,this.state.xg2=i.xg2,this.state.xg1Ind=i.xg1Ind,this.state.xg2Ind=i.xg2Ind),this.onResize=this.onResize.bind(this),this.onSwitcherChange=this.onSwitcherChange.bind(this),this.onSwitcherEnter=this.onSwitcherEnter.bind(this),this.onSwitcherLeave=this.onSwitcherLeave.bind(this),this.onHandleMove=this.onHandleMove.bind(this),this.toggleZoom=this.toggleZoom.bind(this),this.createDOM(x.container),window.addEventListener("resize",this.onResize),document.addEventListener("darkmode",function(t){this.setDarkMode(!this.darkMode)}.bind(this),!1),document.addEventListener("chart-hide-tips",function(t){t.detail.except!=this&&this.tip.toggle(!1)}.bind(this),!1),this.opts=x,this.onResize(),this.darkMode&&this.setDarkMode(this.darkMode),window.matchMedia("(-webkit-min-device-pixel-ratio: 1), (min-resolution: 96dpi)").addListener(this.onResize),window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5), (min-resolution: 144dpi)").addListener(this.onResize),window.matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)").addListener(this.onResize),window.matchMedia("(-webkit-min-device-pixel-ratio: 3), (min-resolution: 288dpi)").addListener(this.onResize)}var L=window.Graph.units;t.prototype={getScatterYMinMax:function(c,m){var t,i=Number.MAX_VALUE,s=-Number.MAX_VALUE,g=this.state,u=this.data.scatter.series,x=!1;function v(t){t<i&&(i=t),s<t&&(s=t)}function f(t,i){for(var s=0,e=t.length;s<e;){var a=s+e>>1;t[a].x<i?s=1+a:e=a}return s}return this.data.ys.forEach(function(t,i){if(g["e_"+i]){var s=u[t.id];if(s&&s.points&&s.points.length&&!(s.xMin>m||s.xMax<c))if(x=!0,s.blocks)for(var e=s.blocks.length,a=0;a<e;a++){var h=s.blocks[a];if(!(h.xMax<c)){if(m<h.xMin)break;if(c<=h.xMin&&h.xMax<=m)v(h.yMin),v(h.yMax);else for(var o=h.points,r=f(o,c);r<o.length;r++){var n=o[r].x;if(m<n)break;v(o[r].y)}}}else for(var d=s.points,l=f(d,c);l<d.length;l++){var p=d[l].x;if(m<p)break;v(d[l].y)}}}),x&&i!==Number.MAX_VALUE?{min:i-=.1*(t=0===(t=s-i)?1:t),max:s+=.1*t}:{min:0,max:10}},reduceGlobalRange:function(a){var t,s=(null==a.x1?this.state:a).x1,e=(null==a.x2?this.state:a).x2,h=(null==a.xg1?this.state:a).xg1,o=(null==a.xg2?this.state:a).xg2,r=(a.useSaved?this.data.saved:this.data).x,n=Math.floor(L.TUtils.getXIndex(r,this.state.xgMin)),d=Math.ceil(L.TUtils.getXIndex(r,this.state.xgMax)),l=d,p=n,c=this.state.zoomMode?"bar"==this.graphStyle||"step"==this.graphStyle?1:2:0;return"area"==this.graphStyle&&(c=0),this.data.ys.forEach(function(t,s){var e=a.useSaved?this.data.saved.y[s]:t.y;if(this.state["e_"+s])for(i=n;i<=d-c;i++)null!=(v=e[i])&&(l=Math.min(l,i),p=Math.max(p,i))}.bind(this)),(p=p+c==d?d-Math.max(c-1,0):p)<=l||(t=r[l],r=r[p],h==t&&o==r)?{isReduced:!1}:(r<e?(s=r-(e-s),e=r,s<t&&(s=t)):s<t&&(e=t+(e-s),s=t,r<e)&&(e=r),{isReduced:!0,x1:s,x2:e,xg1:t,xg2:r,xg1Ind:l,xg2Ind:p})},getDefaultZoom:function(t){var i;return t.default?((i={}).x1=t.default[0],i.x2=t.default[1],i.x1=Math.max(i.x1,t.xg1),i.x2=Math.min(i.x2,t.xg2),i.x2<=i.x1&&(i.x1=t.xg1,i.x2=t.xg2),i):{x1:t.x1,x2:t.x2}},updateSpeed:function(t){var i=this.state.activeColumnsCount*this.state.xCount*Math.pow((this.state.x2-this.state.x1)/(this.state.xMainMax-this.state.xMainMin),.5),i=this.state.deviceSpeed*i/16.66<<0,i=Math.max(1-.25*i,0),i=Math.pow(i,.85);return null==this.state.deviceSpeed&&(t=1),this.state.speed=null==(t=1)?i:t,this.state.speed},getYMinMax:function(t,i,h,s,a){if("area"==this.graphStyle)return{min:0,max:102};if("scatter"==this.graphStyle)return this.getScatterYMinMax(t,i);var o,r,e=this.state.dims?this.state.dims.graph.w:this.getGraphWidth(this.data.sideLegend).width,n=Number.MAX_VALUE,d=-Number.MAX_VALUE,e=(i-t)/e,l=L.TUtils.getXIndex((a?this.data.saved:this.data).x,t-e*this.settings.PADD[3]),p=L.TUtils.getXIndex((a?this.data.saved:this.data).x,i+e*this.settings.PADD[1]),c=(this.data.yMinStep,[]),m=[],g=this.settings,u=this.state,p=!a&&this.state.zoomMode?(l=Math.max(l,this.state.detailInd1),Math.min(p,this.state.detailInd2)):(l=Math.max(l,0),Math.min(p,this.data.x.length-1)),x=Math.floor(l),v=Math.ceil(l),f=Math.floor(p),y=Math.ceil(p);if("line"!=this.graphStyle&&"step"!=this.graphStyle||this.data.ys.forEach(function(t,i){var s=a?this.data.saved.y[i]:t.y,t="step"==this.graphStyle?x:v,e="step"==this.graphStyle?y:f;if(u["e_"+i]||0==i&&this.pairY){for(b=t;b<=e;b++)void 0!==(o=s[b])&&(o<n&&(n=o),d<o)&&(d=o);"line"==this.graphStyle&&(void 0!==s[x]&&void 0!==s[v]&&((r=s[x]+(l-x)*(s[v]-s[x]))<n&&(n=r),d<r)&&(d=r),void 0!==s[f])&&void 0!==s[y]&&((r=s[f]+(p-f)*(s[y]-s[f]))<n&&(n=r),d<r)&&(d=r)}this.pairY&&(t=w(n,d,i,void 0),c[i]=t.min,m[i]=t.max,n=Number.MAX_VALUE,d=-Number.MAX_VALUE)}.bind(this)),"bar"==this.graphStyle){for(var M=[],_=0;_<this.data.ys.length;_++)u["e_"+_]&&M.push(_);for(var T=M.length,b=x;b<=y;b++){for(_=yCur=0;_<T;_++)yCur+=(a?this.data.saved.y[M[_]]:this.data.ys[M[_]].y)[b]||0;yCur>d&&(d=yCur)}n=0}return this.pairY?(isNaN(c[0])&&(c[0]=c[1]),isNaN(c[1])&&(c[1]=c[0]),isNaN(m[0])&&(m[0]=m[1]),isNaN(m[1])&&(m[1]=m[0]),{min:c,max:m}):{min:(t=w(n,d)).min,max:t.max};function w(t,i,s,e){var a;return i=t==Number.MAX_VALUE?h?null==s?(t=u.y1m,u.y2m):(t=u["y1m_"+s],u["y2m_"+s]):null==s?(t=u.y1,u.y2):(t=u["y1_"+s],u["y2_"+s]):("bar"==this.graphStyle&&(t=0),t=(a=L.TUtils.roundRange(t,i,g.Y_AXIS_RANGE,e)).yMin,a.yMax),{min:t,max:i=Math.abs(t-i)<1e-10?t+1:i,range:a}}},setDarkMode:function(t){this.darkMode=t,this.graph.setDarkMode(t),this.axisY.setDarkMode(t),this.fade.setDarkMode(t),this.axisX.setDarkMode(t),this.mini.setDarkMode(t),this.handle.setDarkMode(t),this.tip.setDarkMode(t),this.switchers.setDarkMode(t),this.composer.setDarkMode(t)},getGraphWidth:function(t){var i=this.$el.getBoundingClientRect();return t?(t=this.$switchers.getBoundingClientRect(),500<=i.width-t.width?{hasSpaceForLegend:!0,width:Math.max(i.width-t.width,1)}:{hasSpaceForLegend:!1,width:i.width}):{width:i.width}},onResize:function(){var t,i,s=Math.min(window.devicePixelRatio||1,2);this.ww==window.innerWidth&&s==this.settings.dpi||(this.settings.dpi=s,this.ww=window.innerWidth,this.data.sideLegend&&(this.$switchers.classList.remove("tchart--switchers__no-space"),(s=this.getGraphWidth(!0)).hasSpaceForLegend||this.$switchers.classList.add("tchart--switchers__no-space"),this.$graph.style.width=s.width+"px"),s=this.$graph.getBoundingClientRect(),t=this.settings,i=s.height-t.DATES_HEIGHT-t.MINI_GRAPH_HEIGHT-t.MINI_GRAPH_TOP-t.MINI_GRAPH_BOTTOM,this.state.dims={composer:{w:s.width,h:s.height,l:0,t:0},graph:{w:s.width,h:i,l:0,t:t.DATES_HEIGHT},axisYLeft:{w:t.Y_LABELS_WIDTH,h:i,l:t.PADD[3],t:t.DATES_HEIGHT},axisYRight:{w:t.Y_LABELS_WIDTH,h:i,l:s.width-t.PADD[1]-t.Y_LABELS_WIDTH,t:t.DATES_HEIGHT},axisYLines:{w:s.width-t.PADD[1]-t.PADD[3],h:i,l:t.PADD[3],t:t.DATES_HEIGHT},fadeTop:{w:s.width,h:t.FADE_HEIGHT,l:0,t:t.DATES_HEIGHT},fadeBottom:{w:s.width,h:t.FADE_HEIGHT,l:0,t:t.DATES_HEIGHT+i-t.FADE_HEIGHT},axisX:{w:s.width,h:t.X_LABELS_HEIGHT,l:0,t:t.DATES_HEIGHT+i-t.X_LABELS_HEIGHT},dates:{w:t.DATES_WIDTH,h:t.DATES_HEIGHT,l:s.width-t.DATES_WIDTH-t.PADD[1],t:0},mini:{w:s.width-t.PADD[1]-t.PADD[3],h:t.MINI_GRAPH_HEIGHT,l:t.PADD[3],t:t.DATES_HEIGHT+i+t.MINI_GRAPH_TOP},handle:{w:s.width-t.PADD[1]-t.PADD[3],h:t.MINI_GRAPH_HEIGHT+2,l:t.PADD[3],t:t.DATES_HEIGHT+i+t.MINI_GRAPH_TOP-1},tip:{w:s.width,h:i,l:0,t:t.DATES_HEIGHT}},this.graph.onResize(),this.axisY.onResize(),this.fade.onResize(),this.axisX.onResize(),this.mini.onResize(),this.handle.onResize(),this.tip.onResize(),this.composer.onResize())},createDOM:function(t){var i,s,e,a=this.settings,h=(this.$el=document.createElement("div"),this.$el.className="tchart",this.data.subchart.show||this.$el.classList.add("tchart__no-subchart"),this.data.slave&&this.$el.classList.add("tchart__slave"),this.$h1=document.createElement("h1"),this.$h1.className="tchart--header",this.$h1.textContent=this.data.caption,this.$el.appendChild(this.$h1),this.$zoom=document.createElement("div"),this.$zoom.className="tchart--zoom",this.$el.appendChild(this.$zoom),document.createElement("div")),h=(this.$zoom.appendChild(h),document.createElement("span"));if(h.textContent="Zoom Out",this.$zoom.appendChild(h),this.$zoom.addEventListener("click",function(){this.toggleZoom(!1)}.bind(this)),this.$graph=document.createElement("div"),this.$graph.className="tchart--graph",this.$el.appendChild(this.$graph),this.$switchers=document.createElement("div"),this.$switchers.className="tchart--switchers",this.data.sideLegend&&this.$switchers.classList.add("tchart--switchers__side-legend"),this.$el.appendChild(this.$switchers),t.appendChild(this.$el),i=this.getYMinMax(this.state.x1,this.state.x2,!1,!0),s=this.getYMinMax(this.state.xg1,this.state.xg2,!0),this.pairY)for(e=0;e<this.data.ys.length;e++)this.state["y1_"+e]=i.min[e],this.state["y2_"+e]=i.max[e],this.state["y1m_"+e]=s.min[e],this.state["y2m_"+e]=s.max[e];else this.state.y1=i.min,this.state.y2=i.max,this.state.y1m=s.min,this.state.y2m=s.max;this.composer=new L.TComposer({$parent:this.$graph,settings:a,chart:this,state:this.state,data:this.data,graphStyle:this.graphStyle}),this.animator=new L.TAnimator({state:this.state,composer:this.composer});h={line:"TLines",step:"TLines",bar:"TBars",area:"TAreas",scatter:"TScatter"};[["graph",h[this.graphStyle],this.$graph],["axisX","TAxisX",this.$graph],["fade","TFade",this.$graph],["axisY","TAxisY",this.$graph],["tip","TTip",this.$graph,{onClick:this.toggleZoom}],["mini",h[this.graphStyle],this.$graph,{mini:!0}],["handle","THandle",this.$graph,{cb:this.onHandleMove}],["switchers","TSwitchers",this.$switchers,{onClick:this.onSwitcherChange,onLongTap:this.onSwitcherChange,onEnter:this.onSwitcherEnter,onLeave:this.onSwitcherLeave}]].forEach(function(t){this[t[0]]=new L[t[1]]({animator:this.animator,$canvas:this.composer.$canvas,ctx:this.composer.ctx,graphStyle:this.graphStyle,chart:this,pairY:this.pairY,state:this.state,data:this.data,$parent:t[2],settings:a,additional:t[3]||{}}),this[t[0]].id=t[0]}.bind(this))},onHandleMove:function(t,s,e,a){this.state.zoomMode;this.updateSpeed(),L.TUtils.triggerEvent("chart-update-zoom",{x1:t,x2:s,target:this.opts.container.parentElement});var h=[],o=this.getYMinMax(t,s,!1,!0);for(this.axisX.setAnimation("both"!=e),this.axisY.setAnimation(!0),this.axisY.setForceUpdate(!1),a&&L.TUtils.triggerEvent("chart-hide-tips",{except:null}),h.push({prop:"x1",state:this.state,end:t,fixed:!0,duration:0,group:{top:!0,bottom:!0}}),h.push({prop:"x2",state:this.state,end:s,fixed:!0,duration:0,group:{top:!0,bottom:!0}}),i=0;i<this.data.ys.length;i++)"line"!=this.graphStyle&&"step"!=this.graphStyle&&"scatter"!=this.graphStyle||h.push({prop:this.pairY?"y1_"+i:"y1",state:this.state,end:this.pairY?o.min[i]:o.min,duration:500,fixed:!0,tween:"exp",speed:.25,group:{top:!0}}),"area"!=this.graphStyle&&h.push({prop:this.pairY?"y2_"+i:"y2",state:this.state,end:this.pairY?o.max[i]:o.max,duration:500,fixed:!0,tween:"exp",speed:.25,group:{top:!0}});this.animator.add(h)},onSwitcherEnter:function(t){clearTimeout(this.switcherLeaveTimeout);var s=[];for(i=0;i<this.data.ys.length;i++)s.push({prop:"f_"+i,state:this.state,end:t==i?1:0,duration:300,tween:"exp",speed:.15,group:{top:!0,bottom:!0}}),s.push({prop:"pieInd_"+i,state:this.state,end:t==i?1:0,duration:300,tween:"exp",speed:.15,group:{top:!0,bottom:!0}});this.animator.add(s)},onSwitcherLeave:function(t){clearTimeout(this.switcherLeaveTimeout),this.switcherLeaveTimeout=setTimeout(function(){var t=[];for(i=0;i<this.data.ys.length;i++)t.push({prop:"f_"+i,state:this.state,end:1,duration:300,tween:"exp",speed:.15,group:{top:!0,bottom:!0}}),t.push({prop:"pieInd_"+i,state:this.state,end:0,duration:300,tween:"exp",speed:.15,group:{top:!0,bottom:!0}});this.animator.add(t)}.bind(this),300)},onSwitcherChange:function(t,i){var s,e,a,h,o=[],r=[],n=[];if(this.updateSpeed(),"boolean"!=typeof t)for(i=t,h=a=!0,l=0;l<this.data.ys.length;l++)h=h&&(l==i?this.state["e_"+l]:!this.state["e_"+l]);for(var d=0,l=0;l<this.data.ys.length;l++)e=l==i,n[l]=this.state["e_"+l],a?this.state["e_"+l]=e:e&&(this.state["e_"+l]=!!t),h&&a&&(this.state["e_"+l]=!0),r[l]=this.state["e_"+l],r[l]&&(d=Math.max(d,this.data.ys[l].y.length));var p={isReduced:!1},c=(p="scatter"!==this.graphStyle?this.reduceGlobalRange({}):p).isReduced?(o.push({prop:"x1",state:this.state,end:p.x1,duration:333,group:{top:!0,bottom:!0}}),o.push({prop:"x2",state:this.state,end:p.x2,duration:333,group:{top:!0,bottom:!0}}),o.push({prop:"xg1",state:this.state,end:p.xg1,duration:333,group:{top:!0,bottom:!0}}),o.push({prop:"xg2",state:this.state,end:p.xg2,duration:333,group:{top:!0,bottom:!0}}),this.state.xg1Ind=p.xg1Ind,this.state.xg2Ind=p.xg2Ind,s=this.getYMinMax(p.x1,p.x2,!1,!0),this.getYMinMax(p.xg1,p.xg2,!0)):(s=this.getYMinMax(this.state.x1,this.state.x2,!1,!0),this.getYMinMax(this.state.xg1,this.state.xg2,!0));for(L.TUtils.triggerEvent("chart-hide-tips",{except:null}),this.axisY.setForceUpdate(!0),this.axisY.setAnimation(!0),l=this.state.activeColumnsCount=0;l<r.length;l++)r[l]&&this.state.activeColumnsCount++,n[l]!=r[l]&&(o.push({prop:"o_"+l,state:this.state,end:r[l]?1:0,duration:300,group:{top:!0}}),o.push({prop:"om_"+l,state:this.state,end:r[l]?1:0,duration:"line"==this.graphStyle||"step"==this.graphStyle?166:300,delay:r[l]&&"line"==this.graphStyle||"step"==this.graphStyle?200:0,tween:"linear",group:{bottom:!0}}));for(l=0;l<(this.pairY?r.length:1);l++)"line"!=this.graphStyle&&"step"!=this.graphStyle&&"scatter"!=this.graphStyle||o.push({prop:this.pairY?"y1_"+l:"y1",state:this.state,end:this.pairY?s.min[l]:s.min,duration:this.pairY?0:333,group:{top:!0}}),"area"!=this.graphStyle&&o.push({prop:this.pairY?"y2_"+l:"y2",state:this.state,end:this.pairY?s.max[l]:s.max,duration:this.pairY?0:333,group:{top:!0}}),"line"!=this.graphStyle&&"step"!=this.graphStyle||o.push({prop:this.pairY?"y1m_"+l:"y1m",state:this.state,end:this.pairY?c.min[l]:c.min,duration:this.pairY?0:316,group:{bottom:!0}}),"area"!=this.graphStyle&&o.push({prop:this.pairY?"y2m_"+l:"y2m",state:this.state,end:this.pairY?c.max[l]:c.max,duration:this.pairY?0:316,group:{bottom:!0}});this.state.y1m_hidd=this.state.y1m,this.state.y2m_hidd=this.state.y2m,this.state.y1m_show=c.min,this.state.y2m_show=c.max,this.switchers.render(r),this.animator.add(o)},toggleSlave:function(t,i,s,e){var a=[];if(this.updateSpeed(e),this.state.zoomModeSlave!=t){if(this.state.zoomSpecialOrigin=i,t){this.state.zoomModeSlave=!0,this.switchers.switchers.forEach(function(t,i){t.classList.add("tchart--switcher__visible"),t.getElementsByTagName("span")[0].textContent=s.names[i]}),this.tip.labels.forEach(function(t,i){t.$label.textContent=s.names[i]}),this.data.x=s.x;for(var h=[],o=0;o<s.y.length;o++){this.data.ys[o].y=s.y[o];var r=-1==s.hidden.indexOf(this.data.ys[o].id);this.state["e_"+o]=r,this.state["o_"+o]=r?1:0,this.state["om_"+o]=r?1:0,h[o]=r}this.switchers.render(h);for(var e=this.data.x[0],i=this.data.x[this.data.x.length-1],n=(this.data.dates=[],this.data.datesShort=[],this.data.datesRange=[],L.TUtils.getFormatter("xTooltipFormatter",this.data,1)),d=L.TUtils.getFormatter("xTickFormatter",this.data,1),l=L.TUtils.getFormatter("xRangeFormatter",this.data,1),p=0,o=0;o<this.data.x.length;o++)this.data.dates[o]=n(this.data.x[o],!0),this.data.datesShort[o]=d(this.data.x[o],!0),this.data.datesRange[o]=l(this.data.x[o],!0),this.data.datesShort[o].length>p&&(p=this.data.datesShort[o].length);this.data.maxXTickLength=p,this.data.subchart=s.subchart,this.data.hidden=s.hidden;var c=this.getDefaultZoom({x1:e,x2:i,xg1:e,xg2:i,default:this.data.subchart.defaultZoom}),c=(this.state.x1=c.x1,this.state.x2=c.x2,this.state.xCount=this.data.x.length,this.state.xg1=e,this.state.xg2=i,this.state.xg1Ind=0,this.state.xg2Ind=this.data.x.length-1,this.state.xMainMin=e,this.state.xMainMax=i,this.state.xgMin=e,this.state.xgMax=i,this.reduceGlobalRange({})),c=(c.isReduced&&(this.state.x1=c.x1,this.state.x2=c.x2,this.state.xg1=c.xg1,this.state.xg2=c.xg2,this.state.xg1Ind=c.xg1Ind,this.state.xg2Ind=c.xg2Ind),this.getYMinMax(this.state.x1,this.state.x2,!1,!0)),e=this.getYMinMax(e,i,!0);this.state.y1=c.min,this.state.y2=c.max,this.state.y1m=e.min,this.state.y2m=e.max}else this.switchers.switchers.forEach(function(t,i){t.classList.remove("tchart--switcher__visible")});setTimeout(function(){t||(this.state.zoomModeSlave=!1)}.bind(this),470),this.state.slaveVisibility=t?0:1,a.push({prop:"slaveVisibility",state:this.state,end:t?1:0,duration:450,group:{top:!0,bottom:!0}}),this.animator.add(a)}},toggleZoomSpecial:function(t,i,s){var e,a,h,o=[];this.state.zoomModeSpecial!=t&&(e=this.updateSpeed(),t?(h=(this.state.x2-this.state.x1)/(this.state.dims.graph.w-this.settings.PADD[3]-this.settings.PADD[1]),a=this.settings.PADD[3]*h,h=this.settings.PADD[1]*h,this.state.zoomSpecialOrigin=(i-this.state.x1+a)/(this.state.x2-this.state.x1+a+h),this.state.zoomModeSpecial=!0,this.$h1.classList.add("tchart--header__hidden"),this.$zoom.classList.add("tchart--zoom__visible"),this.switchers.switchers.forEach(function(t,i){t.classList.remove("tchart--switcher__visible")}),this.slaveChart.toggleSlave(!0,this.state.zoomSpecialOrigin,s,e)):(this.$h1.classList.remove("tchart--header__hidden"),this.$zoom.classList.remove("tchart--zoom__visible"),this.switchers.switchers.forEach(function(t,i){t.classList.add("tchart--switcher__visible")}),this.slaveChart.toggleSlave(!1,this.state.zoomSpecialOrigin,null,e)),document.body.style.pointerEvents="none",setTimeout(function(){t||(this.state.zoomModeSpecial=!1),document.body.style.pointerEvents=""}.bind(this),470),this.state.masterVisibility=t?1:0,o.push({prop:"masterVisibility",state:this.state,end:t?0:1,duration:450,group:{top:!0,bottom:!0}}),this.animator.add(o))},toggleZoom:function(t,i,h){if(t&&"scatter"===this.graphStyle&&(this.specialZoomTransition=!0),h&&null==this.specialZoomTransition&&(h.columns.length!=this.data.ys.length+1&&(this.specialZoomTransition=!0),this.specialZoomTransition||h.columns.forEach(function(t,i){var s,t=t[0],e=h.types[t],a=h.names[t];null!=(i=this.data.yIds[t])?(s=this.data.ys[i].tp,i=this.data.ys[i].label,s==e&&i==a||(this.specialZoomTransition=!0)):"x"!==t&&(this.specialZoomTransition=!0)}.bind(this)),null==this.specialZoomTransition)&&(this.specialZoomTransition=!1),this.specialZoomTransition&&(this.data.master=!0,this.$el.classList.add("tchart__master"),this.slaveChart||((o=JSON.parse(JSON.stringify(h))).yTickFormatter=h.yTickFormatter,o.yTooltipFormatter=h.yTooltipFormatter,o.yCustomTooltipFormatters=h.yCustomTooltipFormatters,o.xTickFormatter=h.xTickFormatter,o.xTooltipFormatter=h.xTooltipFormatter,o.xRangeFormatter=h.xRangeFormatter,o.sideLegend=this.data.sideLegend,o.tooltipSort=(null!=h.tooltipSort?h:this.data).tooltipSort,this.slaveChart=new L.TChart({container:this.opts.container,slave:!0,data:o}),this.slaveChart.setDarkMode(this.darkMode))),h&&!h.details&&(h.details={y:[],names:[]},h.columns.forEach(function(t,i){var s=t.shift(),e=h.types[s],a=h.names[s];"x"===e?h.details.x=t:this.specialZoomTransition?(h.details.y.push(t),h.details.names.push(a)):h.details.y[this.data.yIds[s]]=t}.bind(this))),h&&(h.subchart={show:!h.subchart||null==h.subchart.show||h.subchart.show,defaultZoom:h.subchart&&h.subchart.defaultZoom},h.details.subchart=h.subchart,h.details.hidden=h.hidden||[]),this.specialZoomTransition)this.toggleZoomSpecial(t,i,h&&h.details);else{var s,e,a,o=h&&h.details,r=[];if(this.state.zoomMode!=t){if(t){if(this.state.zoomMode=!0,this.state.zoomDir=1,this.$h1.classList.add("tchart--header__hidden"),this.$zoom.classList.add("tchart--zoom__visible"),this.zoomEnterSpeed=this.updateSpeed(),h&&(this.data.details={yTickFormatter:h.yTickFormatter,yTooltipFormatter:h.yTooltipFormatter,yCustomTooltipFormatters:h.yCustomTooltipFormatters,xTickFormatter:h.xTickFormatter,xTooltipFormatter:h.xTooltipFormatter,xRangeFormatter:h.xRangeFormatter,subchart:h.subchart,hidden:h.hidden||[]}),!this.hasSavedData){for(this.data.saved={},this.data.saved.x=this.data.x.slice(),this.data.saved.dates=this.data.dates.slice(),this.data.saved.datesShort=this.data.datesShort.slice(),this.data.saved.datesRange=this.data.datesRange.slice(),this.data.saved.y=[],j=0;j<this.data.ys.length;j++)this.data.saved.y[j]=this.data.ys[j].y.slice();this.hasSavedData=!0}this.data.details&&this.data.details.subchart&&(this.data.details.subchart.show?this.$el.classList.remove("tchart__no-subchart"):this.$el.classList.add("tchart__no-subchart")),this.state.zoomSaved={x1:this.state.x1,x2:this.state.x2,xg1:this.state.xg1,xg2:this.state.xg2,xgMin:this.state.xgMin,xgMax:this.state.xgMax};var n,d,l=this.data.mainPeriodLen,p=i,c=i+l;this.data.details&&(p=(i=this.getDefaultZoom({x1:p,x2:c,xg1:o.x[0],xg2:o.x[o.x.length-1],default:this.data.details.subchart.defaultZoom})).x1,c=i.x2),"area"!=this.graphStyle?(this.data.detailPeriodLen=o.x[1]-o.x[0],n=o.x[0],d=o.x[o.x.length-1]):(this.data.detailPeriodLen=l,d=(n=p-((i=this.data.pieZoomRange)-l)/2)+i,c=p+Math.round(i/7/l)*l,n<this.data.x[0]?(d=(n=this.data.x[0])+i)>this.data.x[this.data.x.length-1]&&(d=this.data.x[this.data.x.length-1]+l):d>this.data.x[this.data.x.length-1]&&(n=(d=this.data.x[this.data.x.length-1]+l)-i)<this.data.x[0]&&(n=this.data.x[0])),n=Math.round(n/l)*l,d=Math.round(d/l)*l,"area"!=this.graphStyle&&this.insertDetails(n,d,o),this.state.xgMin=n,this.state.xgMax=d}else this.updateSpeed(this.zoomEnterSpeed/("area"==this.graphStyle?2:1)),this.$h1.classList.remove("tchart--header__hidden"),this.$zoom.classList.remove("tchart--zoom__visible"),this.data.details&&(this.data.subchart.show?this.$el.classList.remove("tchart__no-subchart"):this.$el.classList.add("tchart__no-subchart")),this.state.zoomDir=-1,p=this.state.zoomSaved.x1,c=this.state.zoomSaved.x2,n=this.state.zoomSaved.xg1,d=this.state.zoomSaved.xg2,this.state.xgMin=this.state.zoomSaved.xgMin,this.state.xgMax=this.state.zoomSaved.xgMax;this.axisY.setForceUpdate(!0),this.axisY.setAnimation(!0),this.axisX.setAnimation(!0);var m=450,g=0,i=0,l=("area"==this.graphStyle&&(m=350,t?i=.95*m:g=.95*m),{isReduced:!1});for((l="scatter"!==this.graphStyle?this.reduceGlobalRange({x1:p,x2:c,xg1:n,xg2:d,useSaved:!t}):l).isReduced&&(p=l.x1,c=l.x2,n=l.xg1,d=l.xg2),this.state.xg1Ind=Math.floor(L.TUtils.getXIndex((t?this.data:this.data.saved).x,n)),this.state.xg2Ind=Math.ceil(L.TUtils.getXIndex((t?this.data:this.data.saved).x,d)),s=this.getYMinMax(p,c,!1,!0,!t),e=this.getYMinMax(n,d,!0,!1,!t),document.body.style.pointerEvents="none",setTimeout(function(){t||(this.state.zoomMode=!1,"area"!=this.graphStyle&&this.revertDetails()),document.body.style.pointerEvents="",this.composer.render({top:!0,bottom:!0})}.bind(this),m+20+("area"==this.graphStyle?.9*m:0)),this.state.zoomMorph=t?0:1,r.push({prop:"zoomMorph",state:this.state,end:t?1:0,duration:m,delay:i,group:{top:!0,bottom:!0}}),r.push({prop:"x1",state:this.state,end:p,delay:g,duration:m,group:{top:!0,bottom:!0}}),r.push({prop:"x2",state:this.state,end:c,delay:g,duration:m,group:{top:!0,bottom:!0}}),r.push({prop:"xg1",state:this.state,end:n,delay:g,duration:m,group:{top:!0,bottom:!0}}),r.push({prop:"xg2",state:this.state,end:d,delay:g,duration:m,group:{top:!0,bottom:!0}}),a=0;a<(this.pairY?this.data.ys.length:1);a++)"line"!=this.graphStyle&&"step"!=this.graphStyle&&"scatter"!=this.graphStyle||r.push({prop:this.pairY?"y1_"+a:"y1",state:this.state,end:this.pairY?s.min[a]:s.min,delay:g,duration:m,group:{top:!0}}),"area"!=this.graphStyle&&r.push({prop:this.pairY?"y2_"+a:"y2",state:this.state,end:this.pairY?s.max[a]:s.max,delay:g,duration:m,group:{top:!0}}),"line"!=this.graphStyle&&"step"!=this.graphStyle||r.push({prop:this.pairY?"y1m_"+a:"y1m",state:this.state,end:this.pairY?e.min[a]:e.min,delay:g,duration:m,group:{bottom:!0}}),"area"!=this.graphStyle&&r.push({prop:this.pairY?"y2m_"+a:"y2m",state:this.state,end:this.pairY?e.max[a]:e.max,delay:g,duration:m,group:{bottom:!0}});this.animator.add(r)}}},insertDetails:function(t,i,s){for(var e,a,h,o,r,t=Math.ceil(L.TUtils.getXIndex(this.data.x,t)),n=Math.ceil(L.TUtils.getXIndex(this.data.x,i)),d=s.x.length-1,l=(i>this.data.x[n]&&n++,t),p=n-("bar"==this.graphStyle||"step"==this.graphStyle?1:0),c=this.data.x.length-1,m=[],g=[],u=[],x=[],v=[],f=[],y=0;y<l;y++)m[e=+y]=this.data.x[y],g[e]=this.data.dates[y],u[e]=this.data.datesShort[y],x[e]=this.data.datesRange[y];for(j=0;j<this.data.ys.length;j++)for(v[j]=v[j]||[],a=v[j],o=this.data.ys[j].y,y=0;y<l;y++)a[+y]=o[y];var M=[],_=[],T=[],b=L.TUtils.getFormatter("xTooltipFormatter",this.data,1),w=L.TUtils.getFormatter("xTickFormatter",this.data,1),S=L.TUtils.getFormatter("xRangeFormatter",this.data,1),D=0;for(y=0;y<=d;y++){m[e=+y+l]=s.x[y],g[e]=b(m[e],!0),u[e]=w(m[e],!0),x[e]=S(m[e],!0),u[e].length>D&&(D=u[e].length);var $=L.TUtils.getXIndex(this.data.x,m[e]);M[y]=$,_[y]=Math.floor($),T[y]=Math.ceil($)}for(this.data.details.maxXTickLength=D,j=0;j<this.data.ys.length;j++)for(v[j]=v[j]||[],a=v[j],o=this.data.ys[j].y,r=s.y[j],f[j]=f[j]||[],h=f[j],y=0;y<=d;y++){P="bar"==this.graphStyle?o[_[y]]||0:"step"==this.graphStyle?o[_[y]]:o[_[y]]+(M[y]-_[y])*(o[T[y]]-o[_[y]]);var P,I=r[y];"bar"!==this.graphStyle&&isNaN(P)&&!isNaN(I)&&(P=0),a[+y+l]=I,h[+y+l]=P}for(y=1+p;y<=c;y++)m[e=y-p+d+l]=this.data.x[y],g[e]=this.data.dates[y],u[e]=this.data.datesShort[y],x[e]=this.data.datesRange[y];for(j=0;j<this.data.ys.length;j++)for(v[j]=v[j]||[],a=v[j],o=this.data.ys[j].y,y=1+p;y<=c;y++)a[y-p+d+l]=o[y];for(this.state.detailInd1=l,this.state.detailInd2=+(l+d),this.data.x=m,this.data.dates=g,this.data.datesShort=u,this.data.datesRange=x,j=0;j<this.data.ys.length;j++)this.data.ys[j].y=v[j],this.data.ys[j].yFrom=f[j]},revertDetails:function(){for(this.data.x=this.data.saved.x,this.data.dates=this.data.saved.dates,this.data.datesShort=this.data.saved.datesShort,this.data.datesRange=this.data.saved.datesRange,i=0;i<this.data.ys.length;i++)this.data.ys[i].y=this.data.saved.y[i]}},L.TChart=t})(),(()=>{function t(t){this.opts=t,this.$canvas=document.createElement("canvas"),this.$canvas.className="tchart--graph-canvas",this.ctx=this.$canvas.getContext("2d"),t.$parent.appendChild(this.$canvas),this.deviceSpeed=void 0}var c=window.Graph.units;t.prototype={onResize:function(){var t=this.opts.settings.dpi,i=this.opts.state.dims.composer;this.$canvas.width=i.w*t,this.$canvas.height=i.h*t,this.render({top:!0,bottom:!0})},setDarkMode:function(t){this.isDarkMode=t,this.onResize()},render:function(t){var i,s,e;null==this.deviceSpeed&&(i=performance.now(),e=this.opts.state.x1,this.opts.state.x1=this.opts.state.xMainMin,this.renderInner(t),s=performance.now(),this.opts.state.x1=e),this.renderInner(t),null==this.deviceSpeed&&(e="line"==this.opts.graphStyle||"step"==this.opts.graphStyle?1.5:2,this.deviceSpeed=(s-i)/e/(this.opts.data.x.length*this.opts.data.ys.length),this.opts.state.deviceSpeed=this.deviceSpeed)},renderInner:function(t){var i,s,e=this.opts.state.dims,a=this.opts.state,h=this.ctx,o=this.opts.settings.dpi,r=this.opts.settings,n=r.PADD,d=null==a.zoomMorph?0:a.zoomMorph,l="area"==this.opts.graphStyle&&a.zoomMode&&d<1,p="area"==this.opts.graphStyle&&a.zoomMode&&1==d;this.opts.data.master&&(this.$canvas.style.opacity=a.masterVisibility),this.opts.data.slave&&(this.$canvas.style.opacity=a.slaveVisibility,this.opts.chart.$el.style.visibility=0<a.slaveVisibility?"visible":"hidden"),t.top&&(h.clearRect(e.dates.l*o,e.dates.t*o,e.dates.w*o,e.dates.h*o),("line"==this.opts.graphStyle||"step"==this.opts.graphStyle||"scatter"==this.opts.graphStyle||"area"==this.opts.graphStyle&&0<d||this.opts.data.slave&&a.slaveVisibility<1||this.opts.data.master&&a.masterVisibility<1)&&(p?h.clearRect(e.graph.l*o,(e.graph.t-18)*o,e.graph.w*o,(e.graph.h+30)*o):h.clearRect(e.graph.l*o,e.graph.t*o,e.graph.w*o,e.graph.h*o)),("area"==this.opts.graphStyle&&0==d||"bar"==this.opts.graphStyle)&&(h.clearRect(e.graph.l*o,e.graph.t*o,e.graph.w*o,(r.PADD[0]+4)*o),h.clearRect(e.graph.l*o,(e.graph.t+n[0])*o,n[3]*o,(e.graph.h-n[0]-n[2])*o),h.clearRect(e.graph.l*o,(e.graph.t+e.graph.h-n[2])*o,e.graph.w*o,n[2]*o),h.clearRect((e.graph.l+e.graph.w-n[1]-1)*o,(e.graph.t+n[0])*o,(n[1]+1)*o,(e.graph.h-n[0]-n[2])*o)),l||p||(h.save(),h.beginPath(),h.rect(e.graph.l*o,e.graph.t*o,e.graph.w*o,e.graph.h*o),h.clip()),this.opts.data.master&&a.masterVisibility<1&&(h.save(),i=5*(1-a.masterVisibility)+1,h.translate(e.graph.w*a.zoomSpecialOrigin*(1-i),0),h.scale(i,1)),this.opts.data.slave&&a.slaveVisibility<1&&(h.save(),i=a.slaveVisibility,h.translate(e.graph.w*a.zoomSpecialOrigin*(1-i),0),h.scale(i,1)),n=1,"area"==this.opts.graphStyle&&a.zoomMode&&(n=1-d),l&&(h.save(),i=r.PIE_RADIUS,r=e.graph.w+d*(2*i-e.graph.w),s=e.graph.h-42+d*(2*i-e.graph.h+42),c.TUtils.drawRoundedRect2(h,o,r,s,(e.graph.w-r)/2+e.graph.l,(e.graph.h-42-s)/2+e.graph.t+23,d*i),h.clip()),this.opts.chart.graph.render(),l&&h.restore(),this.opts.data.master&&a.masterVisibility<1&&h.restore(),this.opts.data.slave&&a.slaveVisibility<1&&h.restore(),this.opts.chart.axisY.render(n),this.opts.chart.fade.render(),l||p||h.restore(),this.opts.chart.axisX.render(n)),t.bottom&&(h.clearRect(e.graph.l*o,(e.handle.t-1)*o,e.graph.w*o,(e.handle.h+2)*o),r=this.opts.data.subchart.show,(r=(s=!this.opts.data.master&&!this.opts.data.slave&&this.opts.data.details&&this.opts.data.subchart.show!=this.opts.data.details.subchart.show)?r?d<1:0<d:r)&&(h.save(),c.TUtils.drawRoundedRect(h,o,e.mini.w,e.mini.h,e.mini.l,e.mini.t,7),h.clip(),this.opts.chart.mini.render(),h.restore(),this.opts.chart.handle.render()),s)&&0<d&&d<1&&(h.fillStyle=this.isDarkMode?"#242f3e":"#fff",h.globalAlpha=this.opts.data.subchart.show?d:1-d,h.fillRect(e.graph.l*o,(e.handle.t-1)*o,e.graph.w*o,(e.handle.h+2)*o),h.globalAlpha=1)}},c.TComposer=t})(),(()=>{function t(t){this.opts=t,this.onDragStart=this.onDragStart.bind(this),this.onDragMove=this.onDragMove.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.isTouch=s.TUtils.isTouchDevice(),this.skipMoveEnd=!0;var i=t.useElForMove?t.$el:window;t.$el.addEventListener(this.isTouch?"touchstart":"mousedown",this.onDragStart,{passive:!1}),i.addEventListener(this.isTouch?"touchmove":"mousemove",this.onDragMove,{passive:!1}),i.addEventListener(this.isTouch?"touchend":"mouseup",this.onDragEnd,{passive:!1})}var s=window.Graph.units;t.prototype={onDragStart:function(t){this.skipMoveEnd=!0,clearTimeout(this.pointerTimeout),this.isTouch&&1<t.touches.length||(this.scroll=void 0,this.x=(this.isTouch?t.touches[0]:t).pageX,this.y=(this.isTouch?t.touches[0]:t).pageY,this.dX=0,this.dY=0,this.pageX=this.x,this.pageY=this.y,delete this.prevDx,delete this.prevDy,this.opts.onDragStart({pageX:this.x,pageY:this.y,isTouch:this.isTouch}))||(this.skipMoveEnd=!1)},onDragMove:function(t){var i,s;this.skipMoveEnd||"v"!=this.scroll&&(i=(this.isTouch?t.touches[0]:t).pageX,s=(this.isTouch?t.touches[0]:t).pageY,this.dX=i-this.x,this.dY=s-this.y,this.pageX=i,this.pageY=s,this.isTouch&&("h"==this.scroll?this.opts.noPrevent||t.preventDefault():(5<Math.abs(this.dX)||5<Math.abs(this.dY))&&(this.scroll=Math.abs(this.dX)>Math.abs(this.dY)?"h":"v")),this.prevDx!=this.dX||this.prevDy!=this.dY)&&(this.opts.onDragMove&&this.opts.onDragMove({canceled:"v"==this.scroll,d:this.dX,pageX:this.pageX,pageY:this.pageY,isTouch:this.isTouch}),this.prevDx=this.dX,this.prevDy=this.dY)},onDragEnd:function(t){this.skipMoveEnd||(this.skipMoveEnd=!0,this.opts.onDragEnd&&this.opts.onDragEnd({isTouch:this.isTouch,e:t}))}},s.TDrag=t})(),(()=>{function t(t){this.opts=t,this.ctx=t.ctx,"area"!=this.opts.graphStyle&&(this.$fadeTop=document.createElement("canvas"),this.ctxFadeTop=this.$fadeTop.getContext("2d"),"bar"!=this.opts.graphStyle)&&(this.$fadeBottom=document.createElement("canvas"),this.ctxFadeBottom=this.$fadeBottom.getContext("2d"))}t.prototype={onResize:function(){var t,i=this.opts.settings.dpi,s=this.opts.state.dims.fadeTop,e=this.opts.state.dims.fadeBottom,a=(a=getComputedStyle(this.opts.$canvas).getPropertyValue("--tchart-fade-color"))||(this.isDarkMode?"rgba(36,47,62,1)":"rgba(255,255,255,1)");"area"!=this.opts.graphStyle&&((t=this.ctxFadeTop.createLinearGradient(0,0,0,s.h*i)).addColorStop(0,a),t.addColorStop(1,a),this.$fadeTop.width=s.w*i,this.$fadeTop.height=s.h*i,this.ctxFadeTop.fillStyle=t,this.ctxFadeTop.fillRect(0,0,s.w*i,s.h*i),"bar"!=this.opts.graphStyle)&&((t=this.ctxFadeBottom.createLinearGradient(0,0,0,e.h*i)).addColorStop(0,a),t.addColorStop(1,a),this.$fadeBottom.width=e.w*i,this.$fadeBottom.height=e.h*i,this.ctxFadeBottom.fillStyle=t,this.ctxFadeBottom.fillRect(0,0,e.w*i,e.h*i))},setDarkMode:function(t){this.isDarkMode=t,this.onResize()},render:function(){var t=this.opts.settings.dpi,i=this.opts.state.dims.fadeTop,s=this.opts.state.dims.fadeBottom;this.$fadeTop&&this.ctx.drawImage(this.$fadeTop,i.l*t,i.t*t),this.$fadeBottom&&this.ctx.drawImage(this.$fadeBottom,s.l*t,s.t*t)}},window.Graph.units.TFade=t})(),(()=>{function t(e){this.opts=e,this.ctx=e.ctx,this.isTouch=h.TUtils.isTouchDevice(),this.$canvas=e.$canvas,this.drag=new h.TDrag({$el:this.$canvas,onDragStart:function(t){this.canvasPos=h.TUtils.getElemPagePos(this.$canvas);var i=t.pageX-this.canvasPos.x,s=t.pageY-this.canvasPos.y;return this._x1=e.state.x1,this._x2=e.state.x2,this.constrainHandleSize(!1),this.tp=this.getTp(i-e.settings.PADD[3],s-(this.opts.state.dims.composer.h-e.settings.MINI_GRAPH_HEIGHT-e.settings.MINI_GRAPH_BOTTOM),t.isTouch),this.firstMove=!0,!this.tp}.bind(this),onDragMove:function(t){this.onDragMove(t.d),this.firstMove=!1}.bind(this),onDragEnd:function(t){}.bind(this)}),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.trackMouse(!0)}var h=window.Graph.units;t.prototype={getTp:function(t,i,s){var e,a=this.opts.state.dims.handle,h=this.opts.state,o=this.opts.state.zoomMode;return i<0||i>a.h?"":(i=s?.3*a.w:10,s&&i<14&&(i=14),e=(a=this.prevX1+(s?h.x1==h.xg1?-5:-15:0))+(i=s&&30<i?30:i),i=(s=this.prevX2+(s?h.x2==h.xg2?5:15:0))-i,(e=Math.abs(h.x2-h.x1-(o?this.opts.data.mainPeriodLen:this.minRange))<.01&&(h.x2==h.xg2&&(i=s+1),h.x1==h.xg1)?a-1:e)<t&&t<i?"both":a<=t&&t<=e?"start":i<=t&&t<=s?"end":"")},trackMouse:function(t){this.isTouch||(this.$canvas.addEventListener("mousemove",this.onMouseMove),this.$canvas.addEventListener("mouseleave",this.onMouseLeave))},onMouseLeave:function(){this.$canvas.classList.remove("tchart--graph-canvas__handle-pointer"),this.$canvas.classList.remove("tchart--graph-canvas__handle-grab"),this.$canvas.classList.remove("tchart--graph-canvas__handle-col-resize"),delete this.canvasPos},onMouseMove:function(t){this.canvasPos=this.canvasPos||h.TUtils.getElemPagePos(this.$canvas);var i=t.pageX-this.canvasPos.x,t=t.pageY-this.canvasPos.y,i=this.getTp(i-this.opts.settings.PADD[3],t-(this.opts.state.dims.composer.h-this.opts.settings.MINI_GRAPH_HEIGHT-this.opts.settings.MINI_GRAPH_BOTTOM),!1),t={"":"",both:this.opts.settings.isIE?"pointer":"grab",start:"col-resize",end:"col-resize"};this.onMouseLeave(),t[i]&&this.$canvas.classList.add("tchart--graph-canvas__handle-"+t[i])},onResize:function(t){this.constrainHandleSize(!0)},setDarkMode:function(t){this.isDarkMode=t},constrainHandleSize:function(t){var i=32/(this.opts.state.dims.handle.w/(this.opts.state.xg2-this.opts.state.xg1)),s=this.opts.state.x1,e=this.opts.state.x2,a=(this.opts.state.xg1,this.opts.state.xg2);e-s<(this.minRange=i)&&(a<(e=s+i)&&(s=(e=a)-i),t)&&this.opts.additional.cb(s,e,"constraint")},onDragMove:function(t){var i,s,e=this.opts.state.dims.handle,a=this.tp,h=this.opts.state,t=t/e.w*(h.xg2-h.xg1),e=this._x1,o=this._x2;"both"==a&&(s=o+t,(i=e+t)<h.xg1&&(i=h.xg1,s=h.xg1+o-e),s>h.xg2)&&(i=h.xg2-(o-e),s=h.xg2),"start"==a&&(s=h.x2,i=Math.min(Math.max(e+t,h.xg1),s-this.minRange)),"end"==a&&(i=h.x1,s=Math.max(Math.min(o+t,h.xg2),i+this.minRange)),h.x1==i&&h.x2==s||this.opts.additional.cb(i,s,a,this.firstMove)},render:function(){var t=this.opts.state.dims.handle,i=this.opts.settings.dpi,s=this.opts.state,e=1/(s.xg2-s.xg1),a=Math.round((s.x1-s.xg1)*e*t.w),s=Math.round((s.x2-s.xg1)*e*t.w),e=this.ctx;e.fillStyle=this.isDarkMode?"rgba(48, 66, 89, 0.6)":"rgba(226, 238, 249, 0.6)",h.TUtils.drawRoundedRect(e,i,a+4,t.h-2,t.l,t.t+1,[7,0,0,7]),e.fill(),h.TUtils.drawRoundedRect(e,i,t.w-s+4,t.h-2,t.l+s-4,t.t+1,[0,7,7,0]),e.fill(),this.isDarkMode||"line"==this.opts.graphStyle||"step"==this.opts.graphStyle||(e.fillStyle="#fff",h.TUtils.drawRoundedRect(e,i,12,t.h+2,t.l+a-1,t.t-1,[8,0,0,8]),e.fill(),h.TUtils.drawRoundedRect(e,i,12,t.h+2,t.l+s-11,t.t-1,[0,8,8,0]),e.fill()),e.fillStyle=this.isDarkMode?"#56626D":"#C0D1E1",h.TUtils.drawRoundedRect(e,i,10,t.h,t.l+a,t.t,[7,0,0,7]),e.fill(),h.TUtils.drawRoundedRect(e,i,10,t.h,t.l+s-10,t.t,[0,7,7,0]),e.fill(),e.fillRect((t.l+a+10)*i,t.t*i,(s-a-20)*i,i),e.fillRect((t.l+a+10)*i,(t.t+t.h-1)*i,(s-a-20)*i,i),e.strokeStyle="#fff",this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.lineWidth=2*i,e.beginPath(),e.moveTo((t.l+a+5)*i,(t.t+17)*i),e.lineTo((t.l+a+5)*i,(t.t+25)*i),e.moveTo((t.l+s-5)*i,(t.t+17)*i),e.lineTo((t.l+s-5)*i,(t.t+25)*i),e.stroke(),this.prevX1=a,this.prevX2=s}},h.THandle=t})(),(()=>{function t(t){this.opts=t,this.$canvas=document.createElement("canvas"),this.ctx=this.$canvas.getContext("2d",{alpha:!0})}var V=window.Graph.units;t.prototype={onResize:function(){var t=this.opts.settings.dpi,i=this.opts.additional.mini?this.opts.state.dims.mini:this.opts.state.dims.graph;this.$canvas.width=i.w*t,this.$canvas.height=i.h*t,this.cached="",this.ctx.fillStyle=this.isDarkMode?"#242f3e":"#fff",this.ctx.fillRect(0,0,i.w*t,i.h*t)},setDarkMode:function(t){this.isDarkMode=t},render:function(){var t,i,s,e,a=this.opts,h=a.data.ys,o=a.state,r=a.additional.mini,n=r||a.data.master&&o.masterVisibility<1&&0<o.masterVisibility||a.data.slave&&o.slaveVisibility<1&&0<o.slaveVisibility,d=r?o.xg1:o.x1,l=r?o.xg2:o.x2,p=a.settings,C=p["PADD"+(r?"_MINI":"")][0],F=p["PADD"+(r?"_MINI":"")][1],H=p["PADD"+(r?"_MINI":"")][2],p=p["PADD"+(r?"_MINI":"")][3],c=a.data.x,m=a.settings.dpi,g=(n?this:this.opts).ctx,u=r?o.dims.mini:o.dims.graph,x=o.zoomMode,N=o.detailInd1,X=o.detailInd2,v=null==o.zoomMorph?0:o.zoomMorph,f=h.length,y="step"==a.graphStyle,M=(u.w-F-p)/(l-d+(y?this.opts.data.mainPeriodLen*(1-v):0)),_=Math.floor(V.TUtils.getXIndex(c,d-p/M)),T=Math.ceil(V.TUtils.getXIndex(c,l+F/M)),U=(p+(n?0:u.l))*m-d*(M*=m),Y=(y&&x&&1==v&&(_<this.opts.state.xg1Ind&&(_=this.opts.state.xg1Ind),T>this.opts.state.xg2Ind)&&(T=this.opts.state.xg2Ind-1),this.opts.data.mainPeriodLen*M),B=this.opts.data.detailPeriodLen*M;if(n){var b=[u.w,u.h,r?o.xg1:o.x1,r?o.xg2:o.x2,this.isDarkMode,x];for(r||(b.push(o.y1),b.push(o.y2)),t=0;t<f;t++)b.push(r?o["om_"+t]:o["o_"+t]),b.push(o["f_"+t]);if((b=b.join(","))==this.cached)return void this.opts.ctx.drawImage(this.$canvas,u.l*m,u.t*m);this.cached=b,g.clearRect(0,0,u.w*m,u.w*m)}var l=(a.additional.mini?1:"auto"==a.data.strokeWidth?5<f?1:2:a.data.strokeWidth)*m,w=l%2==0?0:.5;for(g.lineWidth=l,g.lineCap=a.additional.mini?"square":"round",g.lineJoin=a.additional.mini?"square":"round",t=0;t<f;t++)if(i=r?o["om_"+t]:o["o_"+t],I=o["e_"+t],0<i){for(var S,D,$,P=h[t].y,G=h[t].yFrom,I=a.pairY?(s=r?o["y1m_"+t]:o["y1_"+t],r?o["y2m_"+t]:o["y2_"+t]):r?I&&i<1?(s=o.y1m_show,o.y2m_show):!I&&i<1?(s=o.y1m_hidd,o.y2m_hidd):(s=o.y1m,o.y2m):(s=o.y1,o.y2),O=m*(u.h-C-H)/(I-s),W=(u.h-H+(n?0:u.t))*m+s*O,L=(g.beginPath(),g.strokeStyle=(this.isDarkMode?h[t].colors_n:h[t].colors_d)[0],g.globalAlpha=i*(.9*o["f_"+t]+.1),Number.MAX_VALUE),A=-Number.MAX_VALUE,E=-Number.MAX_VALUE,k=!1,z=!0,R=_;R<=T;R++)e=x?N<=R&&R<=X?(S=G[R]+v*(P[R]-G[R]),B):(S=P[R]+v*(P[N]-P[R]),Y):(S=P[R],Y),isNaN(S)?z=!0:(D=c[R]*M+U<<0,yc=W-S*O<<0,E<D||y&&R==X+1?(k&&($==L?(g.moveTo(E+w,A-w),g.lineTo(E+w,L-w)):(g.moveTo(E+w,L-w),g.lineTo(E+w,A-w),$!=A&&g.moveTo(E+w,$-w)),k=!1),z&&(g.moveTo(D+w,yc-w),z=!1),A=L=yc,g.lineTo(D+w,yc-w),y&&g.lineTo((c[R]*M+e+U<<0)+w,yc-w)):(L=Math.min(L,yc),A=Math.max(A,yc),k=!0),E=D,$=yc);k&&(g.moveTo(E+w,L-w),g.lineTo(E+w,A-w)),g.stroke()}g.globalAlpha=1,n&&this.opts.ctx.drawImage(this.$canvas,u.l*m,u.t*m)}},V.TLines=t})(),(()=>{function t(r){var n,d;this.opts=r,this.isTouch=l.TUtils.isTouchDevice(),this.enabled=r.data.ys.length,1!=this.enabled||r.data.forceLegend||(r.$parent.style.display="none"),this.switchers=r.data.ys.map(function(t,s){var i,e,a,h=document.createElement("div"),o=(h.className="tchart--switcher",r.state["e_"+s]?h.classList.toggle("tchart--switcher__active"):this.enabled--,h.setAttribute("data-label",t.label),r.$parent.appendChild(h),document.createElement("span"));return o.textContent=t.label,h.appendChild(o),this.isTouch||(h.addEventListener("mouseenter",function(t){r.state["e_"+s]&&r.additional.onEnter(s)}),h.addEventListener("mouseleave",function(t){r.state["e_"+s]&&r.additional.onLeave(s)})),h.addEventListener("click",function(t){var i;d?d=!1:(i=h.classList.contains("tchart--switcher__active"))&&1==this.enabled?(h.classList.add("tchart--switcher__denied"),clearTimeout(n),n=setTimeout(function(){h.classList.remove("tchart--switcher__denied")},500)):(this.isTouch||(i?r.additional.onLeave(s):r.additional.onEnter(s)),r.additional.onClick(!i,s))}.bind(this)),this.drag=new l.TDrag({$el:h,noPrevent:!0,useElForMove:!0,onDragStart:function(t){i=t.pageX,e=t.pageY,a=setTimeout(function(){d=!0,this.isTouch||r.additional.onEnter(s),r.additional.onLongTap(s)}.bind(this),500)}.bind(this),onDragMove:function(t){(5<Math.abs(i-t.pageX)||5<Math.abs(e-t.pageY))&&clearTimeout(a)}.bind(this),onDragEnd:function(t){clearTimeout(a)}.bind(this)}),h}.bind(this)),this.updateColors()}var l=window.Graph.units;t.prototype={onResize:function(){},updateColors:function(){for(var t=this.opts.data.ys,i=0;i<this.switchers.length;i++)this.switchers[i].style.color=(this.isDarkMode?t[i].colors_n:t[i].colors_d)[1]},setDarkMode:function(t){this.isDarkMode=t,this.updateColors()},render:function(t){for(var i=this.enabled=0;i<this.switchers.length;i++)t[i]?(this.enabled++,this.switchers[i].classList.add("tchart--switcher__active")):this.switchers[i].classList.remove("tchart--switcher__active")}},l.TSwitchers=t})(),(()=>{function t(t){var i;this.opts=t,this.shown=!1,this.isTouch=S.TUtils.isTouchDevice(),this.$canvas=t.$canvas,this.cache={},this.$tip=document.createElement("div"),this.$tip.className="tchart--tip",t.$parent.appendChild(this.$tip),this.$tipDt=document.createElement("h6"),this.$tip.appendChild(this.$tipDt),this.$tipDtText=document.createTextNode(""),this.$tipDt.appendChild(this.$tipDtText),this.$tipDtText.nodeValue=".",this.$tipArrow=document.createElement("div"),this.$tipArrow.className="tchart--tip-arrow",this.$tip.appendChild(this.$tipArrow),this.$tipLoader=document.createElement("div"),this.$tipLoader.className="tchart--tip-loader",this.$tip.appendChild(this.$tipLoader),this.$tipScrollerWrapper=document.createElement("div"),this.$tipScrollerWrapper.className="tchart--tip-scroller-wrapper",this.$tip.appendChild(this.$tipScrollerWrapper),this.$tipScroller=document.createElement("div"),this.$tipScroller.className="tchart--tip-scroller",this.$tipScrollerWrapper.appendChild(this.$tipScroller),this.updateTipScrollClasses=this.updateTipScrollClasses.bind(this),this.$tipScroller.addEventListener("scroll",this.updateTipScrollClasses),this.labels=[],t.data.ys.forEach(function(t,i){this.labels.push(this.addLabel(t))}.bind(this)),"bar"==t.graphStyle&&1<t.data.ys.length&&(this.allLabel=this.addLabel({label:"All",outside:!0})),"area"==t.graphStyle&&(this.pieLabel=this.addLabel({label:"pie",outside:!0})),this.tooltipOnHover=!this.isTouch&&t.data.tooltipOnHover,this.tooltipSortOrder=!0===(i=t.data.tooltipSort)||"desc"===i?"desc":"asc"===i?"asc":null,"bar"!=t.graphStyle?(this.$line=document.createElement("div"),this.$line.className="tchart--line",t.$parent.appendChild(this.$line),this.$lineFill=document.createElement("div"),this.$line.appendChild(this.$lineFill),"area"!=t.graphStyle&&(this.points=t.data.ys.map(function(t,i){var s=document.createElement("span");return this.$line.appendChild(s),s}.bind(this)))):(t.state.barInd=-1,t.state.barO=0),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onBodyClick=this.onBodyClick.bind(this),this.onTipClick=this.onTipClick.bind(this),this.tooltipOnHover?(this.$canvas.addEventListener("mousemove",function(t){this.canvasPos=this.canvasPos||S.TUtils.getElemPagePos(this.$canvas),this.dx=t.pageX-this.canvasPos.x,this.dy=t.pageY-this.canvasPos.y;t=this.opts.state.dims.tip;this.tp=this.getTp(this.dx,this.dy-t.t,this.isTouch),this.tp?this.shown?this.render({isMove:!0}):(delete this.prevXInd,this.toggle(!0),this.render({})):this.toggle(!1)}.bind(this)),this.$canvas.addEventListener("mouseleave",function(){delete this.canvasPos,this.toggle(!1)}.bind(this)),this.$canvas.addEventListener("click",function(t){this.shown&&this.onTipClick(t)}.bind(this)),this.$tip.style.pointerEvents="none"):(this.drag=new S.TDrag({$el:this.$canvas,onDragStart:function(t){this.canvasPos=S.TUtils.getElemPagePos(this.$canvas),this.dx=t.pageX-this.canvasPos.x,this.dy=t.pageY-this.canvasPos.y;var i=this.opts.state.dims.tip;return this.tp=this.getTp(this.dx,this.dy-i.t,t.isTouch),delete this.prevXInd,clearTimeout(this.showTimeout),this.showTimeout=setTimeout(function(){this.toggle(!!this.tp),this.tp&&this.render()}.bind(this),this.isTouch?100:30),document.body.removeEventListener("click",this.onBodyClick),!this.tp}.bind(this),onDragMove:function(t){t.canceled?(clearTimeout(this.showTimeout),this.toggle(!1)):(this.canvasPos=this.canvasPos||S.TUtils.getElemPagePos(this.$canvas),this.dx=t.pageX-this.canvasPos.x,this.dy=t.pageY-this.canvasPos.y,this.render({isMove:!0}))}.bind(this),onDragEnd:function(t){delete this.canvasPos,this.bodyTimeout=setTimeout(function(){document.body.addEventListener("click",this.onBodyClick)}.bind(this),140)}.bind(this)}),this.$tip.addEventListener("click",this.onTipClick)),this.trackMouse(!0),this.updateColors()}var S=window.Graph.units;t.prototype={onResize:function(t){var i,s=this.opts.state.dims.tip;this.$line&&(i="area"==this.opts.graphStyle?25:16,this.$line.style.top=s.t+"px",this.$line.style.height=s.h+"px",this.$lineFill.style.top=i+"px",this.$lineFill.style.bottom=this.opts.settings.PADD[2]+1+"px"),this.render()},abortDetailCallbacks:function(){this.detailCallbacks&&(this.detailCallbacks.forEach(function(t,i){t.cancelled=!0}),delete this.detailCallbacks)},onTipClick:function(t){if("scatter"===this.opts.graphStyle){var i,s=this.lastScatterPoint;if(s||null==this.dx||null==this.dy||(a=this.opts.state.dims.tip,i=this.opts.state.dims.graph,i=this.dx-i.l,a=this.dy-a.t,s=(i=this.opts.chart.graph.pickPoint(i,a))&&i.point),s&&s.href){t&&(t.stopPropagation(),t.preventDefault)&&t.preventDefault(),this.toggle(!1,!0);try{window.open(s.href,"_blank","noopener,noreferrer")}catch(t){}}}else{var e,a,h,o,r;null==this.prevXInd||!this.opts.additional.onClick||!this.opts.data.hasDetail||this.opts.state.zoomMode||this.opts.state.zoomModeSpecial||(t.stopPropagation(),this.$tip.classList.contains("tchart--tip__loading"))||(e=this.opts.data.x[this.prevXInd],this.opts.data.detailsFunc?(this.$tip.classList.remove("tchart--tip__error"),this.$tip.classList.add("tchart--tip__loading"),this.cache[e]?(this.toggle(!1,!0),this.opts.additional.onClick(!0,e,this.cache[e]),this.$tip.classList.remove("tchart--tip__loading")):(this.abortDetailCallbacks(),a=this.opts.data.detailsFunc(e),(h=this).detailCallbacks=this.detailCallbacks||[],o=function(t){o.cancelled||(h.$tip.classList.remove("tchart--tip__loading"),t&&t.columns?(h.toggle(!1,!0),h.opts.additional.onClick(!0,e,t),h.cache[e]=t):h.$tip.classList.add("tchart--tip__error"))},r=function(t){r.cancelled||(h.$tip.classList.remove("tchart--tip__loading"),"default"===t&&h.opts.additional.onClick&&h.opts.data.hasDetail&&"area"==h.opts.graphStyle?(h.toggle(!1,!0),h.opts.additional.onClick(!0,e)):(console.log("error:",t),h.$tip.classList.add("tchart--tip__error")))},this.detailCallbacks.push(o),this.detailCallbacks.push(r),a.then(o).catch(r))):(this.toggle(!1,!0),this.opts.additional.onClick(!0,e)))}},updateColors:function(){var s=this.opts.data.ys;this.labels.forEach(function(t,i){this.points&&(this.points[i].style.borderColor=(this.isDarkMode?s[i].colors_n:s[i].colors_d)[0]),t.$value.style.color=(this.isDarkMode?s[i].colors_n:s[i].colors_d)[2]}.bind(this)),this.allLabel&&(this.allLabel.$value.style.color=this.isDarkMode?"#fff":"#000"),this.$lineFill&&(this.$lineFill.style.backgroundColor=this.isDarkMode?"rgba(255, 255, 255, 0.1)":"rgba(24, 45, 59, 0.1)")},setDarkMode:function(t){this.isDarkMode=t,this.updateColors()},addLabel:function(t){var i,s,e=document.createElement("div"),a=(e.className="tchart--tip-row",t.outside?(this.$tip.appendChild(e),e.classList.add("tchart--tip-row__outside")):this.$tipScroller.appendChild(e),document.createElement("span")),h=(e.appendChild(a),document.createTextNode("")),t=(h.nodeValue=t.label,a.appendChild(h),"area"==this.opts.graphStyle&&(s=document.createElement("p"),e.appendChild(s),i=document.createTextNode(""),s.appendChild(i)),document.createElement("div")),o=(e.appendChild(t),document.createTextNode(""));return t.appendChild(o),{$row:e,$value:t,$valueText:o,$label:a,$labelText:h,$per:s,$perText:i}},getTp:function(t,i,s){var e,a,h,o;return"area"==this.opts.graphStyle&&this.opts.state.zoomMode?(e=(o=this.opts.state.dims.graph).w/2,h=o.h/2,Math.pow((h-i)*(h-i)+(t-e)*(t-e),.5)<=this.opts.settings.PIE_RADIUS?"graph":""):"scatter"==this.opts.graphStyle?(h=this.opts.state.dims.tip,t=t-(e=this.opts.state.dims.graph).l,!((a=i)<0||a>h.h)&&!(t<0||t>e.w)&&(h=this.opts.chart.graph.pickPoint(t,a),this._scatterLastPick=h,this._scatterLastPickGX=t,this._scatterLastPickGY=a,h)?"graph":""):(o=this.opts.state.dims.tip,i<0||i>o.h?"":"graph")},trackMouse:function(t,i){this.isTouch||(this.$canvas.addEventListener("mousemove",this.onMouseMove),this.$canvas.addEventListener("mouseleave",this.onMouseLeave))},onMouseLeave:function(){this.$canvas.classList.remove("tchart--graph-canvas__tip-pointer"),delete this.canvasPos},onMouseMove:function(t){this.canvasPos=this.canvasPos||S.TUtils.getElemPagePos(this.$canvas);var i=t.pageX-this.canvasPos.x,t=t.pageY-this.canvasPos.y,s=this.opts.state.dims.tip,e=this.getTp(i,t-s.t,!1);this.onMouseLeave(),"scatter"===this.opts.graphStyle?(i=i-this.opts.state.dims.graph.l,t=t-s.t,s=null,this._scatterLastPickGX===i&&this._scatterLastPickGY===t?s=this._scatterLastPick:(s=this.opts.chart.graph.pickPoint(i,t),this._scatterLastPick=s,this._scatterLastPickGX=i,this._scatterLastPickGY=t),s&&s.point&&s.point.href&&this.$canvas.classList.add("tchart--graph-canvas__tip-pointer")):e&&this.$canvas.classList.add("tchart--graph-canvas__tip-pointer")},toggle:function(t,i){var s=this.opts,e=s.state;if(t&&!this.shown&&(this.$tip.classList.add("tchart--tip__visible"),"scatter"===this.opts.graphStyle||!this.opts.data.hasDetail||this.opts.state.zoomMode||this.opts.state.zoomModeSpecial?this.$tip.classList.remove("tchart--tip__has-zoom"):this.$tip.classList.add("tchart--tip__has-zoom"),this.$tip.classList.remove("tchart--tip__shiftHide"),this.$line&&"scatter"!==this.opts.graphStyle&&this.$line.classList.add("tchart--line__visible"),S.TUtils.triggerEvent("chart-hide-tips",{except:this.opts.chart})),!t&&this.shown){if("scatter"===this.opts.graphStyle&&this.opts.chart&&this.opts.chart.graph&&this.opts.chart.graph.clearHover&&this.opts.chart.graph.clearHover(),delete this.lastCurPieItemInd,"area"==s.graphStyle&&e.zoomMode){for(var a=[],h=0;h<e.pieAngles.length;h++){var o=e.pieAngles[h];a.push({prop:"pieInd_"+o.ind,state:s.state,end:0,duration:350,tween:"exp",speed:.2,group:{top:!0}})}s.animator.add(a)}i&&(this.$tip.classList.add("tchart--tip__shiftHide"),this.lastTipTop-=12,this.lastTipLeft=this.lastTipLeft<this.opts.state.dims.tip.w/2?this.lastTipLeft-12:this.lastTipLeft+12,this.$tip.style.transform="translate("+this.lastTipLeft+"px,"+this.lastTipTop+"px)",this.$tip.style.webkitTransform="translate("+this.lastTipLeft+"px,"+this.lastTipTop+"px)"),this.$tip.classList.remove("tchart--tip__visible"),this.$line&&"scatter"!==this.opts.graphStyle&&this.$line.classList.remove("tchart--line__visible"),this.abortDetailCallbacks(),this.$tip.classList.remove("tchart--tip__error"),this.$tip.classList.remove("tchart--tip__loading"),"bar"==this.opts.graphStyle&&this.opts.animator.add([{prop:"barInd",state:this.opts.state,end:-1,duration:0,delay:150,tween:"linear",group:{top:!0}},{prop:"barO",state:this.opts.state,end:0,duration:150,tween:"exp",speed:.3,group:{top:!0}}]),document.body.removeEventListener("click",this.onBodyClick)}this.shown=t},onBodyClick:function(t){t.target!=this.$canvas&&this.toggle(!1)},renderPieTooltip:function(t){for(var i,s=this.opts,e=s.state,a=this.opts.settings,h=a.PADD[0],o=a.PADD[1],r=a.PADD[2],a=a.PADD[3],n=e.dims.graph,d=e.dims.tip,l=n.w/2,p=n.h/2,c=S.TUtils.getFormatter("yTooltipFormatter",s.data,e.zoomMorph),m=(m=Math.atan2(p-this.dy+n.t,this.dx-l))<0?2*Math.PI+m:m,g=0;g<e.pieAngles.length;g++)m<=(x=e.pieAngles[g]).st&&m>=x.ed&&(i=x),m-2*Math.PI<=x.st&&m-2*Math.PI>=x.ed&&(i=x);if(this.lastCurPieItemInd!=i.ind){for(var u=[],g=0;g<e.pieAngles.length;g++){var x=e.pieAngles[g];u.push({prop:"pieInd_"+x.ind,state:s.state,end:x==i?1:0,duration:350,tween:"exp",speed:.2,group:{top:!0}})}s.animator.add(u)}this.pieLabel.$row.style.display="block",this.labels.forEach(function(t,i){t.$row.style.display="none"}.bind(this)),this.pieLabel.$labelText.nodeValue=i.label,this.pieLabel.$valueText.nodeValue=isNaN(i.value)?"n/a":c(i.value),this.pieLabel.$value.style.color=i.color,this.$tip.classList.add("tchart--tip__piemode"),this.$line&&this.$line.classList.add("tchart--line__piemode"),this.tipH=this.$tip.offsetHeight,this.tipW=this.$tip.offsetWidth;p=this.dx-this.tipW/2,n=Math.min(this.dy-20-this.tipH,d.t+d.h-this.tipH-r);n<d.t+h&&(n=d.t+h),p=Math.min(Math.max(p,a/2),d.w-this.tipW-o/2),this.$tip.style.transform="translate("+(p<<0)+"px,"+(n<<0)+"px)",this.$tip.style.webkitTransform="translate("+(p<<0)+"px,"+(n<<0)+"px)",this.lastCurPieItemInd=i.ind,this.updateTipScrollClasses()},render:function(t){if(this.shown){var s,e,a,h=this.opts,o=h.state,i=this.opts.settings,r=i.PADD[0],n=i.PADD[1],d=i.PADD[2],i=i.PADD[3],l=0,p=this.opts.state.dims.tip,c=S.TUtils.getFormatter("yTooltipFormatter",h.data,o.zoomMorph),m=null==o.zoomMorph?0:o.zoomMorph,m=("bar"==h.graphStyle||"step"==h.graphStyle?this.opts.data.mainPeriodLen:0)*(1-m);if(t=t||{},this.abortDetailCallbacks(),this.$tip.classList.remove("tchart--tip__error"),this.$tip.classList.remove("tchart--tip__loading"),"area"==h.graphStyle&&o.zoomMode)this.renderPieTooltip(t);else if("scatter"==h.graphStyle)this.renderScatterTooltip(t);else{this.pieLabel&&(this.pieLabel.$row.style.display="none");var g=Math.max(Math.min(this.dx,p.w-1),0),g=o.x1+(o.x2-o.x1+m)*((g-i)/(p.w-n-i)),g=S.TUtils.getXIndex(h.data.x,g),u="bar"==h.graphStyle||"step"==h.graphStyle?Math.floor(g):Math.round(g);if("bar"!==h.graphStyle&&"step"!==h.graphStyle?((x=(h.data.x[u]-o.x1)/(o.x2-o.x1+m)*(p.w-i-n)+i<<0)<0&&u++,x>p.w-1&&u--):(this.opts.state.zoomMode||this.opts.state.zoomModeSpecial)&&(u<h.state.detailInd1&&u++,u>h.state.detailInd2)&&u--,"bar"==h.graphStyle&&h.animator.add([{prop:"barInd",state:h.state,end:u,duration:0,tween:"linear",group:{top:!0}},{prop:"barO",state:this.opts.state,end:1,duration:150,tween:"exp",speed:.3,group:{top:!0}}]),this.prevXInd!=u||!t.isMove){this.$tip.classList.remove("tchart--tip__piemode"),this.$line&&this.$line.classList.remove("tchart--line__piemode"),this.labels.forEach(function(t,i){var s=h.state["e_"+i]&&!isNaN(h.data.ys[i].y[u])?"block":"none";t.$row.style.display=s,this.points&&(this.points[i].style.display=s),l+="block"==s?1:0}.bind(this)),this.itemsVisible=l,this.allLabel&&(this.allLabel.$row.style.display=1<l?"block":"none"),this.itemsVisible?(this.$tip.classList.remove("tchart--tip__has_no_items"),this.$line&&this.$line.classList.remove("tchart--line__has_no_items")):(this.$tip.classList.add("tchart--tip__has_no_items"),this.$line&&this.$line.classList.add("tchart--line__has_no_items"));g=0;"step"==h.graphStyle&&(g=this.opts.state.zoomMode?h.data.detailPeriodLen:h.data.mainPeriodLen);var x=(h.data.x[u]-o.x1+g/2)/(o.x2-o.x1+m)*(p.w-i-n)+i<<0,v=(this.$line&&(this.$line.style.transform="translateX("+x+"px)"),this.$line&&(this.$line.style.webkitTransform="translateX("+x+"px)"),this.$tipDtText.nodeValue=h.data.dates[u],0);if(h.data.ys.forEach(function(t,i){h.state["e_"+i]&&!isNaN(t.y[u])&&(this.labels[i].$valueText.nodeValue=(t.ctf||c)(t.y[u]),v+=t.y[u]||0,this.points)&&(s=this.points[i],a=h.pairY?(e=o["y1_"+i],o["y2_"+i]):(e=o.y1,o.y2),i=(t.y[u]-e)/(a-e),s.style.transform="translateY("+(p.h-i*(p.h-r-d)-d<<0)+"px)",s.style.webkitTransform="translateY("+(p.h-i*(p.h-r-d)-d<<0)+"px)")}.bind(this)),this.allLabel&&(this.allLabel.$valueText.nodeValue=c(v)),this.tooltipSortOrder){for(var f=[],y=0;y<this.labels.length;y++)this.opts.state["e_"+y]&&!isNaN(this.opts.data.ys[y].y[u])&&f.push({ind:y,val:this.opts.data.ys[y].y[u]||0});var M=this.tooltipSortOrder;f.sort(function(t,i){return t.val===i.val?t.ind-i.ind:"desc"===M?i.val-t.val:t.val-i.val});for(var _=0;_<f.length;_++)this.$tipScroller.appendChild(this.labels[f[_].ind].$row);for(var T=0;T<this.labels.length;T++)this.opts.state["e_"+T]&&!isNaN(this.opts.data.ys[T].y[u])||this.$tipScroller.appendChild(this.labels[T].$row)}t.isMove||(this.maxLabelWidth=0,this.maxValueWidth=0,this.maxPercentageWidth=0,this.maxDateWidth=0,g=window.getComputedStyle(this.$tip),this.rowPaddings=parseInt(g.getPropertyValue("padding-left"),10)+parseInt(g.getPropertyValue("padding-right"),10)),"area"==h.graphStyle&&this.fillPercentages(u,v),this.labels.forEach(function(t,i){h.state["e_"+i]&&!isNaN(h.data.ys[i].y[u])&&((i=t.$label.offsetWidth)>this.maxLabelWidth&&(this.maxLabelWidth=i),(i=t.$value.offsetWidth)>this.maxValueWidth)&&(this.maxValueWidth=i)}.bind(this));m=this.rowPaddings+this.maxLabelWidth+20+this.maxValueWidth,x=(m+="area"==h.graphStyle?this.maxPercentageWidth:0,this.rowPaddings+this.$tipDt.offsetWidth+20);x>this.maxDateWidth&&(this.maxDateWidth=x),m=Math.max(m,this.maxDateWidth),this.$tip.style.width=m+"px",this.tipH=this.$tip.offsetHeight,this.tipW=this.$tip.offsetWidth}var b,w,t=this.itemsVisible<=2?"center":"side";"side"==(t="center"==t&&(b=this.dx-this.tipW/2,(w=Math.min(this.dy-20-this.tipH,p.t+p.h-this.tipH-d))<p.t+r)?"side":t)&&(b=this.dx>p.w/2?this.dx-this.tipW-20:this.dx+20,w=Math.min(Math.max(this.dy-this.tipH/2,p.t+r),p.t+p.h-this.tipH-d)),b=Math.min(Math.max(b,i/2),p.w-this.tipW-n/2),this.$tip.style.transform="translate("+(b<<0)+"px,"+(w<<0)+"px)",this.$tip.style.webkitTransform="translate("+(b<<0)+"px,"+(w<<0)+"px)",this.lastTipLeft=b<<0,this.lastTipTop=w<<0,this.prevXInd=u,this.updateTipScrollClasses()}}},renderScatterTooltip:function(t){var i=this.opts,s=this.opts.settings,e=i.state.dims.tip,a=s.PADD[0],h=s.PADD[2],o=s.PADD[3],s=s.PADD[1],r=i.state.dims.graph,r=this.dx-r.l,n=this.dy-e.t,r=i.chart.graph.pickPoint(r,n);if(r){i.chart.graph&&i.chart.graph.setHover&&i.chart.graph.setHover(r);var d=r.point,n=i.data.yIds[r.seriesId],r=i.data.ys[n],l=d.color||(this.isDarkMode?r.colors_n:r.colors_d)[2],n=(this.labels.forEach(function(t){t.$row.style.display="none"}),this.allLabel&&(this.allLabel.$row.style.display="none"),this.pieLabel&&(this.pieLabel.$row.style.display="none"),this.labels[n]),r=(n.$row.style.display="",n.$labelText.nodeValue=d.label||r.label,S.TUtils.getFormatter("yTooltipFormatter",i.data,0)),p=d.y,r=r(p="number"==typeof p&&isFinite(p)?Math.round(p):p),c=("time"===(i.data.scatter&&i.data.scatter.xType?i.data.scatter.xType:"time")?n.$valueText.nodeValue="(Y: "+r+")":(_=S.TUtils.getFormatter("xTooltipFormatter",i.data,0),"number"==typeof(p=d.x)&&isFinite(p)&&(p=Math.round(p)),p=(_||String)(p),n.$valueText.nodeValue="(X: "+p+", Y: "+r+")"),n.$value.style.color=l,this._scatterExtraRows=this._scatterExtraRows||[],function(t){var i,s,e=this._scatterExtraRows[t];return e||((e=document.createElement("div")).className="tchart--tip-row",i=document.createElement("span"),s=document.createElement("div"),e._k=i,(e._v=s).style.fontWeight="normal",e.appendChild(i),e.appendChild(s),this.$tipScroller.appendChild(e),this._scatterExtraRows[t]=e),e}.bind(this)),m=function(t,i,s){t=c(t);t.style.display="",t._k.textContent=i,t._k.style.color=this.isDarkMode?"#aaa":"#555",t._v.textContent=s,t._v.style.color=this.isDarkMode?"#fff":"#000"}.bind(this),p=i.data.scatter&&i.data.scatter.hover?i.data.scatter.hover:{},g=null!=p.maxMetaKeys?p.maxMetaKeys:12,u=null!=p.maxMetaValueLen?p.maxMetaValueLen:120,x=0;if(null!=d.sizePx&&m(x++,"Size:",String(d.sizePx)),d.meta){var v,f=0;for(v in d.meta){if(f++>=g)break;var y=d.meta[v];"object"==typeof y&&(y=JSON.stringify(y)),m(x++,v+":",y=(y=String(y)).length>u?y.substr(0,u)+"...":y)}}for(var M=x;M<this._scatterExtraRows.length;M++)this._scatterExtraRows[M].style.display="none";var _=S.TUtils.getFormatter("xTooltipFormatter",i.data,0),r=i.data.scatter&&i.data.scatter.xType?i.data.scatter.xType:"time",n=d.x,T=("time"!==r&&"number"==typeof n&&isFinite(n)&&(n=Math.round(n)),this.$tipDtText.nodeValue=_(n),this.$line&&(this.$line.style.display="none"),this.$tip.classList.add("tchart--tip__scatter"),this.$tip.style.width="auto",this.tipH=this.$tip.offsetHeight,this.tipW=this.$tip.offsetWidth,0);T=Math.max(T,this.$tipDt.scrollWidth+24);for(var b=0;b<this.$tipScroller.children.length;b++)var w=this.$tipScroller.children[b],T=Math.max(T,w.scrollWidth+24);l=Math.min(520,e.w-o-s),p=(T=Math.max(220,Math.min(T,l)),this.$tip.style.width=T+"px",this.tipH=this.$tip.offsetHeight,this.tipW=this.$tip.offsetWidth,this.dx+20),r=(this.dx>e.w/2&&(p=this.dx-this.tipW-20),this.dy-this.tipH/2-e.t),r=Math.min(Math.max(r,a),e.h-this.tipH-h),p=Math.min(Math.max(p,o/2),e.w-this.tipW-s/2);this.$tip.style.transform="translate("+(p<<0)+"px,"+(r+e.t<<0)+"px)",this.$tip.style.webkitTransform="translate("+(p<<0)+"px,"+(r+e.t<<0)+"px)",this.updateTipScrollClasses(),this.prevXInd=-999,this.lastScatterPoint=d}else i.chart.graph&&i.chart.graph.clearHover&&i.chart.graph.clearHover()},updateTipScrollClasses:function(){this.$tipScroller.scrollHeight>this.$tipScroller.offsetHeight?this.$tip.classList.add("tchart--tip__scroll"):this.$tip.classList.remove("tchart--tip__scroll"),this.$tipScroller.scrollTop<=0?this.$tip.classList.remove("tchart--tip__has_less"):this.$tip.classList.add("tchart--tip__has_less"),this.$tipScroller.scrollTop>=this.$tipScroller.scrollHeight-this.$tipScroller.offsetHeight?this.$tip.classList.remove("tchart--tip__has_more"):this.$tip.classList.add("tchart--tip__has_more")},fillPercentages:function(s,e){var a=this.opts,h=[],o=2;a.data.ys.forEach(function(t,i){a.state["e_"+i]&&(h[i]=Math.max(Math.round(100*t.y[s]/e),0),!isNaN(t.y[s])&&0!=e||(h[i]=0),100==h[i])&&(o=3)}.bind(this)),a.data.ys.forEach(function(t,i){var s;a.state["e_"+i]&&(s=8*o+17,this.labels[i].$label.style.transform="translateX("+s+"px)",this.labels[i].$label.style.webkitTransform="translateX("+s+"px)",this.labels[i].$perText.nodeValue=h[i]+"%",this.labels[i].$per.style.width=s-7+"px",s>this.maxPercentageWidth)&&(this.maxPercentageWidth=s)}.bind(this))}},S.TTip=t})(),(()=>{Math.log2=Math.log2||function(t){return Math.log(t)*Math.LOG2E},Math.log10=Math.log10||function(t){return Math.log(t)*Math.LOG10E};var s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a=["January","February","March","April","May","June","July","August","September","October","November","December"],h={simplifyData:function(t,i,s,e,a,h,o,r,n){var n=(r-o)/n,d=[],l=[];if(n<=1)return{xInd1:o,xInd2:r,x:i,ys:s};for(var p,c=0,m=-999999999,g=h.length,u=o;u<=r;u++){var x=i[u]*e+a<<0,v=m<x;for(v?(d[c]=i[u],c++):p++,j=0;j<g;j++){var f=h[j],y=(l[f]=l[f]||{y:[]},l[f].y[c-1]),M=s[f].y[u];null==y?l[f].y[c-1]=M:l[f].y[c-1]+=M,1<c&&(v&&(l[f].y[c-2]/=p),u==r)&&(l[f].y[c-1]/=p)}v&&(p=1),m=x}return{isOptimized:1<n,xInd1:o=0,xInd2:r=c-1,x:d,ys:l}},getElemPagePos:function(t){t=t.getBoundingClientRect();return{x:t.left+(window.pageXOffset||document.documentElement.scrollLeft),y:t.top+(window.pageYOffset||document.documentElement.scrollTop)}},getXIndex:function(t,i,s){var e=0,a=t.length-1;for(s||(i<t[e]?i=t[e]:i>t[a]&&(i=t[a]));1<Math.abs(e-a);){var h=Math.round((e+a)/2);i>=t[e]&&i<=t[h]?a=h:e=h}return e+(i-t[e])/(t[a]-t[e])},triggerEvent:function(t,i){"function"==typeof window.CustomEvent&&document.dispatchEvent(new CustomEvent(t,{detail:i||null}))},isTouchDevice:function(){var t=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||(t=["(",t.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(t).matches)},drawRoundedRect:function(t,i,s,e,a,h,o){s*=i,e*=i,a*=i,h*=i,(o="number"==typeof o?[o,o,o,o]:o)[0]*=i,o[1]*=i,o[2]*=i,o[3]*=i,t.beginPath(),t.moveTo(a+o[0],h),t.lineTo(a+s-o[1],h),t.quadraticCurveTo(a+s,h,a+s,h+o[1]),t.lineTo(a+s,h+e-o[2]),t.quadraticCurveTo(a+s,h+e,a+s-o[2],h+e),t.lineTo(a+o[3],h+e),t.quadraticCurveTo(a,h+e,a,h+e-o[3]),t.lineTo(a,h+o[0]),t.quadraticCurveTo(a,h,a+o[0],h),t.closePath()},drawRoundedRect2:function(t,i,s,e,a,h,o){a*=i,h*=i,(e*=i)<2*(o=(s*=i)<2*(o*=i)?s/2:o)&&(o=e/2),t.beginPath(),t.moveTo(a+o,h),t.arcTo(a+s,h,a+s,h+e,o),t.arcTo(a+s,h+e,a,h+e,o),t.arcTo(a,h+e,a,h,o),t.arcTo(a,h,a+s,h,o),t.closePath()},getFormatter:function(t,i,s){var e;return(e=.5<s&&i.details?i.details[t]:e)||i[t]||h[t]},xTooltipFormatter:function(t,i){t=new Date(t),t=[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCDay(),t.getUTCHours(),t.getUTCMinutes()];return i?(t[4]<10?"0":"")+t[4]+":"+(t[5]<10?"0":"")+t[5]:e[t[3]]+", "+t[2]+" "+s[t[1]]+" "+t[0]},xTickFormatter:function(t,i){t=new Date(t),t=[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCDay(),t.getUTCHours(),t.getUTCMinutes()];return i?(t[4]<10?"0":"")+t[4]+":"+(t[5]<10?"0":"")+t[5]:t[2]+" "+s[t[1]]},xRangeFormatter:function(t,i){t=new Date(t),t=[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()];return t[2]+" "+a[t[1]]+" "+t[0]},niceNum:function(t,i){var s;return 0!==t&&isFinite(t)?(s=Math.floor(Math.log10(t)),t=t/Math.pow(10,s),(i?t<1.5?1:t<2.25?2:t<4.5?4:t<7.5?5:10:t<=1?1:t<=2?2:t<=4?4:t<=5?5:10)*Math.pow(10,s)):1},niceScale:function(t,i,s){s=s||5,isFinite(t)||(t=0),(i=isFinite(i)?i:1)-t<1e-10&&(0===t?i=1:(t-=e=.1*Math.abs(t)||.1,i+=e));var e=i-t,e=this.niceNum(e/(s-1),!0),s=Math.floor(t/e)*e,t=Math.ceil(i/e)*e,i=(t<i&&(t+=e),1e12);return{min:Math.round(s*i)/i,max:t=Math.round(t*i)/i,step:Math.round(e*i)/i}},yTickFormatter:function(t,i,s){var e,a;return 0===t?"0":(a=Math.abs(t),(e=0)<i&&i<1&&(e=Math.ceil(1e-4-Math.log10(i)),e=Math.max(0,Math.min(6,e))),1e6<=a?((i=t/1e6)%1==0?i:Math.round(10*i)/10)+"M":1e3<=a?((i=t/1e3)%1==0?i:Math.round(10*i)/10)+"K":0<e?(a=Math.pow(10,e),(Math.round(t*a)/a).toFixed(e)):Math.round(t).toString())},yTooltipFormatter:function(t){return"number"!=typeof t?"string"==typeof t?t:"?":h.statsFormatKMBT(t)},statsFormatKMBT:function(t,i,s){if(0==t)return"0";null==i&&(i=h.statsChooseNumKMBT(t));t=h.statsFormatFixedKMBT(t,i);return null==s&&(s=h.statsChoosePrecision(t)),t.toFixed(s)+i},statsFormatFixedKMBT:function(t,i){switch(i){case"K":return t/1e3;case"M":return t/1e6;case"B":return t/1e9;case"T":return t/1e12}return t},statsChoosePrecision:function(t){t=Math.abs(t);return 10<t?0:1<=t?Math.abs(t-Math.floor(t))<.001?0:1:2},statsChooseNumKMBT:function(t){t=Math.abs(t);return 1e12<=t?"T":1e9<=t?"B":1e6<=t?"M":2e3<=t?"K":""},roundRange:function(t,i,s,e){return e?{yMin:t-(i-t)*((e.yMinOrig-e.yMin)/(e.yMaxOrig-e.yMinOrig)),yMax:i+(i-t)*((e.yMax-e.yMaxOrig)/(e.yMaxOrig-e.yMinOrig)),yMinOrig:t,yMaxOrig:i}:{yMin:(e=this.niceScale(t,i,Math.floor(s)+1)).min,yMax:e.max,step:e.step,yMinOrig:t,yMaxOrig:i}}};window.Graph.units.TUtils=h})(),(()=>{var t=window.Graph.units;function i(t){this.opts=t,this.ctx=t.ctx,!t.additional.mini&&t.$parent&&(this.$hoverPoint=document.createElement("div"),this.$hoverPoint.style.cssText="position:absolute;top:0;left:0;margin:0;pointer-events:none;z-index:10;border-radius:50%;display:none;will-change:transform;box-sizing:border-box;",t.$parent.appendChild(this.$hoverPoint)),this.init()}i.prototype={_getZMode:function(){var t=this.opts.data.scatter;return!t||"manual"!==t.z_mode&&"auto"!==t.z_mode?"auto":t.z_mode},_getPointZManual:function(t,i){return i&&null!=i.z&&!isNaN(i.z)?+i.z:t&&null!=t.z&&!isNaN(t.z)?+t.z:0},_getPointSizePx:function(t,i,s){s=s.size&&s.size.defaultPx?s.size.defaultPx:3,i=+(i=i&&null!=i.sizePx?i.sizePx:s);return i=!isFinite(i)||i<=0?s:i},_getPointZKey:function(t,i,s){var e=this._getZMode(),s=this._getPointSizePx(t,i,s);return{zMode:e,z:this._getPointZManual(t,i),sizePx:s}},_cmpOnTop:function(t,i){return t?i?"manual"===t.zMode?t.z!==i.z?t.z>i.z?1:-1:t.sizePx!==i.sizePx?t.sizePx<i.sizePx?1:-1:0:t.sizePx!==i.sizePx?t.sizePx<i.sizePx?1:-1:t.z!==i.z?t.z>i.z?1:-1:0:1:-1},_cmpDrawOrder:function(t,i){return"manual"===t.zMode?t.z!==i.z?t.z-i.z:t.sizePx!==i.sizePx?i.sizePx-t.sizePx:t._seq-i._seq:t.sizePx!==i.sizePx?i.sizePx-t.sizePx:t.z!==i.z?t.z-i.z:t._seq-i._seq},_resolveHoverColor:function(t,i){return i&&i.hover_color||t&&t.hover_color||"#ffd400"},_resolveBorderColor:function(t,i){var s=this.opts.data.scatter,i=i&&"border_color"in i?i.border_color:t&&"border_color"in t?t.border_color:s&&"border_color"in s?s.border_color:void 0;return null!=i&&(i=String(i))&&"none"!==i.toLowerCase()?i:null},clearHover:function(){this.$hoverPoint&&(this.$hoverPoint.style.display="none"),this._hovered=null},setHover:function(t){var i,s,e,a,h,o,r;this.$hoverPoint&&(t&&t._rendered?this._hovered!==t._rendered&&(this._hovered=t._rendered,e=t._rendered.rDev,i=(h=this.opts).settings.dpi,s=h.state.dims.graph,a=2*(e=e/i),o=h.state.dims.composer,r=(h=h.$parent.getBoundingClientRect()).width/o.w,h=h.height/o.h,o=((s.l*i|0)+t._rendered.cxDev)/i*r-e,r=((s.t*i|0)+t._rendered.cyDev)/i*h-e,this.$hoverPoint.style.width=a+"px",this.$hoverPoint.style.height=a+"px",this.$hoverPoint.style.transform="translate("+o+"px,"+r+"px)",this.$hoverPoint.style.backgroundColor=t._rendered.hoverColor||"#ffd400",this.$hoverPoint.style.display="block"):this.clearHover())},init:function(){var t=this.opts.data.scatter;if(t){for(n in t.series)if((d=t.series[n]).points&&d.points.length){d.blocks=[];for(var i=0;i<d.points.length;i+=1e3){for(var s=d.points.slice(i,i+1e3),e=Number.MAX_VALUE,a=-Number.MAX_VALUE,h=0;h<s.length;h++)s[h].y<e&&(e=s[h].y),s[h].y>a&&(a=s[h].y);d.blocks.push({xMin:s[0].x,xMax:s[s.length-1].x,yMin:e,yMax:a,points:s})}}this.miniBins={};var o=this.opts.state.xgMin,r=this.opts.state.xgMax-o;if(0<r)for(var n in t.series)for(var d=t.series[n],l=(this.miniBins[n]=new Uint16Array(300),d.points),i=0;i<l.length;i++){var p=Math.floor((l[i].x-o)/r*299);0<=p&&p<300&&this.miniBins[n][p]<65535&&this.miniBins[n][p]++}}},onResize:function(){this.lastGrid=null,this.lastGridMeta=null,this.clearHover()},setDarkMode:function(t){this.isDarkMode=t},render:function(){var t=this.opts,i=t.additional.mini,t=(i?this:t).ctx;i?this.renderMini(t):this.renderMain(t)},renderMini:function(t){var i,s=this.opts.state,e=s.dims.mini,a=this.opts.settings.dpi,h=new Float32Array(300),o=0;for(i in this.miniBins){var r=this.opts.data.yIds[i];if(null!=r){var n=s["om_"+r];if(0<n)for(var d=this.miniBins[i],l=0;l<300;l++){var p=d[l]*n;h[l]+=p,h[l]>o&&(o=h[l])}}}if(!(o<=0)){t.fillStyle=this.isDarkMode?"rgba(255, 255, 255, 0.4)":"rgba(0, 0, 0, 0.3)";for(var c=e.w*a/300,m=e.h*a,g=e.l*a,u=e.t*a,l=0;l<300;l++){var x=h[l];0<x&&t.fillRect(g+l*c,u+m-(x=x/o*m),Math.max(c,1),x)}}},renderMain:function(t){var i=this.opts,s=i.state,e=s.dims.graph,a=i.settings.dpi,h=i.data.scatter;if(h&&h.series){var o=i.settings.PADD,C=o[0],F=o[1],H=o[2],o=o[3],r=s.x1,n=s.x2,d=s.y1,l=s.y2;if(r<n&&d<l){var p,N=Math.max(e.w-o-F,1)*a/(n-r),X=Math.max(e.h-C-H,1)*a/(l-d),c=h.hover&&h.hover.gridCellPx||3,m=Math.max(1,c*a|0),c=e.w*a|0,U=e.h*a|0,Y=Math.max(1,c/m|0),B=o*a|0,G=(e.w-F)*a|0,O=C*a|0,W=(e.h-H)*a|0,V=h.hover&&h.hover.maxRenderPoints||6e4,g=Object.create(null),u=[],j=0,Z=!1;for(p in h.series){var x=i.data.yIds[p];if(null!=x){var v=s["o_"+x];if(0<v){var f=s["f_"+x];if(null==f&&(f=1),s["e_"+x]||0!==v){var y=h.series[p];if(y&&y.points&&y.points.length)for(var q=y.blocks||[{points:y.points,xMin:y.xMin,xMax:y.xMax}],J=i.data.ys[x],K=(this.isDarkMode?J.colors_n:J.colors_d)[0],M=0;M<q.length;M++){var _=q[M];if(_&&!(_.xMax<r)){if(n<_.xMin)break;for(var T=_.points,Q=((t,i)=>{for(var s=0,e=t.length;s<e;){var a=s+e>>1;t[a].x<i?s=1+a:e=a}return s})(T,r);Q<T.length;Q++){var b,w,S,tt,D,it,$,st,P,I,L=T[Q];if(L.x>n)break;L.y<d||L.y>l||(w=W-(L.y-d)*X|0,(b=B+(L.x-r)*N|0)<B)||G<b||w<O||W<w||(S=(w/m|0)*Y+(b/m|0),tt=j++,it=(D=this._getPointSizePx(y,L,h))*a/2,$=this._getPointZManual(y,L),st=this._getZMode(),I=!1,(P=g[S])?"manual"===st?$!==P.z?I=$>P.z:D!==P.sizePx&&(I=D<P.sizePx):D!==P.sizePx?I=D<P.sizePx:$!==P.z&&(I=$>P.z):I=!Z,I&&(I={_seq:tt,p:L,sid:p,seriesIndex:x,alpha:v*(.9*f+.1),fill:L.color||K,hoverColor:this._resolveHoverColor(y,L),borderColor:this._resolveBorderColor(y,L),zMode:st,z:$,sizePx:D,cxDev:b,cyDev:w,rDev:it},P?g[S]=I:(g[S]=I,u.push(S),V<=u.length&&(Z=!0))))}}}}}}}for(var A=new Array(u.length),et=0,E=0;E<u.length;E++){var at=g[u[E]];(A[E]=at)&&at.rDev>et&&(et=at.rDev)}A.sort(this._cmpDrawOrder.bind(this));for(var o=h.hover&&h.hover.pickCellPx||10,k=Math.max(1,o*a|0),ht=Math.max(1,c/k|0),ot=Object.create(null),rt=e.l*a|0,nt=e.t*a|0,dt=Math.max(1,a),lt=0;lt<A.length;lt++){var z,pt,R=A[lt];R&&(z=R.cxDev/k|0,(pt=ot[z=(R.cyDev/k|0)*ht+z])||(ot[z]=pt=[]),pt.push(R),0<R.alpha)&&(t.globalAlpha=R.alpha,t.beginPath(),t.arc(rt+R.cxDev,nt+R.cyDev,R.rDev,0,2*Math.PI),t.fillStyle=R.fill,t.fill(),R.borderColor)&&(t.lineWidth=dt,t.strokeStyle=R.borderColor,t.stroke())}t.globalAlpha=1,this.lastGrid=ot,this.lastGridMeta={cell:k,wDev:c,hDev:U,gridW:ht,maxRDev:et,hitPadDev:(h.hover&&h.hover.hitPaddingPx||3)*a}}}},pickPoint:function(t,i){if(!this.lastGrid||!this.lastGridMeta)return null;for(var s=this.opts.settings.dpi,e=this.lastGridMeta,a=t*s|0,h=i*s|0,t=e.cell,o=e.gridW||e.wDev/t|0,r=a/t|0,n=h/t|0,d=Math.max(2,Math.ceil((e.maxRDev+e.hitPadDev)/t)+1),l=null,p=1/0,c=-d;c<=d;c++){var m=n+c;if(!(m<0))for(var g=-d;g<=d;g++){var u=r+g;if(!(u<0)){var x=this.lastGrid[m*o+u];if(x)for(var v=0;v<x.length;v++){var f=x[v],y=f.cxDev-a,M=f.cyDev-h,y=y*y+M*M,M=f.rDev+e.hitPadDev;M*M<y||(!l||0<(M=this._cmpOnTop(f,l))||0===M&&y<p)&&(l=f,p=y)}}}}return l?{point:l.p,seriesId:l.sid,cx:l.cxDev/s,cy:l.cyDev/s,_rendered:l}:null}},t.TScatter=i})();