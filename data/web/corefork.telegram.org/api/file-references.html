<!DOCTYPE html>
<html class="">
  <head>
    <meta charset="utf-8">
    <title>File references</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="description" content="How to handle file references.">
    <meta property="og:title" content="File references">
    <meta property="og:image" content="">
    <meta property="og:description" content="How to handle file references.">
    <link rel="icon" type="image/svg+xml" href="/img/website_icon.svg?4">
<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
<link rel="alternate icon" href="/img/favicon.ico" type="image/x-icon" />
    <link href="/css/bootstrap.min.css?3" rel="stylesheet">
    
    <link href="/css/telegram.css?248" rel="stylesheet" media="screen">
    <style>
    </style>
  </head>
  <body class="preload">
    <div class="dev_page_wrap">
      <div class="dev_page_head navbar navbar-static-top navbar-tg">
        <div class="navbar-inner">
          <div class="container clearfix">
            <ul class="nav navbar-nav navbar-right hidden-xs"><li class="navbar-twitter"><a href="https://twitter.com/telegram" target="_blank" data-track="Follow/Twitter" onclick="trackDlClick(this, event)"><i class="icon icon-twitter"></i><span> Twitter</span></a></li></ul>
            <ul class="nav navbar-nav">
              <li><a href="//telegram.org/">Home</a></li>
<li class="hidden-xs"><a href="//telegram.org/faq">FAQ</a></li>
<li class="hidden-xs"><a href="//telegram.org/apps">Apps</a></li>
<li class="active"><a href="/api">API</a></li>
<li class=""><a href="/mtproto">Protocol</a></li>
<li class=""><a href="/schema">Schema</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="container clearfix">
        <div class="dev_page">
          <div id="dev_page_content_wrap" class=" ">
  <div class="dev_page_bread_crumbs"><ul class="breadcrumb clearfix"><li><a  href="/api" >API</a></li><i class="icon icon-breadcrumb-divider"></i><li><a  href="/api/file-references" >File references</a></li></ul></div>
  <h1 id="dev_page_title">File references</h1>
  
  <div id="dev_page_content"><!-- scroll_nav -->

<p>File references are strings of bytes, that can be encountered in the <code>file_reference</code> fields of <a href="/constructor/document">document</a> and <a href="/constructor/photo">photo</a> objects.</p>
<p>They must be cached by the client, along with the <strong>origin</strong> where the document/photo object was found, in order to be refetched when the file reference expires.</p>
<p>Example implementation of a reference database: <a href="https://github.com/danog/MadelineProto/blob/v8/src/MTProtoTools/ReferenceDatabase.php">MadelineProto</a>, <a href="https://github.com/DrKLO/Telegram/blob/master/TMessagesProj/src/main/java/org/telegram/messenger/FileRefController.java">android</a>, <a href="https://github.com/telegramdesktop/tdesktop/blob/bec39d89e19670eb436dc794a8f20b657cb87c71/Telegram/SourceFiles/data/data_file_origin.cpp">telegram desktop</a>, <a href="https://github.com/tdlib/td/blob/56163c2460a65afc4db2c57ece576b8c38ea194b/td/telegram/FileReferenceManager.cpp">tdlib</a>.</p>
<h2><a class="anchor" href="#automatic-generation" id="automatic-generation" name="automatic-generation"><i class="anchor-icon"></i></a>Automatic generation</h2>
<p>Implementation and maintenance of the file reference database may be fully automated by using the <a href="/api/file-reference-generator">file reference database schema generator tool »</a>, and the <strong>file reference database map file</strong> it generates.  </p>
<p><a href="/file/400780400144/2/mlv9mRNls2U.48241.json/691277fc060cec57d1">Latest file reference database map file for the current layer »</a></p>
<p>Dictionary:</p>
<ul>
<li>A <strong>file reference path</strong> is a deserialization path where a <code>file_reference</code> field may appear, for example <code>updateNewMessage.message -&gt; message.media -&gt; messageMediaDocument.document -&gt; document.file_reference</code>.  </li>
<li>A <strong>file reference origin</strong> (or <code>FileSource</code>) contains information that the client may use to re-fetch the document (and the new file reference), for example for the above path it's <code>getMessage{peer: updateNewMessage.message.peer, id: updateNewMessage.message.id}</code>, which can be used to refetch the document using either <a href="/method/messages.getMessages">messages.getMessages</a> or <a href="/method/channels.getMessages">channels.getMessages</a> depending on the type of the <a href="/type/Peer">Peer</a>.  </li>
</ul>
<p>The database map file contains <strong>all possible origins</strong>, for <strong>all possible file reference paths</strong>.  </p>
<p>It is automatically generated and validated by the <a href="/api/file-reference-generator">file reference database schema generator tool »</a>; this tool can be manually run on newer or experimental layers, to generate the <strong>file reference database map file</strong> for a given API schema: see <a href="/api/file-reference-generator">here »</a> for more info.  </p>
<h3><a class="anchor" href="#implementation" id="implementation" name="implementation"><i class="anchor-icon"></i></a>Implementation</h3>
<p>Here's how to use file reference database <strong>map file</strong> to generate all the logic needed for a file reference database within an MTProto client.</p>
<p>The file reference database can be represented by the following type:</p>
<pre><code>HashMap&lt;FileId, Vector&lt;FileSource&gt;&gt;</code></pre>
<p>It maps a <code>FileId</code> to one or more objects of type <code>FileSource</code>: the exact structure and possible types of <code>FileId</code> and <code>FileSource</code> are specified within the <strong>map file</strong>.  </p>
<p>New entries are added when deserializing objects of a specific type received from the API, mapping a received file ID to one or more <code>FileSource</code>s; the exact procedure and affected objects are fully specified within the <strong>map file</strong>.  </p>
<p>Later, when a file is used (for example when sending or downloading a media file), and a <code>FILE_REFERENCE_EXPIRED</code> RPC error is received for a specific <code>FileId</code>, the client must fetch the <code>List&lt;FileSource&gt;</code> associated to the used <code>FileId</code>, and execute a specific method call for each <code>FileSource</code>, until a new <code>file_reference</code> is fetched for the <code>FileId</code>.  </p>
<p>Note that the database doesn't have to store the actual <code>file_reference</code>, only the file id =&gt; file source mapping: the file reference itself can be stored for example in the message DB, or the document DB, or in any other way that can be associated to a <code>FileId</code> upon extraction or storage as specified in the <strong>map file</strong>.  </p>
<p>The map file itself follows a custom TL schema, and is available in JSON or serialized TL format.  </p>
<p><a href="https://raw.githubusercontent.com/danog/MadelineProto/refs/heads/v8/src/file_ref_map.json">Serialized TL version of map file »</a></p>
<p><a href="https://raw.githubusercontent.com/danog/MadelineProto/refs/heads/v8/src/file_ref_map.json">JSON map file »</a> - The constructor predicate is serialized under the <code>_</code> key, <code>bytes</code> fields are serialized as <code>{"_": "bytes", "bytes": "&lt;base64 encoded value&gt;"}</code></p>
<p><a href="https://raw.githubusercontent.com/danog/MadelineProto/refs/heads/v8/src/TL_file_ref_map_schema.tl">TL schema of map file »</a></p>
<p><a href="https://raw.githubusercontent.com/danog/MadelineProto/refs/heads/v8/src/TL_file_ref_map_schema.json">JSON version of TL schema of map file »</a></p>
<p>This is the TL schema of the map file:</p>
<!-- start schema -->
<pre><code><a href='/constructor/boolFalse'>boolFalse</a>#bc799737 = <a href='/type/Bool'>Bool</a>;
<a href='/constructor/boolTrue'>boolTrue</a>#997275b5 = <a href='/type/Bool'>Bool</a>;
<a href='/constructor/true'>true</a>#3fedd339 = <a href='/type/True'>True</a>;

vector#1cb5c415 {t:Type} # [ t ] = Vector t;

// Root
fileReferenceOrigins#ed01a4f1 db_schema:string db_schema_json:string locations:Vector&lt;Location&gt; origins:Vector&lt;Origin&gt; skipped:Vector&lt;SkippedOrigin&gt; actions:Vector&lt;Action&gt; = FileReferenceOrigins;

locationIncoming#e18770f4 predicate:string stored_constructor:string = Location;
locationOutgoing#e7740ae0 predicate:string stored_constructor:string = Location;

origin#b62177bf flags:# predicate:string is_constructor:flags.0?true stored_constructor:string stored_params:Vector&lt;FieldExtractor&gt; skipped_flags:Vector&lt;string&gt; needs_parent:flags.3?string parent_is_constructor:flags.4?true = origin;

skippedOrigin#7c62809e flags:# predicate:string is_constructor:flags.0?true why:string = SkippedOrigin;

action#9539f410 stored_constructor:string action:ActionOp = Action;

// Field extraction path
paramNotFlag#acd9d5cf = ParamFlag;
paramIsFlagAbortIfEmpty#f8fe9fee = ParamFlag;
paramIsFlagFallback#202b77a1 fallback:TypedOp = ParamFlag;
paramIsFlagPassthrough#1dc6e17d = ParamFlag;

pathPart#8dc6ff46 constructor:string param:string flag:ParamFlag = PathPart;

path#0c3586a2 parts:Vector&lt;PathPart&gt; = Path;
pathParent#58f13684 parts:Vector&lt;PathPart&gt; = Path;

// Extractor
extractAndStore#72069549 from:Path to:string = FieldExtractor;

extractInputStickerSetFromDocumentAttributesAndStore#369d8d14 from:Path to:string = FieldExtractor;
extractInputStickerSetFromStickerSetAndStore#c167d470 from:Path to:string = FieldExtractor;

extractPeerIdFromPeerAndStore#7d33019c from:Path to:string = FieldExtractor;
extractPeerIdFromInputPeerAndStore#a51acfb4 from:Path to:string = FieldExtractor;

extractChannelIdFromChannelAndStore#5675bc97 from:Path to:string = FieldExtractor;
extractChannelIdFromInputChannelAndStore#b662660e from:Path to:string = FieldExtractor;

extractUserIdFromUserAndStore#4778ec63 from:Path to:string = FieldExtractor;
extractUserIdFromInputUserAndStore#7720aa2e from:Path to:string = FieldExtractor;

// Actions
callOp#c2ff3383 method:string args:Vector&lt;TypedOpArg&gt; = ActionOp;
getMessageOp#237849e8 peer:TypedOp id:TypedOp from_scheduled:TypedOp quick_reply_shortcut_id:TypedOp = ActionOp;

// For string =&gt; TypedOp dictionaries
typedOpArg#3a2930c2 key:string value:TypedOp = TypedOpArg;

// Typed constructors, the type is specified to simplify codegen,
// but isn't strictly necessary as it can be inferred from the TypedOpOp.
// It is fully pre-validated during the generation of the definition file.
typedOp#705b10ec type:string op:TypedOpOp = TypedOp;

// The actual ops
copyOp#f48f418f from:string = TypedOpOp;

getInputChannelByIdOp#3cb47531 from:string = TypedOpOp;
getInputUserByIdOp#c0ee4326 from:string = TypedOpOp;
getInputPeerByIdOp#19813750 from:string = TypedOpOp;

// Literals &amp; constructors (methods not allowed or needed here)
constructorOp#107f8d8a constructor:string args:Vector&lt;TypedOpArg&gt; = TypedOpOp;

vectorOp#f8fb8f72 values:Vector&lt;TypedOp&gt; = TypedOpOp;

intLiteralOp#cbfabe7c value:int = TypedOpOp;
longLiteralOp#d08b8d3a value:long = TypedOpOp;
stringLiteralOp#2b56ea8e value:string = TypedOpOp;
bytesLiteralOp#fdb395a4 value:bytes = TypedOpOp;
boolLiteralOp#37e07911 value:Bool = TypedOpOp;
doubleLiteralOp#3651e3bf value:double = TypedOpOp;
themeFormatLiteralOp#8e4f9208 = TypedOpOp;
</code></pre>
<!-- end schema -->
<p>Current values for the current layer:</p>
<p>DB schema:</p>
<!-- start db schema -->
<pre><code><a href='/constructor/boolFalse'>boolFalse</a>#bc799737 = <a href='/type/Bool'>Bool</a>;
<a href='/constructor/boolTrue'>boolTrue</a>#997275b5 = <a href='/type/Bool'>Bool</a>;
<a href='/constructor/true'>true</a>#3fedd339 = <a href='/type/True'>True</a>;
vector#1cb5c415 {t:Type} # [ t ] = Vector t;

fileIdPhoto#47a0bd49 id:long = FileId;
fileIdDocument#461b1d89 id:long = FileId;

fileSourceMessage#7e015bb0 flags:# from_scheduled:flags.0?true quick_reply_shortcut_id:flags.1?int peer:long id:int = FileSource;
fileSourceStarsTransaction#c1bac8c7 flags:# peer:long id:string refund:flags.0?true ton:flags.1?true = FileSource;
fileSourceStory#c820e3eb id:int peer:long = FileSource;
fileSourceWebPage#9e5b749c url:string = FileSource;
fileSourceBotApp#01cf8b7a id:long access_hash:long = FileSource;
fileSourceUserFull#70fdb7b0 id:long = FileSource;
fileSourceAdminLog#4797f959 channel:long max_id:long = FileSource;
fileSourceStoryAlbum#5e01f223 peer:long = FileSource;
fileSourceBotPreviewMedia#0aa91441 bot:long = FileSource;
fileSourceBotPreviewInfo#f9d2d6fc bot:long lang_code:string = FileSource;
fileSourcePaidMedia#b18d9042 id:int peer:long = FileSource;
fileSourceSavedMusic#dd1a7664 user_id:long id:long access_hash:long = FileSource;
fileSourceChatFull#9de75fde chat_id:long = FileSource;
fileSourceChannelFull#6fe19339 channel:long = FileSource;
fileSourcePremiumPromo#c907a44f = FileSource;
fileSourceAttachMenuBot#c3002694 bot:long = FileSource;
fileSourceTheme#92d05e0c id:long access_hash:long = FileSource;
fileSourceWallPaper#50dbf2f7 id:long access_hash:long = FileSource;
fileSourceStickerSet#34c73709 stickerset:InputStickerSet = FileSource;
fileSourceSavedGifs#13e78e07 = FileSource;
fileSourceSavedRingtones#2b25ef1b = FileSource;
fileSourceAvailableEffects#eb8578f0 = FileSource;
fileSourceAvailableReactions#0e432388 = FileSource;
fileSourceUserProfilePhoto#e39ee274 user_id:long max_id:long = FileSource;
fileSourceDocumentByHash#0f151e0f sha256:bytes size:long mime_type:string = FileSource;
</code></pre>
<!-- end db schema -->
<p>Locations:</p>
<!-- start locations -->
<ul>
<li><a href="/constructor/inputPhoto">inputPhoto</a> - <code>fileIdPhoto</code> (outgoing)</li>
<li><a href="/constructor/inputDocument">inputDocument</a> - <code>fileIdDocument</code> (outgoing)</li>
<li><a href="/constructor/inputDocumentFileLocation">inputDocumentFileLocation</a> - <code>fileIdDocument</code> (outgoing)</li>
<li><a href="/constructor/inputPhotoFileLocation">inputPhotoFileLocation</a> - <code>fileIdPhoto</code> (outgoing)</li>
<li><a href="/constructor/document">document</a> - <code>fileIdDocument</code> (incoming)</li>
<li><a href="/constructor/photo">photo</a> - <code>fileIdPhoto</code> (incoming)</li>
</ul>
<!-- end locations -->
<p>Actions:</p>
<!-- start actions -->
<ul>
<li>fileSourceMessage - <pre><code><a href="/api/file-references#getmessageop">getMessageOp</a>(peer: getInputPeerByIdOp(peer), id: copyOp(id), from_scheduled: copyOp(from_scheduled)quick_reply_shortcut_id: copyOp(quick_reply_shortcut_id))</code></pre></li>
<li>fileSourceStory - <pre><code><a href="/method/stories.getStoriesByID">stories.getStoriesByID</a>(id: [copyOp(id)], peer: getInputPeerByIdOp(peer))</code></pre></li>
<li>fileSourceWebPage - <pre><code><a href="/method/messages.getWebPage">messages.getWebPage</a>(url: copyOp(url), hash: 0)</code></pre></li>
<li>fileSourceBotApp - <pre><code><a href="/method/messages.getBotApp">messages.getBotApp</a>(app: <a href="/constructor/inputBotAppID">inputBotAppID</a>{id: copyOp(id), access_hash: copyOp(access_hash)}, hash: 0)</code></pre></li>
<li>fileSourceUserFull - <pre><code><a href="/method/users.getFullUser">users.getFullUser</a>(id: getInputUserByIdOp(id))</code></pre></li>
<li>fileSourceAdminLog - <pre><code><a href="/method/channels.getAdminLog">channels.getAdminLog</a>(channel: getInputChannelByIdOp(channel), max_id: copyOp(max_id), min_id: copyOp(max_id), limit: 1, q: "")</code></pre></li>
<li>fileSourceStoryAlbum - <pre><code><a href="/method/stories.getAlbums">stories.getAlbums</a>(peer: getInputPeerByIdOp(peer), hash: 0)</code></pre></li>
<li>fileSourceBotPreviewMedia - <pre><code><a href="/method/bots.getPreviewMedias">bots.getPreviewMedias</a>(bot: getInputUserByIdOp(bot))</code></pre></li>
<li>fileSourceBotPreviewInfo - <pre><code><a href="/method/bots.getPreviewInfo">bots.getPreviewInfo</a>(bot: getInputUserByIdOp(bot), lang_code: copyOp(lang_code))</code></pre></li>
<li>fileSourcePaidMedia - <pre><code><a href="/method/messages.getExtendedMedia">messages.getExtendedMedia</a>(id: [copyOp(id)], peer: getInputPeerByIdOp(peer))</code></pre></li>
<li>fileSourceSavedMusic - <pre><code><a href="/method/users.getSavedMusicByID">users.getSavedMusicByID</a>(id: getInputUserByIdOp(user_id), documents: [<a href="/constructor/inputDocument">inputDocument</a>{id: copyOp(id), access_hash: copyOp(access_hash), file_reference: base64_decode("")}])</code></pre></li>
<li>fileSourceChatFull - <pre><code><a href="/method/messages.getFullChat">messages.getFullChat</a>(chat_id: copyOp(chat_id))</code></pre></li>
<li>fileSourceChannelFull - <pre><code><a href="/method/channels.getFullChannel">channels.getFullChannel</a>(channel: getInputChannelByIdOp(channel))</code></pre></li>
<li>fileSourcePremiumPromo - <pre><code><a href="/method/help.getPremiumPromo">help.getPremiumPromo</a>()</code></pre></li>
<li>fileSourceStarsTransaction - <pre><code><a href="/method/payments.getStarsTransactionsByID">payments.getStarsTransactionsByID</a>(peer: getInputPeerByIdOp(peer), ton: copyOp(ton), id: [<a href="/constructor/inputStarsTransaction">inputStarsTransaction</a>{id: copyOp(id), refund: copyOp(refund)}])</code></pre></li>
<li>fileSourceAttachMenuBot - <pre><code><a href="/method/messages.getAttachMenuBot">messages.getAttachMenuBot</a>(bot: getInputUserByIdOp(bot))</code></pre></li>
<li>fileSourceTheme - <pre><code><a href="/method/account.getTheme">account.getTheme</a>(theme: <a href="/constructor/inputTheme">inputTheme</a>{id: copyOp(id), access_hash: copyOp(access_hash)}, format: $themeFormat)</code></pre></li>
<li>fileSourceWallPaper - <pre><code><a href="/method/account.getWallPaper">account.getWallPaper</a>(wallpaper: <a href="/constructor/inputWallPaper">inputWallPaper</a>{id: copyOp(id), access_hash: copyOp(access_hash)})</code></pre></li>
<li>fileSourceStickerSet - <pre><code><a href="/method/messages.getStickerSet">messages.getStickerSet</a>(stickerset: copyOp(stickerset), hash: 0)</code></pre></li>
<li>fileSourceSavedGifs - <pre><code><a href="/method/messages.getSavedGifs">messages.getSavedGifs</a>(hash: 0)</code></pre></li>
<li>fileSourceSavedRingtones - <pre><code><a href="/method/account.getSavedRingtones">account.getSavedRingtones</a>(hash: 0)</code></pre></li>
<li>fileSourceAvailableEffects - <pre><code><a href="/method/messages.getAvailableEffects">messages.getAvailableEffects</a>(hash: 0)</code></pre></li>
<li>fileSourceAvailableReactions - <pre><code><a href="/method/messages.getAvailableReactions">messages.getAvailableReactions</a>(hash: 0)</code></pre></li>
<li>fileSourceUserProfilePhoto - <pre><code><a href="/method/photos.getUserPhotos">photos.getUserPhotos</a>(user_id: getInputUserByIdOp(user_id), offset: -1, max_id: copyOp(max_id), limit: 1)</code></pre></li>
<li>fileSourceDocumentByHash - <pre><code><a href="/method/messages.getDocumentByHash">messages.getDocumentByHash</a>(sha256: copyOp(sha256), size: copyOp(size), mime_type: copyOp(mime_type))</code></pre></li>
</ul>
<!-- end actions -->
<p>Origins:</p>
<!-- start origins -->
<ul>
<li><a href="/constructor/message">message</a> - <pre><code>fileSourceMessage{from_scheduled: <a href="/constructor/message">message</a>.from_scheduled?passthrough, quick_reply_shortcut_id: <a href="/constructor/message">message</a>.quick_reply_shortcut_id?passthrough, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/message">message</a>.peer_id), id: <a href="/constructor/message">message</a>.id}</code></pre></li>
<li><a href="/constructor/messageService">messageService</a> - <pre><code>fileSourceMessage{peer: extractPeerIdFromPeerAndStore(<a href="/constructor/messageService">messageService</a>.peer_id), id: <a href="/constructor/messageService">messageService</a>.id, from_scheduled: false, quick_reply_shortcut_id: false}</code></pre></li>
<li>(1) <a href="/constructor/storyItem">storyItem</a> - <pre><code>(needs <a href="/method/stories.getPinnedStories">stories.getPinnedStories</a>) fileSourceStory{id: <a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromInputPeerAndStore(<a href="/method/stories.getPinnedStories">stories.getPinnedStories</a>.peer)}</code></pre></li>
<li>(2) <a href="/constructor/storyItem">storyItem</a> - <pre><code>(needs <a href="/method/stories.getStoriesArchive">stories.getStoriesArchive</a>) fileSourceStory{id: <a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromInputPeerAndStore(<a href="/method/stories.getStoriesArchive">stories.getStoriesArchive</a>.peer)}</code></pre></li>
<li>(3) <a href="/constructor/storyItem">storyItem</a> - <pre><code>(needs <a href="/method/stories.getStoriesByID">stories.getStoriesByID</a>) fileSourceStory{id: <a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromInputPeerAndStore(<a href="/method/stories.getStoriesByID">stories.getStoriesByID</a>.peer)}</code></pre></li>
<li>(4) <a href="/constructor/storyItem">storyItem</a> - <pre><code>(needs <a href="/method/stories.getAlbumStories">stories.getAlbumStories</a>) fileSourceStory{id: <a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromInputPeerAndStore(<a href="/method/stories.getAlbumStories">stories.getAlbumStories</a>.peer)}</code></pre></li>
<li>(5) <a href="/constructor/storyItem">storyItem</a> - <pre><code>(needs <a href="/constructor/peerStories">peerStories</a>) fileSourceStory{id: <a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/peerStories">peerStories</a>.peer)}</code></pre></li>
<li>(6) <a href="/constructor/storyItem">storyItem</a> - <pre><code>fileSourceStory{id: <a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/storyItem">storyItem</a>.from_id?abort_if_empty)}</code></pre></li>
<li><a href="/constructor/storyViewPublicRepost">storyViewPublicRepost</a> - <pre><code>fileSourceStory{id: <a href="/constructor/storyViewPublicRepost">storyViewPublicRepost</a>.story.<a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/storyViewPublicRepost">storyViewPublicRepost</a>.peer_id)}</code></pre></li>
<li><a href="/constructor/storyReactionPublicRepost">storyReactionPublicRepost</a> - <pre><code>fileSourceStory{id: <a href="/constructor/storyReactionPublicRepost">storyReactionPublicRepost</a>.story.<a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/storyReactionPublicRepost">storyReactionPublicRepost</a>.peer_id)}</code></pre></li>
<li><a href="/constructor/foundStory">foundStory</a> - <pre><code>fileSourceStory{id: <a href="/constructor/foundStory">foundStory</a>.story.<a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/foundStory">foundStory</a>.peer)}</code></pre></li>
<li><a href="/constructor/publicForwardStory">publicForwardStory</a> - <pre><code>fileSourceStory{id: <a href="/constructor/publicForwardStory">publicForwardStory</a>.story.<a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/publicForwardStory">publicForwardStory</a>.peer)}</code></pre></li>
<li><a href="/constructor/webPageAttributeStory">webPageAttributeStory</a> - <pre><code>fileSourceStory{id: <a href="/constructor/webPageAttributeStory">webPageAttributeStory</a>.story?abort_if_empty.<a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/webPageAttributeStory">webPageAttributeStory</a>.peer)}</code></pre></li>
<li><a href="/constructor/messageMediaStory">messageMediaStory</a> - <pre><code>fileSourceStory{id: <a href="/constructor/messageMediaStory">messageMediaStory</a>.story?abort_if_empty.<a href="/constructor/storyItem">storyItem</a>.id, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/messageMediaStory">messageMediaStory</a>.peer)}</code></pre></li>
<li><a href="/constructor/webPage">webPage</a> - <pre><code>fileSourceWebPage{url: <a href="/constructor/webPage">webPage</a>.url}</code></pre></li>
<li><a href="/constructor/botApp">botApp</a> - <pre><code>fileSourceBotApp{id: <a href="/constructor/botApp">botApp</a>.id, access_hash: <a href="/constructor/botApp">botApp</a>.access_hash}</code></pre></li>
<li><a href="/constructor/botInfo">botInfo</a> - <pre><code>fileSourceUserFull{id: <a href="/constructor/botInfo">botInfo</a>.user_id?abort_if_empty}</code></pre></li>
<li><a href="/constructor/channelAdminLogEvent">channelAdminLogEvent</a> - <pre><code>(needs <a href="/method/channels.getAdminLog">channels.getAdminLog</a>) fileSourceAdminLog{channel: extractChannelIdFromInputChannelAndStore(<a href="/method/channels.getAdminLog">channels.getAdminLog</a>.channel), max_id: <a href="/constructor/channelAdminLogEvent">channelAdminLogEvent</a>.id}</code></pre></li>
<li><a href="/method/stories.createAlbum">stories.createAlbum</a> - <pre><code>fileSourceStoryAlbum{peer: extractPeerIdFromInputPeerAndStore(<a href="/method/stories.createAlbum">stories.createAlbum</a>.peer)}</code></pre></li>
<li><a href="/method/stories.getAlbums">stories.getAlbums</a> - <pre><code>fileSourceStoryAlbum{peer: extractPeerIdFromInputPeerAndStore(<a href="/method/stories.getAlbums">stories.getAlbums</a>.peer)}</code></pre></li>
<li><a href="/method/stories.updateAlbum">stories.updateAlbum</a> - <pre><code>fileSourceStoryAlbum{peer: extractPeerIdFromInputPeerAndStore(<a href="/method/stories.updateAlbum">stories.updateAlbum</a>.peer)}</code></pre></li>
<li><a href="/method/bots.getPreviewMedias">bots.getPreviewMedias</a> - <pre><code>fileSourceBotPreviewMedia{bot: extractUserIdFromInputUserAndStore(<a href="/method/bots.getPreviewMedias">bots.getPreviewMedias</a>.bot)}</code></pre></li>
<li><a href="/method/bots.getPreviewInfo">bots.getPreviewInfo</a> - <pre><code>fileSourceBotPreviewInfo{bot: extractUserIdFromInputUserAndStore(<a href="/method/bots.getPreviewInfo">bots.getPreviewInfo</a>.bot), lang_code: <a href="/method/bots.getPreviewInfo">bots.getPreviewInfo</a>.lang_code}</code></pre></li>
<li><a href="/method/bots.addPreviewMedia">bots.addPreviewMedia</a> - <pre><code>fileSourceBotPreviewInfo{bot: extractUserIdFromInputUserAndStore(<a href="/method/bots.addPreviewMedia">bots.addPreviewMedia</a>.bot), lang_code: <a href="/method/bots.addPreviewMedia">bots.addPreviewMedia</a>.lang_code}</code></pre></li>
<li><a href="/method/bots.editPreviewMedia">bots.editPreviewMedia</a> - <pre><code>fileSourceBotPreviewInfo{bot: extractUserIdFromInputUserAndStore(<a href="/method/bots.editPreviewMedia">bots.editPreviewMedia</a>.bot), lang_code: <a href="/method/bots.editPreviewMedia">bots.editPreviewMedia</a>.lang_code}</code></pre></li>
<li><a href="/constructor/updateMessageExtendedMedia">updateMessageExtendedMedia</a> - <pre><code>fileSourcePaidMedia{id: <a href="/constructor/updateMessageExtendedMedia">updateMessageExtendedMedia</a>.msg_id, peer: extractPeerIdFromPeerAndStore(<a href="/constructor/updateMessageExtendedMedia">updateMessageExtendedMedia</a>.peer)}</code></pre></li>
<li>(1) <a href="/constructor/userFull">userFull</a> - <pre><code>fileSourceUserFull{id: <a href="/constructor/userFull">userFull</a>.id}</code></pre></li>
<li>(2) <a href="/constructor/userFull">userFull</a> - <pre><code>fileSourceSavedMusic{user_id: <a href="/constructor/userFull">userFull</a>.id, id: <a href="/constructor/userFull">userFull</a>.saved_music?abort_if_empty.<a href="/constructor/document">document</a>.id, access_hash: <a href="/constructor/userFull">userFull</a>.saved_music?abort_if_empty.<a href="/constructor/document">document</a>.access_hash}</code></pre></li>
<li><a href="/constructor/chatFull">chatFull</a> - <pre><code>fileSourceChatFull{chat_id: <a href="/constructor/chatFull">chatFull</a>.id}</code></pre></li>
<li><a href="/constructor/channelFull">channelFull</a> - <pre><code>fileSourceChannelFull{channel: <a href="/constructor/channelFull">channelFull</a>.id}</code></pre></li>
<li><a href="/method/help.getPremiumPromo">help.getPremiumPromo</a> - <pre><code>fileSourcePremiumPromo{}</code></pre></li>
<li>(1) <a href="/constructor/starsTransaction">starsTransaction</a> - <pre><code>(needs <a href="/method/payments.getStarsStatus">payments.getStarsStatus</a>) fileSourceStarsTransaction{peer: extractPeerIdFromInputPeerAndStore(<a href="/method/payments.getStarsStatus">payments.getStarsStatus</a>.peer), ton: <a href="/method/payments.getStarsStatus">payments.getStarsStatus</a>.ton?passthrough, id: <a href="/constructor/starsTransaction">starsTransaction</a>.id, refund: <a href="/constructor/starsTransaction">starsTransaction</a>.refund?passthrough}</code></pre></li>
<li>(2) <a href="/constructor/starsTransaction">starsTransaction</a> - <pre><code>(needs <a href="/method/payments.getStarsTransactions">payments.getStarsTransactions</a>) fileSourceStarsTransaction{peer: extractPeerIdFromInputPeerAndStore(<a href="/method/payments.getStarsTransactions">payments.getStarsTransactions</a>.peer), ton: <a href="/method/payments.getStarsTransactions">payments.getStarsTransactions</a>.ton?passthrough, id: <a href="/constructor/starsTransaction">starsTransaction</a>.id, refund: <a href="/constructor/starsTransaction">starsTransaction</a>.refund?passthrough}</code></pre></li>
<li>(3) <a href="/constructor/starsTransaction">starsTransaction</a> - <pre><code>(needs <a href="/method/payments.getStarsTransactionsByID">payments.getStarsTransactionsByID</a>) fileSourceStarsTransaction{peer: extractPeerIdFromInputPeerAndStore(<a href="/method/payments.getStarsTransactionsByID">payments.getStarsTransactionsByID</a>.peer), ton: <a href="/method/payments.getStarsTransactionsByID">payments.getStarsTransactionsByID</a>.ton?passthrough, id: <a href="/constructor/starsTransaction">starsTransaction</a>.id, refund: <a href="/constructor/starsTransaction">starsTransaction</a>.refund?passthrough}</code></pre></li>
<li>(4) <a href="/constructor/starsTransaction">starsTransaction</a> - <pre><code>(needs <a href="/method/payments.getStarsSubscriptions">payments.getStarsSubscriptions</a>) fileSourceStarsTransaction{peer: extractPeerIdFromInputPeerAndStore(<a href="/method/payments.getStarsSubscriptions">payments.getStarsSubscriptions</a>.peer), id: <a href="/constructor/starsTransaction">starsTransaction</a>.id, refund: <a href="/constructor/starsTransaction">starsTransaction</a>.refund?passthrough, ton: false}</code></pre></li>
<li><a href="/constructor/attachMenuBot">attachMenuBot</a> - <pre><code>fileSourceAttachMenuBot{bot: <a href="/constructor/attachMenuBot">attachMenuBot</a>.bot_id}</code></pre></li>
<li><a href="/constructor/theme">theme</a> - <pre><code>fileSourceTheme{id: <a href="/constructor/theme">theme</a>.id, access_hash: <a href="/constructor/theme">theme</a>.access_hash}</code></pre></li>
<li><a href="/constructor/wallPaper">wallPaper</a> - <pre><code>fileSourceWallPaper{id: <a href="/constructor/wallPaper">wallPaper</a>.id, access_hash: <a href="/constructor/wallPaper">wallPaper</a>.access_hash}</code></pre></li>
<li><a href="/constructor/stickerSetMultiCovered">stickerSetMultiCovered</a> - <pre><code>fileSourceStickerSet{stickerset: extractInputStickerSetFromStickerSetAndStore(<a href="/constructor/stickerSetMultiCovered">stickerSetMultiCovered</a>.set)}</code></pre></li>
<li><a href="/constructor/stickerSetFullCovered">stickerSetFullCovered</a> - <pre><code>fileSourceStickerSet{stickerset: extractInputStickerSetFromStickerSetAndStore(<a href="/constructor/stickerSetFullCovered">stickerSetFullCovered</a>.set)}</code></pre></li>
<li><a href="/constructor/messages.stickerSet">messages.stickerSet</a> - <pre><code>fileSourceStickerSet{stickerset: extractInputStickerSetFromStickerSetAndStore(<a href="/constructor/messages.stickerSet">messages.stickerSet</a>.set)}</code></pre></li>
<li><a href="/constructor/messages.savedGifs">messages.savedGifs</a> - <pre><code>fileSourceSavedGifs{}</code></pre></li>
<li><a href="/constructor/account.savedRingtones">account.savedRingtones</a> - <pre><code>fileSourceSavedRingtones{}</code></pre></li>
<li><a href="/constructor/account.savedRingtoneConverted">account.savedRingtoneConverted</a> - <pre><code>fileSourceSavedRingtones{}</code></pre></li>
<li><a href="/method/account.uploadRingtone">account.uploadRingtone</a> - <pre><code>fileSourceSavedRingtones{}</code></pre></li>
<li><a href="/constructor/messages.availableEffects">messages.availableEffects</a> - <pre><code>fileSourceAvailableEffects{}</code></pre></li>
<li><a href="/constructor/messages.availableReactions">messages.availableReactions</a> - <pre><code>fileSourceAvailableReactions{}</code></pre></li>
<li><a href="/constructor/photo">photo</a> - <pre><code>(needs <a href="/method/photos.getUserPhotos">photos.getUserPhotos</a>) fileSourceUserProfilePhoto{user_id: extractUserIdFromInputUserAndStore(<a href="/method/photos.getUserPhotos">photos.getUserPhotos</a>.user_id), max_id: <a href="/constructor/photo">photo</a>.id}</code></pre></li>
<li><a href="/method/photos.updateProfilePhoto">photos.updateProfilePhoto</a> - <pre><code>fileSourceUserProfilePhoto{user_id: extractUserIdFromInputUserAndStore(<a href="/method/photos.updateProfilePhoto">photos.updateProfilePhoto</a>.bot?fallback(<a href="/constructor/inputUserSelf">inputUserSelf</a>{})), max_id: <a href="/method/photos.updateProfilePhoto">photos.updateProfilePhoto</a>.(return value).<a href="/constructor/photos.photo">photos.photo</a>.photo.<a href="/constructor/photo">photo</a>.id}</code></pre></li>
<li><a href="/method/photos.uploadProfilePhoto">photos.uploadProfilePhoto</a> - <pre><code>fileSourceUserProfilePhoto{user_id: extractUserIdFromInputUserAndStore(<a href="/method/photos.uploadProfilePhoto">photos.uploadProfilePhoto</a>.bot?fallback(<a href="/constructor/inputUserSelf">inputUserSelf</a>{})), max_id: <a href="/method/photos.uploadProfilePhoto">photos.uploadProfilePhoto</a>.(return value).<a href="/constructor/photos.photo">photos.photo</a>.photo.<a href="/constructor/photo">photo</a>.id}</code></pre></li>
<li><a href="/method/photos.uploadContactProfilePhoto">photos.uploadContactProfilePhoto</a> - <pre><code>fileSourceUserProfilePhoto{user_id: extractUserIdFromInputUserAndStore(<a href="/method/photos.uploadContactProfilePhoto">photos.uploadContactProfilePhoto</a>.user_id), max_id: <a href="/method/photos.uploadContactProfilePhoto">photos.uploadContactProfilePhoto</a>.(return value).<a href="/constructor/photos.photo">photos.photo</a>.photo.<a href="/constructor/photo">photo</a>.id}</code></pre></li>
<li>(1) <a href="/constructor/document">document</a> - <pre><code>fileSourceStickerSet{stickerset: extractInputStickerSetFromDocumentAttributesAndStore(<a href="/constructor/document">document</a>.attributes)}</code></pre></li>
<li>(2) <a href="/constructor/document">document</a> - <pre><code>(needs <a href="/method/users.getSavedMusic">users.getSavedMusic</a>) fileSourceSavedMusic{user_id: extractUserIdFromInputUserAndStore(<a href="/method/users.getSavedMusic">users.getSavedMusic</a>.id), id: <a href="/constructor/document">document</a>.id, access_hash: <a href="/constructor/document">document</a>.access_hash}</code></pre></li>
<li>(3) <a href="/constructor/document">document</a> - <pre><code>(needs <a href="/method/users.getSavedMusicByID">users.getSavedMusicByID</a>) fileSourceSavedMusic{user_id: extractUserIdFromInputUserAndStore(<a href="/method/users.getSavedMusicByID">users.getSavedMusicByID</a>.id), id: <a href="/constructor/document">document</a>.id, access_hash: <a href="/constructor/document">document</a>.access_hash}</code></pre></li>
<li><a href="/method/messages.getDocumentByHash">messages.getDocumentByHash</a> - <pre><code>fileSourceDocumentByHash{sha256: <a href="/method/messages.getDocumentByHash">messages.getDocumentByHash</a>.sha256, size: <a href="/method/messages.getDocumentByHash">messages.getDocumentByHash</a>.size, mime_type: <a href="/method/messages.getDocumentByHash">messages.getDocumentByHash</a>.mime_type}</code></pre></li>
</ul>
<!-- end origins -->
<p>Skipped:</p>
<!-- start skipped -->
<ul>
<li><a href="/method/messages.getSponsoredMessages">messages.getSponsoredMessages</a> - Do not store file references from sponsored messages</li>
<li><a href="/method/help.getAppUpdate">help.getAppUpdate</a> - Don't handle file references from ephemeral app update info</li>
<li><a href="/method/help.getRecentMeUrls">help.getRecentMeUrls</a> - Don't handle file references from recent t.me URLs</li>
<li><a href="/constructor/recentMeUrlChatInvite">recentMeUrlChatInvite</a> - Do not store references based on chat invite links</li>
<li><a href="/method/messages.checkChatInvite">messages.checkChatInvite</a> - Do not store references based on chat invite links</li>
<li><a href="/method/messages.getInlineBotResults">messages.getInlineBotResults</a> - Inline bot results are ephemeral</li>
<li><a href="/method/messages.getPreparedInlineMessage">messages.getPreparedInlineMessage</a> - Inline bot results are ephemeral</li>
<li><a href="/method/messages.uploadMedia">messages.uploadMedia</a> - A freshly uploaded media file will obtain a context only once it is sent to a chat</li>
<li><a href="/method/messages.uploadImportedMedia">messages.uploadImportedMedia</a> - A freshly uploaded media file will obtain a context only once it is sent to a chat</li>
<li><a href="/constructor/updateServiceNotification">updateServiceNotification</a> - Cannot refetch service notifications</li>
<li><a href="/method/messages.getWebPagePreview">messages.getWebPagePreview</a> - No locations are added for the method call, as it doesn't use persistent IDs as input; the location is instead extracted from the persistent IDs in the returned WebPage object</li>
<li><a href="/constructor/payments.resaleStarGifts">payments.resaleStarGifts</a> - Contexts for star gifts are not yet implemented</li>
<li><a href="/constructor/payments.starGiftUpgradePreview">payments.starGiftUpgradePreview</a> - Contexts for star gifts are not yet implemented</li>
<li><a href="/constructor/starGift">starGift</a> - Contexts for star gifts are not yet implemented</li>
<li><a href="/constructor/starGiftUnique">starGiftUnique</a> - Contexts for star gifts are not yet implemented</li>
<li><a href="/constructor/starGiftCollection">starGiftCollection</a> - Contexts for star gifts are not yet implemented</li>
<li><a href="/constructor/payments.starGiftCollections">payments.starGiftCollections</a> - Contexts for star gifts are not yet implemented</li>
<li><a href="/method/messages.getCustomEmojiDocuments">messages.getCustomEmojiDocuments</a> - Do not store file references in this context</li>
<li><a href="/method/account.uploadTheme">account.uploadTheme</a> - A freshly uploaded theme file will obtain a context only once it is created via account.createTheme</li>
</ul>
<!-- end skipped -->
<p>Here's a detailed description of the constructors.</p>
<h4><a class="anchor" href="#root" id="root" name="root"><i class="anchor-icon"></i></a>Root</h4>
<pre><code>fileReferenceOrigins#ed01a4f1 db_schema:string db_schema_json:string locations:Vector&lt;Location&gt; origins:Vector&lt;Origin&gt; skipped:Vector&lt;SkippedOrigin&gt; actions:Vector&lt;Action&gt; = FileReferenceOrigins;

locationIncoming#e18770f4 predicate:string stored_constructor:string = Location;
locationOutgoing#e7740ae0 predicate:string stored_constructor:string = Location;

origin#b62177bf flags:# predicate:string is_constructor:flags.0?true stored_constructor:string stored_params:Vector&lt;FieldExtractor&gt; skipped_flags:Vector&lt;string&gt; needs_parent:flags.3?string parent_is_constructor:flags.4?true = origin;

skippedOrigin#7c62809e flags:# predicate:string is_constructor:flags.0?true why:string = SkippedOrigin;

action#9539f410 stored_constructor:string action:ActionOp = Action;</code></pre>
<p>The map file is composed of a single <code>fileReferenceOrigins</code> constructor, which contains:</p>
<ul>
<li>
<p>The <code>db_schema</code> and <code>db_schema_json</code> fields with the TL <strong>database</strong> schema of <code>FileId</code>s and <code>FileSource</code>s.<br>
<code>db_schema</code> is text TL schema, <code>db_schema_json</code> is the same TL schema in the JSON format <a href="/schema">also used for the API schema »</a>.  </p>
</li>
<li>
<p>A list of <code>Location</code> constructors, containing the full list of constructors that have a <code>file_reference</code> field, and info on how to generate a <code>FileId</code> from them.  </p>
</li>
<li>
<p>A list of <code>origin</code> constructors, containing instructions on how to generate <code>FileSource</code>s from received constructors or method responses.   </p>
</li>
<li>
<p>A list of <code>action</code> constructors, containing the method call to invoke when refreshing a file reference using a previously stored <code>FileId</code> and <code>FileSource</code>.  </p>
</li>
<li>
<p>A list of <code>skippedOrigin</code> constructors.
These constructors indicate that the origin should be ignored completely (including during codegen): <code>skippedOrigin</code> origins are used internally to make sure all file reference paths are still covered in some way during validation, including paths for ephemeral media like inline results, or for media without any associated origin (for example, media uploaded using <a href="/method/messages.uploadMedia">messages.uploadMedia</a> but not yet sent anywhere obviously does not have any associated origin).  </p>
<ul>
<li><code>skippedOrigin.predicate</code> - Indicates the name of the ignored constructor or method.</li>
<li><code>skippedOrigin.is_constructor</code> - If set, <code>predicate</code> points to a constructor, otherwise it points to a method.</li>
<li><code>skippedOrigin.why</code> - A human-readable reason as to why this origin should be ignored.</li>
</ul>
<p>Each skipped predicate can have one associated reason.  </p>
</li>
</ul>
<h4><a class="anchor" href="#locations" id="locations" name="locations"><i class="anchor-icon"></i></a>Locations</h4>
<pre><code>locationIncoming#e18770f4 predicate:string stored_constructor:string = Location;
locationOutgoing#e7740ae0 predicate:string stored_constructor:string = Location;</code></pre>
<p>Locations contain the full list of constructors (never methods) that have a <code>file_reference</code> and an <code>id</code> field.  </p>
<p>The <code>id</code> field of <code>predicate</code> must be used to generate a <code>FileId</code> object of type <code>stored_constructor</code>.  </p>
<p><code>locationIncoming</code> references constructors that can only be received from the API.<br>
<code>locationOutgoing</code> references constructors that can only be sent to the API.  </p>
<p>Params:</p>
<ul>
<li><code>predicate</code> - The name of the API constructor.</li>
<li><code>stored_constructor</code> - The name of the <code>FileId</code> object to be used for database read/writes.  </li>
</ul>
<p>Each unique predicate can only have one <code>stored_constructor</code>.  </p>
<p>For example, current API layers have the following locations:</p>
<ul>
<li><a href="/constructor/photo">photo</a> =&gt; <code>fileIdPhoto</code> (incoming)</li>
<li><a href="/constructor/document">document</a> =&gt; <code>fileIdDocument</code> (incoming)</li>
<li><a href="/constructor/inputPhoto">inputPhoto</a> =&gt; <code>fileIdPhoto</code> (outgoing)</li>
<li><a href="/constructor/inputPhotoFileLocation">inputPhotoFileLocation</a> =&gt; <code>fileIdPhoto</code> (outgoing)</li>
<li><a href="/constructor/inputDocument">inputDocument</a> =&gt; <code>fileIdDocument</code> (outgoing)</li>
<li><a href="/constructor/inputDocumentFileLocation">inputDocumentFileLocation</a> =&gt; <code>fileIdDocument</code> (outgoing)</li>
</ul>
<p>When encountering one of the objects on the left, use the <code>id</code> field to generate a <code>FileId</code> of the type on the right.  </p>
<p>When refreshing references, replace the <code>file_reference</code> field of the object on the left.  </p>
<p>(Legacy <code>inputFileLocation</code> constructors are ignored by the current map file).</p>
<h4><a class="anchor" href="#origin" id="origin" name="origin"><i class="anchor-icon"></i></a>Origin</h4>
<pre><code>origin#b62177bf flags:# predicate:string is_constructor:flags.0?true stored_constructor:string stored_params:Vector&lt;FieldExtractor&gt; skipped_flags:Vector&lt;string&gt; needs_parent:flags.3?string parent_is_constructor:flags.4?true = origin;</code></pre>
<p>An <code>origin</code> contains instructions on how to extract and store file reference origins from an incoming method response or update.  </p>
<p><strong>Note</strong>: The following sections assume that all <a href="/type/Updates">Updates</a> constructors have already been converted to a vector of <a href="/type/Update">Update</a> constructors, <strong>including short variants</strong> like <a href="/constructor/updateShortMessage">updateShortMessage</a>, <a href="/constructor/updateShortSentMessage">updateShortSentMessage</a>, <a href="/constructor/updateShortChatMessage">updateShortChatMessage</a>, which must be pre-converted to <a href="/type/Update">Update</a> constructors by the client using information extracted from the method call.<br>
While this operation could be done within the map file, it would needlessly increase the number of paths: given that most clients already convert short constructors to Update constructors, the map file only considers paths starting from the Update constructors.  </p>
<p>Parameters:</p>
<ul>
<li><code>predicate</code> - Indicates the name of the constructor or of the method where extraction of the origin fields must start.</li>
<li><code>is_constructor</code> - If set, <code>predicate</code> points to a constructor, otherwise it points to a method.</li>
<li><code>needs_parent</code> - If set, contains the name of a constructor which needs to appear as a parent in the deserialized object or a method whose response we're deserializing, as it will be used by one or more of the paths in the action.</li>
<li><code>parent_is_constructor</code> - If set, <code>needs_parent</code> points to a constructor; otherwise it points to a method.</li>
<li><code>stored_constructor</code> - Contains the name of a <code>FileSource</code> constructor from the TL schema specified in <code>fileReferenceOrigins.db_schema</code>, which should be stored to the database after being populated by <code>stored_params</code> as specified below.</li>
<li><code>stored_params</code> - Contains info on how to populate the <code>FileSource</code> constructor specified in <code>stored_constructor</code></li>
<li><code>skipped_flags</code> - In some cases, some <strong>flag</strong> fields of <code>stored_constructor</code> aren't referenced by <code>action</code>: this field contains the full list of flags which are never referenced by the current origin and must be unset.  </li>
</ul>
<p>Each unique predicate can have one or more <code>stored_constructor</code>s with different params.  </p>
<p>If the <code>is_constructor</code> flag is set, when deserializing a constructor with predicate equal to <code>predicate</code>, contained in an incoming <a href="/type/Update">Update</a> or in at any depth in a method call response, do the following:</p>
<ul>
<li><strong>Before</strong> beginning deserialization of the constructor, push a new <code>FileSource</code> of type <code>stored_constructor</code> to the file source stack.<br>
Skip pushing the <code>FileSource</code> if <code>needs_parent</code> is set but we don't have a constructor or method of type <code>needs_parent</code> in our parents.</li>
<li>During deserialization, associate all encountered <code>FileId</code>s (generated according to the <a href="#locations">locations schema</a>) to all sources <strong>of all types</strong> currently on the stack.</li>
<li><strong>After</strong> deserialization of the constructor, pop the pushed <code>FileSource</code> of type <code>stored_constructor</code>, make sure it can be processed according to <code>stored_params</code> (all required flag fields are set, all paths can be correctly extracted), and if yes, populate the <code>FileSource</code> of type <code>stored_constructor</code> accordingly and commit the origin to the database (using the <code>FileId</code>s associated at step 2 as keys, and <code>stored_constructor</code> as value).<br>
Skip this step if <code>needs_parent</code> is set but we don't have a constructor or method of type <code>needs_parent</code> in our parents.</li>
</ul>
<p>If the <code>is_constructor</code> flag is <strong>not</strong> set, when deserializing the response of the method with name equal to <code>predicate</code>, do the following:</p>
<ul>
<li><strong>Before</strong> beginning deserialization of the method <strong>response</strong>, push a new <code>FileSource</code> of type <code>stored_constructor</code> to the file source stack.</li>
<li>During deserialization, associate all encountered <code>FileId</code>s (generated according to the <a href="#locations">locations schema</a>) to all sources <strong>of all types</strong> currently on the stack.</li>
<li><strong>After</strong> deserialization of the method <strong>response</strong>, pop the pushed <code>FileSource</code> of type <code>stored_constructor</code>, make sure it can be processed according to <code>stored_params</code> (all required flag fields are set, all paths can be correctly extracted), and if yes, populate the <code>FileSource</code> of type <code>stored_constructor</code> accordingly and commit the origin to the database (using the <code>FileId</code>s associated at step 2 as keys, and <code>stored_constructor</code> as value).   </li>
</ul>
<p>Note that method origins cannot make use of <code>needs_parent</code>.   </p>
<h4><a class="anchor" href="#field-extraction" id="field-extraction" name="field-extraction"><i class="anchor-icon"></i></a>Field extraction</h4>
<pre><code>// Extractor
extractAndStore#72069549 from:Path to:string = FieldExtractor;

extractInputStickerSetFromDocumentAttributesAndStore#369d8d14 from:Path to:string = FieldExtractor;
extractInputStickerSetFromStickerSetAndStore#c167d470 from:Path to:string = FieldExtractor;

extractPeerIdFromPeerAndStore#7d33019c from:Path to:string = FieldExtractor;
extractPeerIdFromInputPeerAndStore#a51acfb4 from:Path to:string = FieldExtractor;

extractChannelIdFromChannelAndStore#5675bc97 from:Path to:string = FieldExtractor;
extractChannelIdFromInputChannelAndStore#b662660e from:Path to:string = FieldExtractor;

extractUserIdFromUserAndStore#4778ec63 from:Path to:string = FieldExtractor;
extractUserIdFromInputUserAndStore#7720aa2e from:Path to:string = FieldExtractor;

// Paths
paramNotFlag#acd9d5cf = ParamFlag;
paramIsFlagAbortIfEmpty#f8fe9fee = ParamFlag;
paramIsFlagFallback#202b77a1 fallback:TypedOp = ParamFlag;
paramIsFlagPassthrough#1dc6e17d = ParamFlag;

pathPart#8dc6ff46 constructor:string param:string flag:ParamFlag = PathPart;

path#c3586a2 parts:Vector&lt;PathPart&gt; = Path;
pathParent#58f13684 parts:Vector&lt;PathPart&gt; = Path;</code></pre>
<p>Field extractors are used to extract a parameter from one or more constructors, i.e. <code>updateStory.story -&gt; storyItem.media -&gt; messageMediaDocument.document -&gt; document.file_reference</code> and store it to the specified field of a <code>FileSource</code>.  </p>
<h5><a class="anchor" href="#extractors" id="extractors" name="extractors"><i class="anchor-icon"></i></a>Extractors</h5>
<pre><code>extractAndStore#72069549 from:Path to:string = FieldExtractor;

extractInputStickerSetFromDocumentAttributesAndStore#369d8d14 from:Path to:string = FieldExtractor;
extractInputStickerSetFromStickerSetAndStore#c167d470 from:Path to:string = FieldExtractor;

extractPeerIdFromPeerAndStore#7d33019c from:Path to:string = FieldExtractor;
extractPeerIdFromInputPeerAndStore#a51acfb4 from:Path to:string = FieldExtractor;

extractChannelIdFromChannelAndStore#5675bc97 from:Path to:string = FieldExtractor;
extractChannelIdFromInputChannelAndStore#b662660e from:Path to:string = FieldExtractor;

extractUserIdFromUserAndStore#4778ec63 from:Path to:string = FieldExtractor;
extractUserIdFromInputUserAndStore#7720aa2e from:Path to:string = FieldExtractor;</code></pre>
<h6><code>extractAndStore</code></h6>
<p>Extracts the value at the specified path and stores it to <code>$FileSource.$to</code>.</p>
<h6><code>extractInputStickerSetFromDocumentAttributesAndStore</code></h6>
<p>Takes the <code>Vector&lt;DocumentAttribute&gt;</code> at <code>from</code>, looks for a <a href="/constructor/documentAttributeSticker">documentAttributeSticker</a>, and stores the <a href="/type/InputStickerSet">InputStickerSet</a> contained in <a href="/constructor/documentAttributeSticker">documentAttributeSticker</a>.<code>stickerset</code> into <code>$FileSource.$to</code>.</p>
<p>Aborts if there is no attribute of type <a href="/constructor/documentAttributeSticker">documentAttributeSticker</a> in the passed vector.</p>
<h6><code>extractInputStickerSetFromStickerSetAndStore</code></h6>
<p>Takes the <a href="/constructor/stickerSet">stickerSet</a> at <code>from</code>, transforms it into an <a href="/type/InputStickerSet">InputStickerSet</a>, and stores it into <code>$FileSource.$to</code>.</p>
<h6><code>extractPeerIdFromPeerAndStore</code></h6>
<p>Takes the <a href="/type/Peer">Peer</a> at <code>from</code>, transforms it into a <a href="/api/bots/ids">bot API peer ID (of type <code>long</code>) »</a>, and stores it into <code>$FileSource.$to</code>.  </p>
<h6><code>extractPeerIdFromPeerAndStore</code></h6>
<p>Takes the <a href="/type/InputPeer">InputPeer</a> at <code>from</code>, transforms it into a <a href="/api/bots/ids">bot API peer ID (of type <code>long</code>) »</a>, and stores it into <code>$FileSource.$to</code>.  </p>
<h6><code>extractChannelIdFromChannelAndStore</code></h6>
<p>Takes the <a href="/constructor/channel">channel</a> at <code>from</code>, takes the <code>id</code> field and stores it into <code>$FileSource.$to</code>.  </p>
<h6><code>extractChannelIdFromInputChannelAndStore</code></h6>
<p>Takes the <a href="/type/InputChannel">InputChannel</a> at <code>from</code>, takes the <code>channel_id</code> field and stores it into <code>$FileSource.$to</code>.  </p>
<p>Aborts if <code>from</code> points to an <a href="/constructor/inputChannelEmpty">inputChannelEmpty</a>.  </p>
<h6><code>extractUserIdFromUserAndStore</code></h6>
<p>Takes the <a href="/constructor/user">user</a> at <code>from</code>, takes the <code>id</code> field and stores it into <code>$FileSource.$to</code>.  </p>
<h6><code>extractUserIdFromInputUserAndStore</code></h6>
<p>Takes the <a href="/type/InputUser">InputUser</a> at <code>from</code>, takes the <code>user_id</code> field and stores it into <code>$FileSource.$to</code>.  </p>
<p>If <code>from</code> points to an <a href="/constructor/inputUserSelf">inputUserSelf</a>, stores the ID of the current user, instead.  </p>
<p>Aborts if <code>from</code> points to an <a href="/constructor/inputUserEmpty">inputUserEmpty</a>.  </p>
<h5><a class="anchor" href="#paths" id="paths" name="paths"><i class="anchor-icon"></i></a>Paths</h5>
<p>The first part of the path always points to:</p>
<ul>
<li>The constructor/method of the <code>origin</code> (<code>origin.predicate</code>), for <code>path</code></li>
<li>The constructor/method of the parent contained in <code>origin.needs_parent</code>, for <code>pathParent</code></li>
</ul>
<p>A path is composed of multiple <code>pathPart</code>s.  </p>
<p>Each <code>pathPart</code> contains the following fields, which describe how to extract the field.  </p>
<ul>
<li><code>constructor</code> - Indicates the required constructor/method predicate. 
If a different constructor type is encountered (i.e. <a href="/constructor/documentEmpty">documentEmpty</a> instead of <a href="/constructor/document">document</a>), abort extraction.<br>
By definition, if a method name is passed, it will always be equal to the method of the associated origin.</li>
<li><code>param</code> - Indicates the required parameter; if it's an empty string, it indicates the return value of a method.  </li>
<li><code>flag</code> - Contains exactly one of the following constructors:<ul>
<li><code>paramNotFlag</code> - The current parameter is not a flag</li>
<li><code>paramIsFlagAbortIfEmpty</code> - The current parameter is a flag, and if it's not set, abort extraction.  </li>
<li><code>paramIsFlagFallback</code> -  The current parameter is a flag, and if it's not set, use the specified <code>TypedOp</code> as fallback value.<br>
Note that OPs of type <code>copyOp</code>, <code>getInputChannelByIdOp</code>, <code>getInputUserByIdOp</code> and <code>getInputPeerByIdOp</code> are not allowed in this context.</li>
<li><code>paramIsFlagPassthrough</code> - The current parameter is a flag, and its value should be copied/returned verbatim; can only be used on the last element of a path and within the arguments of a constructorOp/callOp/getMessageOp only if the argument that uses this path is a flag of the same type.  </li>
</ul>
</li>
</ul>
<h4><a class="anchor" href="#actions" id="actions" name="actions"><i class="anchor-icon"></i></a>Actions</h4>
<pre><code>action#9539f410 stored_constructor:string action:ActionOp = Action;

// Actions
callOp#c2ff3383 method:string args:Vector&lt;TypedOpArg&gt; = ActionOp;
getMessageOp#237849e8 peer:TypedOp id:TypedOp from_scheduled:TypedOp quick_reply_shortcut_id:TypedOp = ActionOp;

// For string =&gt; TypedOp dictionaries
typedOpArg#3a2930c2 key:string value:TypedOp = TypedOpArg;

// Typed constructors, the type is specified to simplify codegen,
// but isn't strictly necessary as it can be inferred from the TypedOpOp.
// It is fully pre-validated during the generation of the definition file.
typedOp#705b10ec type:string op:TypedOpOp = TypedOp;</code></pre>
<p>Actions are used to refresh an expired file reference according to <code>FileSource</code>s associated to the <code>FileId</code> (i.e. a <code>FILE_REFERENCE_EXPIRED</code> RPC error is returned when using a file reference).  </p>
<p>Params:</p>
<ul>
<li><code>stored_constructor</code> - The name of an object of type <code>FileSource</code>, specified in the <code>db_schema</code>.</li>
<li><code>action</code> - The action to execute when refreshing a file source of type <code>stored_constructor</code>.  </li>
</ul>
<p>There can only be one action per constructor.</p>
<p>The arguments of the action are composed of a set of <code>typedOp</code> constructors.  </p>
<p><a href="#action-parameters"><code>typedOp</code> »</a> is a wrapper for a <code>TypedOpOp</code> constructor which also contains the TL <code>type</code> of the associated <code>TypedOpOp</code>; this isn't strictly necessary for evaluation, but it can be useful during automatic code generation from the definition file.  </p>
<h5><a class="anchor" href="#callop" id="callop" name="callop"><i class="anchor-icon"></i></a><code>callOp</code></h5>
<p><code>callOp</code> is a generic action which invokes the method specified in <code>method</code> with the arguments specified in <code>args</code>.  </p>
<p><code>callOp.args</code> will always contain at least all of the required parameters, and possibly some flagged parameters as well.  </p>
<h5><a class="anchor" href="#getmessageop" id="getmessageop" name="getmessageop"><i class="anchor-icon"></i></a><code>getMessageOp</code></h5>
<p><code>getMessageOp</code> is a specialized action which invokes either <a href="/method/messages.getMessages">messages.getMessages</a> or <a href="/method/channels.getMessages">channels.getMessages</a> depending on the type of the <code>peer</code> (which is always a subtype of <a href="/type/InputPeer">InputPeer</a>), passing the <code>id</code> as the only element to the vector <code>id</code> parameter.<br>
If the flag to which the <code>from_scheduled</code> points is set, <a href="/method/messages.getScheduledMessages">messages.getScheduledMessages</a> should be executed instead.<br>
If the flag to which the <code>quick_reply_shortcut_id</code> points is set, <a href="/method/messages.getQuickReplyMessages">messages.getQuickReplyMessages</a> should be executed instead, passing the value of the <code>quick_reply_shortcut_id</code> flag to <a href="/method/messages.getQuickReplyMessages">messages.getQuickReplyMessages</a>.<code>shortcut_id</code> and the <code>id</code> as the only element of a vector, passed to <a href="/method/messages.getQuickReplyMessages">messages.getQuickReplyMessages</a>.<code>id</code>.  </p>
<h4><a class="anchor" href="#action-parameters" id="action-parameters" name="action-parameters"><i class="anchor-icon"></i></a>Action parameters</h4>
<pre><code>copyOp#f48f418f from:string = TypedOpOp;

getInputChannelByIdOp#3cb47531 from:string = TypedOpOp;
getInputUserByIdOp#c0ee4326 from:string = TypedOpOp;
getInputPeerByIdOp#19813750 from:string = TypedOpOp;

// Literals &amp; constructors (methods not allowed or needed here)
constructorOp#107f8d8a constructor:string args:Vector&lt;TypedOpArg&gt; = TypedOpOp;

vectorOp#f8fb8f72 values:Vector&lt;TypedOp&gt; = TypedOpOp;

intLiteralOp#cbfabe7c value:int = TypedOpOp;
longLiteralOp#d08b8d3a value:long = TypedOpOp;
stringLiteralOp#2b56ea8e value:string = TypedOpOp;
bytesLiteralOp#fdb395a4 value:bytes = TypedOpOp;
boolLiteralOp#37e07911 value:Bool = TypedOpOp;
doubleLiteralOp#3651e3bf value:double = TypedOpOp;
themeFormatLiteralOp#8e4f9208 = TypedOpOp;</code></pre>
<p>Action parameters are represented by <code>TypedOpOp</code> constructors.  </p>
<h5><a class="anchor" href="#copyop" id="copyop" name="copyop"><i class="anchor-icon"></i></a><code>copyOp</code></h5>
<p>The most commonly used type, copies the value(s) from the stored <code>$FileSource.$from</code>.</p>
<h5><a class="anchor" href="#getinputchannelbyidop" id="getinputchannelbyidop" name="getinputchannelbyidop"><i class="anchor-icon"></i></a><code>getInputChannelByIdOp</code></h5>
<p>Returns an <a href="/type/InputChannel">InputChannel</a> constructor from the client's <a href="/api/peers">peer database</a>, based on the channel ID of type <a href="/type/long">long</a> specified in the stored <code>$FileSource.$from</code>.  </p>
<h5><a class="anchor" href="#getinputuserbyidop" id="getinputuserbyidop" name="getinputuserbyidop"><i class="anchor-icon"></i></a><code>getInputUserByIdOp</code></h5>
<p>Returns an <a href="/type/InputUser">InputUser</a> constructor from the client's <a href="/api/peers">peer database</a>, based on the channel ID of type <a href="/type/long">long</a> specified in the stored <code>$FileSource.$from</code>.    </p>
<h5><a class="anchor" href="#getinputpeerbyidop" id="getinputpeerbyidop" name="getinputpeerbyidop"><i class="anchor-icon"></i></a><code>getInputPeerByIdOp</code></h5>
<p>Returns an <a href="/type/InputPeer">InputPeer</a> constructor from the client's <a href="/api/peers">peer database</a>, based on the <a href="/api/bots/ids">bot API peer ID »</a> of type <a href="/type/long">long</a> specified in the stored <code>$FileSource.$from</code>.  </p>
<h5><a class="anchor" href="#constructorop" id="constructorop" name="constructorop"><i class="anchor-icon"></i></a><code>constructorOp</code></h5>
<p>Constructs the constructor of type (predicate) <code>constructor</code> using the arguments specified in <code>args</code>.  </p>
<h5><a class="anchor" href="#vectorop" id="vectorop" name="vectorop"><i class="anchor-icon"></i></a><code>vectorOp</code></h5>
<p>Constructs a vector of the constructors passed in <code>values</code>.  </p>
<h5><a class="anchor" href="#intliteralop" id="intliteralop" name="intliteralop"><i class="anchor-icon"></i></a><code>intLiteralOp</code></h5>
<p>Constructs a literal <a href="/type/int">int</a> with the value passed in <code>value</code>.</p>
<h5><a class="anchor" href="#longliteralop" id="longliteralop" name="longliteralop"><i class="anchor-icon"></i></a><code>longLiteralOp</code></h5>
<p>Constructs a literal <a href="/type/long">long</a> with the value passed in <code>value</code>.</p>
<h5><a class="anchor" href="#stringliteralop" id="stringliteralop" name="stringliteralop"><i class="anchor-icon"></i></a><code>stringLiteralOp</code></h5>
<p>Constructs a literal <a href="/type/string">string</a> with the value passed in <code>value</code>.</p>
<h5><a class="anchor" href="#bytesliteralop" id="bytesliteralop" name="bytesliteralop"><i class="anchor-icon"></i></a><code>bytesLiteralOp</code></h5>
<p>Constructs a literal <a href="/type/bytes">bytes</a> with the value passed in <code>value</code>.</p>
<h5><a class="anchor" href="#boolliteralop" id="boolliteralop" name="boolliteralop"><i class="anchor-icon"></i></a><code>boolLiteralOp</code></h5>
<p>Constructs a literal <a href="/type/Bool">Bool</a> with the value passed in <code>value</code>.</p>
<h5><a class="anchor" href="#doubleliteralop" id="doubleliteralop" name="doubleliteralop"><i class="anchor-icon"></i></a><code>doubleLiteralOp</code></h5>
<p>Constructs a literal <a href="/type/double">double</a> with the value passed in <code>value</code>.</p>
<h5><a class="anchor" href="#themeformatliteralop" id="themeformatliteralop" name="themeformatliteralop"><i class="anchor-icon"></i></a><code>themeFormatLiteralOp</code></h5>
<p>Constructs a <a href="/type/string">string</a>, indicating the <a href="/api/themes">theming engines</a> supported by the client (used when working with theme-related media, can be an empty string if the client doesn't support themes).</p>
<!-- 
### Another example:
Assume you receive a [message](/constructor/message) from your friend: that message contains a [messageMediaPhoto](/constructor/messageMediaPhoto) with a [photo](/constructor/photo).
Your client has to cache not only the `file_reference` field of the photo, but also the context in which the file reference was seen (in this case, a message coming from a specific user).
The context info is in this case, [an origin of type message](https://github.com/danog/MadelineProto/blob/v8/src/MTProtoTools/ReferenceDatabase.php#L74), containing the message ID and the peer ID of the chat/channel/user where the message was seen.
The context info has to be associated with the file reference: when downloading a file using [upload.getFile](/method/upload.getFile) or resending it using [messages.sendMedia](/method/messages.sendMedia), a `FILE_REFERENCE_EXPIRED` error may be returned.  
[messages.sendMultiMedia](/method/messages.sendMultiMedia) returns a variation of the same error, as a `FILE_REFERENCE_%d_EXPIRED` error (where `%d` is the index of the media with the expired file reference in the passed media array).  
If this happens, the context info must be used to refetch the object that contained the file reference: in this example, the peer info and the message ID have to be used with [channels.getMessages](/method/channels.getMessages) or [messages.getMessages](/method/messages.getMessages) to [refetch the message](https://github.com/danog/MadelineProto/blob/v8/src/MTProtoTools/ReferenceDatabase.php#L481), recache the file reference and use it in a new file download request.
More than one origin can be associated to one file reference, for greater resilience (in the case of a message that was deleted in one chat but was also forwarded in another chat, the file reference can be refetched from the second chat, instead).
Origins for objects returned by method calls with certain parameters can be considered, too (for example, in the case of favorited sticker sets returned by [messages.getFavedStickers](/method/messages.getFavedStickers)).
--></div>
  
</div>
          
        </div>
      </div>
      <div class="footer_wrap">
  <div class="footer_columns_wrap footer_desktop">
    <div class="footer_column footer_column_telegram">
      <h5>Telegram</h5>
      <div class="footer_telegram_description"></div>
      Telegram is a cloud-based mobile and desktop messaging app with a focus on security and speed.
    </div>

    <div class="footer_column">
      <h5><a href="//telegram.org/faq">About</a></h5>
      <ul>
        <li><a href="//telegram.org/faq">FAQ</a></li>
        <li><a href="//telegram.org/privacy">Privacy</a></li>
        <li><a href="//telegram.org/press">Press</a></li>
      </ul>
    </div>
    <div class="footer_column">
      <h5><a href="//telegram.org/apps#mobile-apps">Mobile Apps</a></h5>
      <ul>
        <li><a href="//telegram.org/dl/ios">iPhone/iPad</a></li>
        <li><a href="//telegram.org/android">Android</a></li>
        <li><a href="//telegram.org/dl/web">Mobile Web</a></li>
      </ul>
    </div>
    <div class="footer_column">
      <h5><a href="//telegram.org/apps#desktop-apps">Desktop Apps</a></h5>
      <ul>
        <li><a href="//desktop.telegram.org/">PC/Mac/Linux</a></li>
        <li><a href="//macos.telegram.org/">macOS</a></li>
        <li><a href="//telegram.org/dl/web">Web-browser</a></li>
      </ul>
    </div>
    <div class="footer_column footer_column_platform">
      <h5><a href="//core.telegram.org/">Platform</a></h5>
      <ul>
        <li><a href="//core.telegram.org/api">API</a></li>
        <li><a href="//translations.telegram.org/">Translations</a></li>
        <li><a href="//instantview.telegram.org/">Instant View</a></li>
      </ul>
    </div>
  </div>
  <div class="footer_columns_wrap footer_mobile">
    <div class="footer_column">
      <h5><a href="//telegram.org/faq">About</a></h5>
    </div>
    <div class="footer_column">
      <h5><a href="//telegram.org/blog">Blog</a></h5>
    </div>
    <div class="footer_column">
      <h5><a href="//telegram.org/press">Press</a></h5>
    </div>
    <div class="footer_column">
      <h5><a href="//telegram.org/moderation">Moderation</a></h5>
    </div>
  </div>
</div>
    </div>
    <script src="/js/main.js?47"></script>
    <script src="/js/jquery.min.js?1"></script>
<script src="/js/bootstrap.min.js?1"></script>

    <script>window.initDevPageNav&&initDevPageNav();
backToTopInit("Go up");
removePreloadInit();
</script>
  </body>
</html>

